Version 4
SHEET 1 1844 1608
WIRE -288 -352 -368 -352
WIRE -240 -352 -288 -352
WIRE -160 -352 -240 -352
WIRE 64 -352 32 -352
WIRE 192 -352 64 -352
WIRE -688 -336 -800 -336
WIRE -672 -336 -688 -336
WIRE 400 -320 400 -336
WIRE -368 -304 -368 -352
WIRE -288 -304 -288 -352
WIRE -160 -304 -160 -352
WIRE 64 -304 64 -352
WIRE 192 -304 192 -352
WIRE -688 -288 -688 -336
WIRE 400 -224 400 -240
WIRE 480 -224 400 -224
WIRE -800 -208 -800 -336
WIRE -368 -208 -368 -224
WIRE 480 -208 480 -224
WIRE -160 -192 -160 -224
WIRE 192 -192 192 -224
WIRE -448 -144 -496 -144
WIRE -288 -144 -288 -224
WIRE -256 -144 -288 -144
WIRE -224 -144 -256 -144
WIRE 64 -144 64 -224
WIRE 96 -144 64 -144
WIRE 128 -144 96 -144
WIRE 400 -144 400 -224
WIRE 784 -144 784 -176
WIRE 640 -128 640 -144
WIRE -688 -112 -688 -208
WIRE -288 -112 -288 -144
WIRE 64 -112 64 -144
WIRE 480 -112 480 -128
WIRE 608 -112 480 -112
WIRE -448 -96 -448 -144
WIRE 480 -96 480 -112
WIRE 720 -96 672 -96
WIRE -496 -80 -496 -144
WIRE 608 -80 576 -80
WIRE -800 -64 -800 -128
WIRE -752 -64 -800 -64
WIRE 640 -48 640 -64
WIRE -160 -32 -160 -96
WIRE 64 -32 64 -48
WIRE 192 -32 192 -96
WIRE 576 -16 576 -80
WIRE 784 -16 784 -48
WIRE 784 -16 576 -16
WIRE -800 0 -800 -64
WIRE -160 0 -160 -32
WIRE 192 0 192 -32
WIRE 400 0 400 -80
WIRE 480 0 480 -16
WIRE 64 16 64 -32
WIRE 784 16 784 -16
WIRE -688 32 -688 -16
WIRE -688 32 -768 32
WIRE -288 32 -288 -48
WIRE -496 64 -496 -32
WIRE -448 64 -448 -16
WIRE -448 64 -496 64
WIRE -288 128 -288 112
WIRE -160 128 -160 80
WIRE 64 128 64 96
WIRE 192 128 192 80
WIRE 784 128 784 96
WIRE -800 144 -800 64
WIRE -688 160 -688 32
WIRE -800 288 -800 224
WIRE -736 288 -800 288
WIRE -688 288 -688 240
WIRE -688 288 -736 288
WIRE -816 512 -848 512
WIRE -784 512 -816 512
WIRE -656 512 -784 512
WIRE -624 512 -656 512
WIRE -592 512 -624 512
WIRE -512 512 -592 512
WIRE -464 512 -512 512
WIRE -432 512 -464 512
WIRE -400 512 -432 512
WIRE -272 512 -400 512
WIRE -240 512 -272 512
WIRE -208 512 -240 512
WIRE -80 512 -208 512
WIRE -48 512 -80 512
WIRE -16 512 -48 512
WIRE -1296 736 -1520 736
WIRE -1520 768 -1520 736
WIRE -1296 768 -1296 736
WIRE -1216 768 -1216 720
WIRE -1296 864 -1296 832
WIRE -1216 864 -1216 832
WIRE -1216 864 -1296 864
WIRE -1216 880 -1216 864
WIRE -1520 912 -1520 848
WIRE -784 912 -784 896
WIRE -592 912 -592 896
WIRE -592 912 -784 912
WIRE -400 912 -400 896
WIRE -400 912 -592 912
WIRE -208 912 -208 896
WIRE -208 912 -400 912
WIRE -16 912 -16 896
WIRE -16 912 -208 912
WIRE 32 912 -16 912
WIRE 64 912 32 912
WIRE -816 944 -816 896
WIRE -624 944 -624 896
WIRE -624 944 -816 944
WIRE -432 944 -432 896
WIRE -432 944 -624 944
WIRE -240 944 -240 896
WIRE -240 944 -432 944
WIRE -48 944 -48 896
WIRE -48 944 -240 944
WIRE 32 944 -48 944
WIRE 64 944 32 944
WIRE -848 976 -848 896
WIRE -656 976 -656 896
WIRE -656 976 -848 976
WIRE -464 976 -464 896
WIRE -464 976 -656 976
WIRE -272 976 -272 896
WIRE -272 976 -464 976
WIRE -80 976 -80 896
WIRE -80 976 -272 976
WIRE 32 976 -80 976
WIRE 64 976 32 976
WIRE -1216 992 -1216 960
WIRE -1136 992 -1216 992
WIRE -1136 1024 -1136 992
WIRE -704 1088 -704 1056
WIRE -288 1088 -288 1056
WIRE 96 1088 96 1056
WIRE 368 1088 336 1088
WIRE 416 1088 368 1088
WIRE -1216 1104 -1216 992
WIRE -1136 1120 -1136 1104
WIRE -1072 1120 -1136 1120
WIRE -928 1120 -1008 1120
WIRE -848 1120 -928 1120
WIRE -496 1120 -544 1120
WIRE -432 1120 -496 1120
WIRE -128 1120 -160 1120
WIRE -48 1120 -128 1120
WIRE 336 1120 336 1088
WIRE -768 1136 -784 1136
WIRE -352 1136 -368 1136
WIRE 32 1136 16 1136
WIRE -1136 1152 -1136 1120
WIRE -848 1152 -880 1152
WIRE -432 1152 -464 1152
WIRE -48 1152 -80 1152
WIRE -816 1184 -816 1168
WIRE -400 1184 -400 1168
WIRE -16 1184 -16 1168
WIRE -880 1232 -880 1152
WIRE -704 1232 -704 1184
WIRE -704 1232 -880 1232
WIRE -464 1232 -464 1152
WIRE -288 1232 -288 1184
WIRE -288 1232 -464 1232
WIRE -80 1232 -80 1152
WIRE 96 1232 96 1184
WIRE 96 1232 -80 1232
WIRE -1216 1248 -1216 1168
WIRE -1136 1248 -1136 1232
WIRE -704 1248 -704 1232
WIRE -288 1248 -288 1232
WIRE 96 1248 96 1232
WIRE -704 1344 -704 1328
WIRE -288 1344 -288 1328
WIRE 96 1344 96 1328
FLAG -288 128 0
FLAG -160 128 0
FLAG 64 128 0
FLAG 192 128 0
FLAG -256 -144 B1
FLAG 96 -144 B2
FLAG -160 -32 e1
FLAG 192 -32 e2
FLAG -496 64 0
FLAG -240 -352 V+
FLAG -160 -592 k
FLAG -368 -208 0
FLAG -736 288 0
FLAG 784 128 0
FLAG 784 -176 C2
FLAG 480 0 0
FLAG 640 -144 0
FLAG 640 -48 V+
FLAG -704 1344 0
FLAG -816 1104 0
FLAG -816 1184 V+
FLAG 400 0 0
FLAG 400 -336 V+
FLAG -512 512 V+
FLAG -288 1344 0
FLAG -400 1104 0
FLAG -400 1184 V+
FLAG 96 1344 0
FLAG -16 1104 0
FLAG -16 1184 V+
FLAG 32 976 R
FLAG 32 944 G
FLAG 32 912 B
FLAG -704 1056 R
FLAG -288 1056 G
FLAG 96 1056 B
FLAG -128 1120 stim
FLAG -496 1120 stim
FLAG -928 1120 stim
FLAG 336 1200 0
FLAG 368 1088 Riuv
FLAG -1136 1248 0
FLAG -1216 1248 0
FLAG -1216 720 V+
FLAG -544 1120 0
FLAG -160 1120 0
FLAG -1520 912 0
SYMBOL res -176 -16 R0
SYMATTR InstName R1
SYMATTR Value {Re}
SYMBOL res -304 16 R0
WINDOW 3 -37 -15 VRight 2
SYMATTR Value {Rpot}
SYMATTR InstName R2
SYMBOL EIT_Semiconductors\\npn -224 -192 R0
SYMATTR InstName Q1
SYMATTR Value PXT4401
SYMBOL res 176 -16 R0
SYMATTR InstName R4
SYMATTR Value {Re*2}
SYMBOL res 48 0 R0
WINDOW 3 -37 -15 VRight 2
SYMATTR Value {Rpot*2}
SYMATTR InstName R6
SYMBOL EIT_Semiconductors\\npn 128 -192 R0
SYMATTR InstName Q2
SYMATTR Value PXT4401
SYMBOL source-Vmarker 32 -352 R0
SYMATTR Value V=10V
SYMATTR InstName U2
SYMBOL res 176 -320 R0
SYMATTR InstName R8
SYMATTR Value {RL}
SYMBOL source-V 64 -128 R0
WINDOW 123 0 0 Left 2
WINDOW 39 0 0 Left 2
SYMATTR InstName V2
SYMATTR Value 0.62
SYMBOL res 48 -320 R0
SYMATTR InstName R7
SYMATTR Value {R1}
SYMBOL sw -448 0 M180
WINDOW 0 12 104 Left 2
WINDOW 3 17 11 Left 2
SYMATTR InstName S1
SYMATTR Value MYSW
SYMBOL source-V -368 -320 M0
WINDOW 123 0 0 Left 2
WINDOW 39 0 0 Left 2
SYMATTR InstName V3
SYMATTR Value {Vplus}
SYMBOL TL431 -800 48 R180
SYMATTR InstName U1
SYMBOL res -816 -224 R0
SYMATTR InstName R9
SYMATTR Value 10k
SYMBOL res -704 144 R0
SYMATTR InstName R10
SYMATTR Value {Re}
SYMBOL EIT_Semiconductors\\npn -752 -112 R0
SYMATTR InstName Q3
SYMATTR Value PXT4401
SYMBOL res -816 128 R0
WINDOW 3 -37 -15 VRight 2
SYMATTR Value {Rpot}
SYMATTR InstName R11
SYMBOL res -704 -304 R0
SYMATTR InstName R12
SYMATTR Value {RL}
SYMBOL source-Vmarker -800 -336 R0
SYMATTR Value V=10V
SYMATTR InstName U4
SYMBOL schottky -304 -112 R0
SYMATTR InstName D6
SYMATTR Value BAT54
SYMATTR Description Diode
SYMATTR Type diode
SYMBOL res -304 -320 R0
SYMATTR InstName R14
SYMATTR Value 10k
SYMBOL source-V -160 -320 R0
WINDOW 123 0 0 Left 2
WINDOW 39 0 0 Left 2
SYMATTR InstName V1
SYMATTR Value {led}
SYMBOL EIT_Semiconductors\\npn 720 -144 R0
SYMATTR InstName Q4
SYMATTR Value PXT4401
SYMBOL res 768 0 R0
SYMATTR InstName R13
SYMATTR Value {Riu}
SYMBOL res 464 -224 R0
WINDOW 3 151 67 Right 2
SYMATTR Value {RpotNot}
SYMATTR InstName R16
SYMBOL res 464 -112 R0
WINDOW 3 107 68 Right 2
SYMATTR Value {Rpot}
SYMATTR InstName R17
SYMBOL EXTRA\\ExtraOpamps\\LM358_NS 640 -96 M180
WINDOW 3 -59 -120 Left 2
SYMATTR InstName U8
SYMBOL EIT_Semiconductors\\npn -768 1088 R0
SYMATTR InstName Q5
SYMATTR Value PXT4401
SYMBOL res -720 1232 R0
SYMATTR InstName R15
SYMATTR Value {Riu}
SYMBOL EXTRA\\ExtraOpamps\\LM358_NS -816 1136 M180
WINDOW 3 -55 70 Left 2
SYMATTR InstName U5
SYMBOL diode 416 -80 R180
WINDOW 0 24 64 Left 2
WINDOW 3 24 0 Left 2
SYMATTR InstName D12
SYMATTR Value 1Nselber
SYMBOL res 384 -336 R0
SYMATTR InstName R18
SYMATTR Value 15k
SYMBOL TB-5050rgb -672 640 R0
WINDOW 3 104 63 Invisible 2
SYMATTR InstName U9
SYMBOL TB-5050rgb -672 576 R0
SYMATTR InstName U10
SYMBOL EIT_Semiconductors\\npn -352 1088 R0
SYMATTR InstName Q6
SYMATTR Value PXT4401
SYMBOL res -304 1232 R0
SYMATTR InstName R3
SYMATTR Value {Riu}
SYMBOL EXTRA\\ExtraOpamps\\LM358_NS -400 1136 M180
WINDOW 3 -55 70 Left 2
SYMATTR InstName U3
SYMBOL EIT_Semiconductors\\npn 32 1088 R0
SYMATTR InstName Q7
SYMATTR Value PXT4401
SYMBOL res 80 1232 R0
SYMATTR InstName R5
SYMATTR Value {Riu}
SYMBOL EXTRA\\ExtraOpamps\\LM358_NS -16 1136 M180
WINDOW 3 -55 70 Left 2
SYMATTR InstName U6
SYMBOL TB-5050rgb -672 704 R0
WINDOW 3 104 63 Invisible 2
SYMATTR InstName U7
SYMBOL TB-5050rgb -672 768 R0
WINDOW 3 104 63 Invisible 2
SYMATTR InstName U11
SYMBOL TB-5050rgb -672 832 R0
WINDOW 3 104 63 Invisible 2
SYMATTR InstName U12
SYMBOL TB-5050rgb -480 640 R0
WINDOW 3 104 63 Invisible 2
SYMATTR InstName U13
SYMBOL TB-5050rgb -480 576 R0
SYMATTR InstName U14
SYMBOL TB-5050rgb -480 704 R0
WINDOW 3 104 63 Invisible 2
SYMATTR InstName U15
SYMBOL TB-5050rgb -480 768 R0
WINDOW 3 104 63 Invisible 2
SYMATTR InstName U16
SYMBOL TB-5050rgb -480 832 R0
WINDOW 3 104 63 Invisible 2
SYMATTR InstName U17
SYMBOL TB-5050rgb -288 640 R0
WINDOW 3 104 63 Invisible 2
SYMATTR InstName U18
SYMBOL TB-5050rgb -288 576 R0
SYMATTR InstName U19
SYMBOL TB-5050rgb -288 704 R0
WINDOW 3 104 63 Invisible 2
SYMATTR InstName U20
SYMBOL TB-5050rgb -288 768 R0
WINDOW 3 104 63 Invisible 2
SYMATTR InstName U21
SYMBOL TB-5050rgb -288 832 R0
WINDOW 3 104 63 Invisible 2
SYMATTR InstName U22
SYMBOL TB-5050rgb -96 640 R0
WINDOW 3 104 63 Invisible 2
SYMATTR InstName U23
SYMBOL TB-5050rgb -96 576 R0
SYMATTR InstName U24
SYMBOL TB-5050rgb -96 704 R0
WINDOW 3 104 63 Invisible 2
SYMATTR InstName U25
SYMBOL TB-5050rgb -96 768 R0
WINDOW 3 104 63 Invisible 2
SYMATTR InstName U26
SYMBOL TB-5050rgb -96 832 R0
WINDOW 3 104 63 Invisible 2
SYMATTR InstName U27
SYMBOL TB-5050rgb -864 640 R0
WINDOW 3 104 63 Invisible 2
SYMATTR InstName U28
SYMBOL TB-5050rgb -864 576 R0
SYMATTR InstName U29
SYMBOL TB-5050rgb -864 704 R0
WINDOW 3 104 63 Invisible 2
SYMATTR InstName U30
SYMBOL TB-5050rgb -864 768 R0
WINDOW 3 104 63 Invisible 2
SYMATTR InstName U31
SYMBOL TB-5050rgb -864 832 R0
WINDOW 3 104 63 Invisible 2
SYMATTR InstName U32
SYMBOL Misc\\jumper -592 544 R90
WINDOW 0 0 40 Invisible 2
SYMATTR InstName X1
SYMBOL Misc\\jumper -560 544 R90
WINDOW 0 0 40 Invisible 2
SYMATTR InstName X2
SYMBOL Misc\\jumper -528 544 R90
WINDOW 0 0 40 Invisible 2
SYMATTR InstName X3
SYMBOL Misc\\jumper -400 544 R90
WINDOW 0 0 40 Invisible 2
SYMATTR InstName X4
SYMBOL Misc\\jumper -368 544 R90
WINDOW 0 0 40 Invisible 2
SYMATTR InstName X5
SYMBOL Misc\\jumper -336 544 R90
WINDOW 0 0 40 Invisible 2
SYMATTR InstName X6
SYMBOL Misc\\jumper -208 544 R90
WINDOW 0 0 40 Invisible 2
SYMATTR InstName X7
SYMBOL Misc\\jumper -176 544 R90
WINDOW 0 0 40 Invisible 2
SYMATTR InstName X8
SYMBOL Misc\\jumper -144 544 R90
WINDOW 0 0 40 Invisible 2
SYMATTR InstName X9
SYMBOL Misc\\jumper -16 544 R90
WINDOW 0 0 40 Invisible 2
SYMATTR InstName X10
SYMBOL Misc\\jumper 16 544 R90
WINDOW 0 0 40 Invisible 2
SYMATTR InstName X11
SYMBOL Misc\\jumper 48 544 R90
WINDOW 0 0 40 Invisible 2
SYMATTR InstName X12
SYMBOL Misc\\jumper -784 544 R90
WINDOW 0 0 40 Invisible 2
SYMATTR InstName X13
SYMBOL Misc\\jumper -752 544 R90
WINDOW 0 0 40 Invisible 2
SYMATTR InstName X14
SYMBOL Misc\\jumper -720 544 R90
WINDOW 0 0 40 Invisible 2
SYMATTR InstName X15
SYMBOL source-V 336 1104 R0
WINDOW 123 0 0 Left 2
WINDOW 39 0 0 Left 2
SYMATTR InstName V4
SYMATTR Value {Riu}
SYMBOL res -1152 1008 R0
WINDOW 3 151 67 Right 2
SYMATTR Value {RpotNot}
SYMATTR InstName R19
SYMBOL res -1152 1136 R0
WINDOW 3 107 68 Right 2
SYMATTR Value {Rpot}
SYMATTR InstName R20
SYMBOL diode -1200 1168 R180
WINDOW 0 24 64 Left 2
WINDOW 3 24 0 Left 2
SYMATTR InstName D1
SYMATTR Value 1Nselber
SYMBOL res -1232 864 R0
SYMATTR InstName R21
SYMATTR Value 15k
SYMBOL Misc\\jumper -1232 800 R90
SYMATTR InstName X16
SYMBOL source-V -1520 752 R0
WINDOW 123 0 0 Left 2
WINDOW 39 0 0 Left 2
WINDOW 3 -130 -100 Left 2
SYMATTR InstName V5
SYMATTR Value PULSE(0 10 0 10n 10n {1/(3*fpwm)} {1/(fpwm)})
SYMBOL Misc\\jumper -1040 1184 R180
SYMATTR InstName X17
TEXT 1048 -736 Left 2 !*\n**********************************************************\n*\n* PXT4401\n*\n* NXP Semiconductors\n*\n* Switching NPN transistor\n* IC   = 600 mA\n* VCEO = 40 V \n* hFE  = 100 - 300  @ 1V/150mA\n*\n*\n*\n*\n* Package pinning does not match Spice model pinning.\n* Package: SOT 89\n* \n* Package Pin 1: Emitter    \n* Package Pin 2: Collector\n* Package Pin 3: Base\n*\n*\n* Extraction date (week/year): 02/2009 \n* Simulator: Spice 3\n*\n**********************************************************\n*#\n.MODEL PXT4401 NPN\n+    IS=29.13E-15 \n+    NF=992.6E-3 \n+    ISE=9.652E-15 \n+    NE=1.516  \n+    BF=256.7  \n+    IKF = 489.9E-3 \n+    VAF = 80.99  \n+    NR = 984.4E-3 \n+    ISC = 320.3E-12 \n+    NC = 1.608  \n+    BR = 6.590  \n+    IKR = 192.9E-3 \n+    VAR = 101.2  \n+    RB = 1.000  \n+    IRB = 1.000E-3 \n+    RBM = 1.000  \n+    RE = 193.4E-3 \n+    RC = 224.8E-3 \n+    XTB = 0.000  \n+    EG = 1.110  \n+    XTI = 3.000  \n+    CJE = 25.89E-12 \n+    VJE = 689.1E-3 \n+    MJE = 366.8E-3 \n+    TF = 293.9E-12 \n+    XTF = 71.78  \n+    VTF = 20.00  \n+    ITF = 4.797  \n+    PTF = 0.000  \n+    CJC = 10.11E-12 \n+    VJC = 662.2E-3 \n+    MJC = 416.0E-3 \n+    XCJC = 0.5946  \n+    TR = 320.0E-9 \n+    CJS = 0.000  \n+    VJS = 750.0E-3 \n+    MJS = 333.0E-3 \n+    FC = 938.8E-3 \n*##\n*
TEXT 624 216 Left 2 !.param Re = 5\n.param R1 = 4.7k\n.param beta=256\n.param Rp = 200k\n.param set = 1 ; 0 => 0ohm\n.param RL = 1\n.param Rpot = {Rp*set+1u}\n.param RpotNot = {Rp*(1-set)+1u}\n.param Vplus = 20\n.param red = 2.2V\n.param led = {5*red}
TEXT -240 344 Left 2 !.tran {10/fpwm}
TEXT 264 208 Left 2 ;.step param set 0 1 0.02\n;.step param RL list 1 0.7\n;.step param Re list 20 10 5\n;.step param led = 11 8.5 2.2\n;.step param Vplus list 12 20\n;.step param Riu list 15 25
TEXT -384 232 Left 2 ;I=(10V-0.62V)/( (0.62-V(b1,e1)/.995)*Re*(R1+Rp)+R1/beta )
TEXT -384 264 Left 2 !.model MYSW SW(Ron=1 Roff=1Meg Vt=2.7 Vh=-.4)
TEXT 288 936 Left 2 !.param Uin = 5V\n.param Iout = 200mA\n.param Riu = {Uin/(5*Iout)}
TEXT -240 312 Left 2 ;.step param TEMP 0 100 10
TEXT -928 -432 Left 2 !.model 1Nselber D(Is=.88f Rs=.25 Cjo=175p M=.55 nbv=1.7 bv=4.7 Vj=.75 Isr=1.86n Nr=2 Ibv=20.245m Ibvl=1.96m Nbvl=15 Tbv1=-21.3u Vpk=2.7 mfg=OnSemi type=Zener)
TEXT -1424 592 Left 2 !.param fpwm=600
