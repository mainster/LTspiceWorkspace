Version 4
SHEET 1 1904 2276
WIRE -2352 -240 -2400 -240
WIRE -2352 -208 -2400 -208
WIRE -2048 -144 -2080 -144
WIRE -2016 -144 -2048 -144
WIRE -1920 -144 -1952 -144
WIRE -1888 -144 -1920 -144
WIRE -2256 -112 -2400 -112
WIRE -2160 -112 -2256 -112
WIRE -1920 -112 -2160 -112
WIRE -1760 -112 -1920 -112
WIRE -1472 -112 -1760 -112
WIRE -1248 -112 -1472 -112
WIRE -2656 -80 -2688 -80
WIRE -2592 -80 -2608 -80
WIRE -2160 -80 -2160 -112
WIRE -1920 -80 -1920 -112
WIRE -1760 -80 -1760 -112
WIRE -1472 -80 -1472 -112
WIRE -1984 -32 -2096 -32
WIRE -1648 -32 -1696 -32
WIRE -1536 -32 -1648 -32
WIRE -2096 -16 -2096 -32
WIRE -2656 0 -2688 0
WIRE -2592 0 -2592 -80
WIRE -2592 0 -2624 0
WIRE -2576 0 -2592 0
WIRE -2160 32 -2160 16
WIRE -1760 48 -1760 16
WIRE -1648 48 -1648 -32
WIRE -1648 48 -1760 48
WIRE -1520 48 -1552 48
WIRE -1488 48 -1520 48
WIRE -1248 48 -1248 -112
WIRE -2208 64 -2240 64
WIRE -2176 64 -2208 64
WIRE -1984 64 -2016 64
WIRE -1952 64 -1984 64
WIRE -1872 64 -1904 64
WIRE -1840 64 -1872 64
WIRE -2160 80 -2160 64
WIRE -2160 80 -2400 80
WIRE -2096 80 -2096 16
WIRE -2096 80 -2160 80
WIRE -1408 80 -1440 80
WIRE -1376 80 -1408 80
WIRE -1568 96 -1664 96
WIRE -1472 96 -1472 16
WIRE -1472 96 -1568 96
WIRE -1424 96 -1472 96
WIRE -1344 96 -1392 96
WIRE -1312 96 -1344 96
WIRE -1568 112 -1568 96
WIRE -2480 128 -2544 128
WIRE -2464 128 -2480 128
WIRE -2016 128 -2032 128
WIRE -1344 128 -1344 96
WIRE -2624 144 -2688 144
WIRE -2688 160 -2688 144
WIRE -1472 160 -1472 96
WIRE -1808 176 -1840 176
WIRE -1776 176 -1808 176
WIRE -1248 176 -1248 144
WIRE -1248 176 -1280 176
WIRE -2400 192 -2400 176
WIRE -2096 192 -2096 176
WIRE -1760 192 -1760 48
WIRE -1664 192 -1664 96
WIRE -1248 192 -1248 176
WIRE -2528 208 -2544 208
WIRE -2448 208 -2480 208
WIRE -2016 208 -2016 128
WIRE -2016 208 -2448 208
WIRE -1568 208 -1568 192
WIRE -1536 208 -1568 208
WIRE -2544 224 -2544 208
WIRE -1568 224 -1568 208
WIRE -2528 240 -2528 208
WIRE -2400 256 -2400 192
WIRE -2096 256 -2096 192
WIRE -2688 272 -2688 240
WIRE -2624 272 -2624 192
WIRE -2544 272 -2544 256
WIRE -2480 272 -2480 240
WIRE -1968 288 -2000 288
WIRE -1936 288 -1968 288
WIRE -2160 304 -2336 304
WIRE -1984 304 -2160 304
WIRE -1920 304 -1920 16
WIRE -1920 304 -1952 304
WIRE -1344 304 -1344 224
WIRE -1248 304 -1248 272
WIRE -1248 304 -1344 304
WIRE -1168 304 -1248 304
WIRE -1136 304 -1168 304
WIRE -1248 320 -1248 304
WIRE -1568 336 -1568 304
WIRE -1472 336 -1472 256
WIRE -1472 336 -1568 336
WIRE -1568 352 -1568 336
WIRE -2400 368 -2400 352
WIRE -2256 368 -2256 -112
WIRE -2096 368 -2096 352
WIRE -1856 384 -1888 384
WIRE -1824 384 -1856 384
WIRE -2000 400 -2096 400
WIRE -1872 400 -2000 400
WIRE -1664 400 -1664 256
WIRE -1664 400 -1840 400
WIRE -1632 400 -1664 400
WIRE -2464 416 -2496 416
WIRE -2432 416 -2464 416
WIRE -2320 416 -2352 416
WIRE -2288 416 -2320 416
WIRE -2256 416 -2256 400
WIRE -2160 416 -2192 416
WIRE -2128 416 -2160 416
WIRE -1248 416 -1248 400
WIRE -2400 464 -2400 400
WIRE -2320 464 -2400 464
WIRE -1472 464 -1472 336
WIRE -1312 464 -1472 464
WIRE -1472 480 -1472 464
WIRE -1136 480 -1136 448
WIRE -1968 496 -2000 496
WIRE -1936 496 -1968 496
WIRE -1760 496 -1760 272
WIRE -1760 496 -1840 496
WIRE -2400 528 -2400 464
WIRE -2096 528 -2096 400
WIRE -1920 528 -1920 304
WIRE -1760 528 -1760 496
WIRE -1568 528 -1568 448
WIRE -1536 528 -1568 528
WIRE -2256 576 -2256 512
WIRE -2256 576 -2336 576
WIRE -2160 576 -2256 576
WIRE -1840 576 -1840 496
WIRE -1840 576 -1856 576
WIRE -1824 576 -1840 576
WIRE -1664 576 -1664 400
WIRE -1472 624 -1472 576
WIRE -1472 624 -1600 624
WIRE -2400 640 -2400 624
WIRE -2400 640 -2416 640
WIRE -2096 640 -2096 624
WIRE -2080 640 -2096 640
WIRE -2400 656 -2400 640
WIRE -2256 656 -2256 576
WIRE -2096 656 -2096 640
WIRE -1920 656 -1920 624
WIRE -1568 656 -1568 528
WIRE -1472 656 -1472 624
WIRE -2400 752 -2400 736
WIRE -2400 752 -2416 752
WIRE -2256 752 -2256 736
WIRE -2256 752 -2400 752
WIRE -2096 752 -2096 736
WIRE -2096 752 -2256 752
WIRE -1920 752 -1920 736
WIRE -1920 752 -2096 752
WIRE -1760 752 -1760 624
WIRE -1760 752 -1920 752
WIRE -1664 752 -1664 672
WIRE -1664 752 -1760 752
WIRE -1568 752 -1568 736
WIRE -1568 752 -1664 752
WIRE -1472 752 -1472 736
WIRE -1472 752 -1568 752
WIRE -1248 752 -1248 512
WIRE -1248 752 -1472 752
WIRE -2528 928 -2608 928
WIRE -2512 928 -2528 928
WIRE -2608 960 -2608 928
WIRE -2608 1056 -2608 1040
WIRE -1584 1152 -1600 1152
WIRE -1472 1152 -1488 1152
WIRE -2672 1184 -2672 1152
WIRE -2576 1184 -2576 1152
WIRE -1536 1200 -1536 1184
WIRE -2672 1280 -2672 1264
WIRE -2576 1280 -2576 1264
FLAG -2000 400 Idv
FLAG -2352 -240 V+
IOPIN -2352 -240 Out
FLAG -2352 -208 V-
IOPIN -2352 -208 Out
FLAG -2400 -112 V+
IOPIN -2400 -112 BiDir
FLAG -2416 752 V-
IOPIN -2416 752 BiDir
FLAG -1168 304 out
FLAG -1136 480 0
FLAG -2480 128 in+
FLAG -2448 208 in-
FLAG -2688 0 out
FLAG -2576 0 in-
FLAG -2400 192 e1
FLAG -2096 192 e2
FLAG -2528 928 DV
FLAG -2608 1056 0
FLAG -2688 -80 0
FLAG -1136 368 0
FLAG -2688 272 0
FLAG -2624 272 0
FLAG -2544 272 0
FLAG -2416 640 off+
FLAG -2080 640 off-
FLAG -1600 1152 off+
FLAG -1472 1152 off-
FLAG -1536 1200 V-
IOPIN -1536 1200 BiDir
FLAG -2480 272 0
FLAG -2576 1280 0
FLAG -2672 1280 0
FLAG -2576 1152 Rpr
FLAG -2672 1152 Rpl
DATAFLAG -1872 64 "abs(round(1meg*Ic(Q9))*1u)"
DATAFLAG -1808 176 "abs(round(1meg*I(R3))*1u)"
DATAFLAG -1520 48 "abs(round(1meg*Ic(Q13))*1u)"
DATAFLAG -1968 496 "abs(round(1meg*Ic(Q10))*1u)"
DATAFLAG -2208 64 "abs(round(1meg*Ix(I0:in))*1u)"
DATAFLAG -1968 288 "abs(round(100meg*Ix(Ib34:in))*1u/100)"
DATAFLAG -1408 80 "abs(round(1meg*Ix(U5:in))*1u)"
DATAFLAG -1920 -144 "abs(round(100meg*IB(Q9))*1u/100)"
DATAFLAG -2048 -144 "abs(round(100meg*IB(Q8))*1u/100)"
DATAFLAG -1984 64 "abs(round(100meg*Ix(U6:in))*1u/100)"
DATAFLAG -2464 416 "abs(round(100meg*Ix(IC3:in))*1u/100)"
DATAFLAG -2160 416 "abs(round(100meg*Ix(IC4:in))*1u/100)"
DATAFLAG -1856 384 "abs(round(100meg*Ix(IDV:in))*1u/100)"
DATAFLAG -2320 416 "abs(round(100meg*Ix(IC5:in))*1u/100)"
SYMBOL EIT_Semiconductors\\npn -2464 80 R0
SYMATTR InstName Q1
SYMATTR Value NPN1
SYMBOL EIT_Semiconductors\\pnp -2096 16 R180
WINDOW 0 56 32 Left 2
WINDOW 3 56 68 Left 2
SYMATTR InstName Q8
SYMATTR Value PNP1
SYMBOL EIT_Semiconductors\\npn -2032 80 M0
SYMATTR InstName Q2
SYMATTR Value NPN1
SYMBOL EIT_Semiconductors\\pnp -2160 352 M180
WINDOW 0 -18 84 Left 2
WINDOW 3 -16 112 Left 2
SYMATTR InstName Q4
SYMATTR Value PNP1
SYMBOL EIT_Semiconductors\\pnp -2336 352 R180
WINDOW 0 56 32 Left 2
WINDOW 3 56 68 Left 2
SYMATTR InstName Q3
SYMATTR Value PNP1
SYMBOL EIT_Semiconductors\\npn -2320 416 R0
SYMATTR InstName Q5
SYMATTR Value NPN1
SYMBOL EIT_Semiconductors\\npn -2336 528 M0
SYMATTR InstName Q6
SYMATTR Value NPN1
SYMBOL EIT_Semiconductors\\npn -2160 528 R0
SYMATTR InstName Q7
SYMATTR Value NPN1
SYMBOL res -2272 640 R0
SYMATTR InstName R1
SYMATTR Value 50k
SYMBOL source-Vmarker -2400 -240 R0
SYMATTR Value V={Vplus}
SYMATTR InstName U1
SYMBOL source-Vmarker -2400 -208 R0
SYMATTR Value V={-Vplus}
SYMATTR InstName U2
SYMBOL EIT_Semiconductors\\pnp -1984 16 M180
WINDOW 0 56 32 Left 2
WINDOW 3 56 68 Left 2
SYMATTR InstName Q9
SYMATTR Value PNP1
SYMBOL res -1936 640 R0
SYMATTR InstName R2
SYMATTR Value 5k
SYMBOL EIT_Semiconductors\\npn -1856 528 M0
SYMATTR InstName Q10
SYMATTR Value NPN1
SYMBOL EIT_Semiconductors\\npn -1824 528 R0
SYMATTR InstName Q11
SYMATTR Value NPN1
SYMBOL res -1744 176 M0
SYMATTR InstName R3
SYMATTR Value 39k
SYMBOL EIT_Semiconductors\\pnp -1696 16 R180
WINDOW 0 56 32 Left 2
WINDOW 3 56 68 Left 2
SYMATTR InstName Q12
SYMATTR Value PNP1
SYMBOL EIT_Semiconductors\\pnp -1536 16 M180
WINDOW 0 56 32 Left 2
WINDOW 3 56 68 Left 2
SYMATTR InstName Q13
SYMATTR Value PNP1
SYMBOL EIT_Semiconductors\\npn -1632 352 R0
SYMATTR InstName Q14
SYMATTR Value NPN1
SYMBOL EIT_Semiconductors\\npn -1536 480 R0
SYMATTR InstName Q15
SYMATTR Value NPN1
SYMBOL res -1584 640 R0
SYMATTR InstName R4
SYMATTR Value 50k
SYMBOL EIT_Semiconductors\\npn -1312 48 R0
SYMATTR InstName Q18
SYMATTR Value NPN1 {m}
SYMBOL EIT_Semiconductors\\npn -1280 128 M0
SYMATTR InstName Q19
SYMATTR Value NPN1
SYMBOL res -1264 176 R0
SYMATTR InstName R5
SYMATTR Value 25
SYMBOL EIT_Semiconductors\\pnp -1312 512 M180
WINDOW 0 56 32 Left 2
WINDOW 3 56 68 Left 2
SYMATTR InstName Q20
SYMATTR Value PNP1 {m}
SYMBOL res -1264 304 R0
SYMATTR InstName R6
SYMATTR Value 50
SYMBOL cap -1648 192 M0
SYMATTR InstName C1
SYMATTR Value {Ccomp}
SYMBOL MDB_sym\\arrow_curr -1856 400 R270
WINDOW 0 -37 0 VTop 2
SYMATTR InstName Idv
SYMBOL res -1152 352 R0
SYMATTR InstName RL
SYMATTR Value 10k
SYMBOL MDB_sym\\arrow_curr -1968 304 R270
WINDOW 0 15 -61 VTop 2
SYMATTR InstName Ib34
SYMBOL bv -2608 944 R0
SYMATTR InstName B1
SYMATTR Value V=V(e1)-V(e2)
SYMBOL MDB_sym\\arrow_curr -1408 96 R270
WINDOW 0 -37 0 VTop 2
SYMATTR InstName U5
SYMBOL MDB_sym\\arrow_curr -2096 0 R0
SYMATTR InstName U6
SYMBOL MDB_sym\\arrow_curr -2400 384 M0
WINDOW 0 -41 -18 Left 2
SYMATTR InstName IC3
SYMBOL MDB_sym\\arrow_curr -2096 384 M0
WINDOW 0 -42 -18 Left 2
SYMATTR InstName IC4
SYMBOL MDB_sym\\arrow_curr -2256 384 M0
WINDOW 0 -43 -17 Left 2
SYMATTR InstName IC5
SYMBOL MDB_sym\\source-V -2688 144 M0
WINDOW 3 27 84 Left 2
WINDOW 123 29 58 Left 2
WINDOW 39 0 0 Left 2
SYMATTR Value 0
SYMATTR Value2 AC 1
SYMATTR InstName V2
SYMBOL crtl-V-V -2544 112 R0
WINDOW 0 -9 0 Left 2
WINDOW 3 30 51 Left 2
SYMATTR InstName E1
SYMATTR Value 1
SYMBOL MDB_sym\\isoR -2544 240 R180
SYMATTR InstName R7
SYMBOL MDB_sym\\arrow_curr -2160 48 R0
WINDOW 0 9 2 Left 2
SYMATTR InstName I0
SYMBOL res -2416 640 R0
SYMATTR InstName R8
SYMATTR Value 1k
SYMBOL res -2112 640 R0
SYMATTR InstName R9
SYMATTR Value 1k
SYMBOL EIT_Semiconductors\\npn -1600 576 M0
SYMATTR InstName Q21
SYMATTR Value NPN1
SYMBOL res -1488 640 R0
SYMATTR InstName R10
SYMATTR Value 50
SYMBOL EXTRA\\Misc\\pot -1536 1152 R270
SYMATTR InstName U3
SYMATTR Value R={Ro}
SYMATTR Value2 T={off}
SYMBOL MDB_sym\\jumper -2496 144 R0
SYMATTR InstName X1
SYMBOL EIT_Semiconductors\\npn -1536 160 R0
SYMATTR InstName Q16
SYMATTR Value NPN1
SYMBOL res -1584 96 R0
SYMATTR InstName R11
SYMATTR Value 4.5k
SYMBOL res -1584 208 R0
SYMATTR InstName R12
SYMATTR Value 7.5k
SYMBOL bv -2576 1168 R0
SYMATTR InstName B2
SYMATTR Value V=Ro*off
SYMBOL bv -2672 1168 R0
WINDOW 3 1 140 Left 2
SYMATTR Value V=Ro*(1-off)
SYMATTR InstName B3
SYMBOL frame_ua741_moreRs_v2 -3312 -368 R0
SYMATTR InstName X2
TEXT -2424 872 Left 2 !.param stimp = 400m\n.param Vplus=10V\n.param m=5\n.param Vbe0 = 0.6V\n.param Veb0 = 0.6V\n.param VT=26mV\n.param betaNPN=200\n.param betaPNP=100\n.param alpha=0.991\n.param Ic0=100u\n.param Ccomp=15p
TEXT -2104 912 Left 2 ;.ac oct 100 .1 10meg
TEXT -2432 1200 Left 2 !.model NPN1 npn ( Is={Ic0/exp(Vbe0/VT)}  Bf={betaNPN} VA=50V)\n.model PNP1 pnp ( Is={Ic0/exp(Veb0/VT)}  Bf={betaPNP} VA=50V)
TEXT -2104 936 Left 2 !.tran 3m startup
TEXT -2096 856 Left 2 ;.dc V2 {-stimp} {stimp} .1m
TEXT -2104 968 Left 2 ;.dc I1 0 100u 1u
TEXT -2096 888 Left 2 ;.ac oct 100 10 10meg
TEXT -2088 832 Left 2 ;.dc V1 -1m 1m 1u
TEXT -1720 992 Left 2 !.param Ro=100k\n.param off = 0.650514
TEXT -1720 832 Left 2 ;; Find offset poti setting to compensate Vio\n;------------------------------------------------------------\n.step param off .01 .99 .01\n.meas Roffs_set WHEN V(out)=0 falling=1\n.meas RoffsR param Ro*Roffs_set\n.op
TEXT -2160 1328 Left 2 !;.meas I0m FIND Ic(Q8) at=1m\n.param I0m=16u\n.meas I0ma FIND Ic(Q8) at=100\n.meas Gmdv param alpha*I0m/(2*VT) \n.meas SR param alpha*I0m/Ccomp \n.meas ft param Gmdv/(2*pi*Ccomp)\n.meas ft2 WHEN mag(V(out))=1
TEXT -1960 1048 Left 2 !.op
LINE Normal -2112 -32 -2080 -144 1
LINE Normal -1984 -32 -1952 -144 1
LINE Normal -2016 64 -2096 16 1
LINE Normal -2432 416 -2400 384 1
LINE Normal -2128 416 -2096 384 1
LINE Normal -2288 416 -2256 384 1
RECTANGLE Normal -1296 1264 -1744 800 2
