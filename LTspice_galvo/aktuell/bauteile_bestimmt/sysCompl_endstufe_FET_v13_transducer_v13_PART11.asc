Version 4
SHEET 1 3152 2452
WIRE -1088 -2912 -1120 -2912
WIRE -1088 -2864 -1120 -2864
WIRE -1312 -2624 -1488 -2624
WIRE -1216 -2624 -1312 -2624
WIRE -1104 -2624 -1136 -2624
WIRE -1040 -2624 -1104 -2624
WIRE -704 -2624 -736 -2624
WIRE -608 -2624 -624 -2624
WIRE -1104 -2608 -1104 -2624
WIRE -944 -2608 -976 -2608
WIRE -880 -2608 -944 -2608
WIRE -1488 -2592 -1488 -2624
WIRE -1040 -2592 -1056 -2592
WIRE -128 -2592 -160 -2592
WIRE -16 -2592 -64 -2592
WIRE -1056 -2544 -1056 -2592
WIRE -944 -2544 -944 -2608
WIRE -944 -2544 -1056 -2544
WIRE -480 -2544 -480 -2560
WIRE -880 -2528 -880 -2544
WIRE -784 -2528 -880 -2528
WIRE -704 -2528 -784 -2528
WIRE -608 -2528 -608 -2624
WIRE -608 -2528 -624 -2528
WIRE -512 -2528 -608 -2528
WIRE -880 -2512 -880 -2528
WIRE -416 -2512 -448 -2512
WIRE -288 -2512 -416 -2512
WIRE -256 -2512 -288 -2512
WIRE -160 -2512 -160 -2592
WIRE -160 -2512 -176 -2512
WIRE -128 -2512 -160 -2512
WIRE -16 -2512 -16 -2592
WIRE -16 -2512 -48 -2512
WIRE -1488 -2496 -1488 -2512
WIRE -608 -2496 -608 -2528
WIRE -512 -2496 -544 -2496
WIRE -416 -2496 -416 -2512
WIRE -480 -2464 -480 -2480
WIRE -944 -2448 -1056 -2448
WIRE -880 -2448 -944 -2448
WIRE -1088 -2432 -1088 -2448
WIRE -160 -2416 -160 -2512
WIRE -112 -2416 -160 -2416
WIRE -1088 -2400 -1088 -2432
WIRE -608 -2400 -608 -2416
WIRE -544 -2400 -544 -2496
WIRE -416 -2400 -416 -2416
WIRE -416 -2400 -544 -2400
WIRE -16 -2400 -16 -2512
WIRE -16 -2400 -48 -2400
WIRE 32 -2400 -16 -2400
WIRE -1056 -2384 -1056 -2448
WIRE -1024 -2384 -1056 -2384
WIRE -416 -2384 -416 -2400
WIRE -256 -2384 -288 -2384
WIRE -160 -2384 -176 -2384
WIRE -112 -2384 -160 -2384
WIRE -944 -2368 -944 -2448
WIRE -944 -2368 -960 -2368
WIRE -160 -2368 -160 -2384
WIRE 1664 -2368 1520 -2368
WIRE -1024 -2352 -1056 -2352
WIRE 2048 -2352 1904 -2352
WIRE 1664 -2304 1664 -2368
WIRE 1664 -2304 1632 -2304
WIRE -1088 -2288 -1088 -2304
WIRE 1520 -2288 1520 -2368
WIRE 1520 -2288 1472 -2288
WIRE 1568 -2288 1520 -2288
WIRE 2048 -2288 2048 -2352
WIRE 2048 -2288 2016 -2288
WIRE 1072 -2272 1056 -2272
WIRE 1104 -2272 1072 -2272
WIRE 1232 -2272 1216 -2272
WIRE 1264 -2272 1232 -2272
WIRE 1648 -2272 1632 -2272
WIRE 1664 -2272 1648 -2272
WIRE 1760 -2272 1744 -2272
WIRE 1776 -2272 1760 -2272
WIRE 1904 -2272 1904 -2352
WIRE 1904 -2272 1856 -2272
WIRE 1952 -2272 1904 -2272
WIRE 2032 -2256 2016 -2256
WIRE 2048 -2256 2032 -2256
WIRE 2144 -2256 2128 -2256
WIRE 2160 -2256 2144 -2256
WIRE 2304 -2256 2240 -2256
WIRE 2368 -2256 2304 -2256
WIRE 1072 -2240 1056 -2240
WIRE 1104 -2240 1072 -2240
WIRE 1648 -2240 1648 -2272
WIRE 2032 -2224 2032 -2256
WIRE 2368 -2176 2368 -2256
WIRE -288 -2160 -288 -2384
WIRE -288 -2160 -560 -2160
WIRE 1520 -2128 1520 -2288
WIRE 1568 -2128 1520 -2128
WIRE 1760 -2128 1760 -2272
WIRE 1760 -2128 1632 -2128
WIRE 1904 -2112 1904 -2272
WIRE 1952 -2112 1904 -2112
WIRE 2144 -2112 2144 -2256
WIRE 2144 -2112 2016 -2112
WIRE 2368 -2080 2368 -2096
WIRE 336 -1952 320 -1952
WIRE 432 -1952 400 -1952
WIRE 448 -1952 432 -1952
WIRE 544 -1952 528 -1952
WIRE -1008 -1904 -1104 -1904
WIRE -832 -1904 -944 -1904
WIRE -592 -1904 -688 -1904
WIRE -416 -1904 -528 -1904
WIRE 320 -1888 320 -1952
WIRE -352 -1872 -384 -1872
WIRE -304 -1872 -352 -1872
WIRE -208 -1872 -240 -1872
WIRE 432 -1872 432 -1952
WIRE 544 -1872 432 -1872
WIRE -1376 -1840 -1472 -1840
WIRE -1280 -1840 -1296 -1840
WIRE -1200 -1840 -1280 -1840
WIRE -1104 -1840 -1104 -1904
WIRE -1104 -1840 -1120 -1840
WIRE -1088 -1840 -1104 -1840
WIRE -992 -1840 -1008 -1840
WIRE -928 -1840 -992 -1840
WIRE -1472 -1824 -1472 -1840
WIRE -832 -1824 -832 -1904
WIRE -832 -1824 -864 -1824
WIRE -784 -1824 -832 -1824
WIRE -688 -1824 -688 -1904
WIRE -688 -1824 -704 -1824
WIRE -672 -1824 -688 -1824
WIRE -576 -1824 -592 -1824
WIRE -512 -1824 -576 -1824
WIRE -992 -1808 -992 -1840
WIRE -928 -1808 -944 -1808
WIRE -416 -1808 -416 -1904
WIRE -416 -1808 -448 -1808
WIRE -352 -1808 -416 -1808
WIRE -304 -1808 -352 -1808
WIRE -208 -1808 -208 -1872
WIRE -208 -1808 -240 -1808
WIRE -64 -1808 -64 -1888
WIRE -64 -1808 -208 -1808
WIRE -576 -1792 -576 -1824
WIRE -512 -1792 -528 -1792
WIRE 320 -1792 320 -1808
WIRE -944 -1760 -944 -1808
WIRE -832 -1760 -832 -1824
WIRE -832 -1760 -944 -1760
WIRE -528 -1744 -528 -1792
WIRE -416 -1744 -416 -1808
WIRE -416 -1744 -528 -1744
WIRE -352 -1744 -384 -1744
WIRE -304 -1744 -352 -1744
WIRE -208 -1744 -208 -1808
WIRE -208 -1744 -240 -1744
WIRE -1472 -1728 -1472 -1744
WIRE -992 -1728 -992 -1744
WIRE -576 -1712 -576 -1728
WIRE 336 -1664 320 -1664
WIRE 384 -1664 336 -1664
WIRE 320 -1648 320 -1664
WIRE -1472 -1632 -1472 -1648
WIRE 320 -1552 320 -1568
WIRE -480 -1424 -496 -1424
WIRE -352 -1424 -400 -1424
WIRE -320 -1424 -352 -1424
WIRE 1024 -1360 1024 -1376
WIRE 1216 -1360 1216 -1376
WIRE 944 -1312 912 -1312
WIRE 1024 -1312 1024 -1328
WIRE 1024 -1312 1008 -1312
WIRE 1104 -1312 1024 -1312
WIRE 1216 -1312 1216 -1328
WIRE 1216 -1312 1168 -1312
WIRE 512 -1296 480 -1296
WIRE 592 -1296 576 -1296
WIRE -784 -1280 -816 -1280
WIRE 512 -1264 480 -1264
WIRE 592 -1264 592 -1296
WIRE 592 -1264 576 -1264
WIRE -784 -1248 -816 -1248
WIRE 1712 -1248 1712 -1264
WIRE 2064 -1248 2064 -1264
WIRE -336 -1232 -336 -1248
WIRE 512 -1232 480 -1232
WIRE 592 -1232 592 -1264
WIRE 592 -1232 576 -1232
WIRE 608 -1232 592 -1232
WIRE 704 -1232 688 -1232
WIRE 736 -1232 704 -1232
WIRE 832 -1232 816 -1232
WIRE 928 -1232 912 -1232
WIRE 1024 -1232 1024 -1312
WIRE 1024 -1232 1008 -1232
WIRE 1088 -1232 1024 -1232
WIRE 1216 -1232 1216 -1312
WIRE 1216 -1232 1168 -1232
WIRE 1264 -1232 1216 -1232
WIRE 1344 -1232 1328 -1232
WIRE 1792 -1232 1792 -1264
WIRE -784 -1216 -816 -1216
WIRE 1712 -1216 1712 -1248
WIRE 512 -1200 480 -1200
WIRE 592 -1200 592 -1232
WIRE 592 -1200 576 -1200
WIRE 1072 -1184 1056 -1184
WIRE -976 -1168 -976 -1184
WIRE -864 -1168 -864 -1184
WIRE -608 -1168 -624 -1168
WIRE -496 -1168 -544 -1168
WIRE -480 -1168 -496 -1168
WIRE 512 -1168 496 -1168
WIRE 592 -1168 592 -1200
WIRE 592 -1168 576 -1168
WIRE 768 -1168 752 -1168
WIRE 1072 -1168 1072 -1184
WIRE -336 -1152 -336 -1168
WIRE -320 -1152 -336 -1152
WIRE -224 -1152 -240 -1152
WIRE 704 -1152 704 -1232
WIRE 736 -1152 704 -1152
WIRE 832 -1136 800 -1136
WIRE 1792 -1136 1792 -1168
WIRE 1872 -1136 1872 -1168
WIRE 1872 -1136 1792 -1136
WIRE 2064 -1136 2064 -1248
WIRE 2064 -1136 1904 -1136
WIRE 736 -1120 704 -1120
WIRE 1024 -1120 1024 -1232
WIRE 1056 -1120 1024 -1120
WIRE 1712 -1120 1712 -1136
WIRE 1712 -1120 1568 -1120
WIRE -336 -1104 -336 -1152
WIRE 768 -1104 752 -1104
WIRE 2064 -1104 2064 -1136
WIRE -1168 -1088 -1184 -1088
WIRE -976 -1088 -976 -1104
WIRE -976 -1088 -1040 -1088
WIRE -864 -1088 -864 -1104
WIRE -864 -1088 -976 -1088
WIRE -832 -1088 -864 -1088
WIRE -784 -1088 -800 -1088
WIRE 1264 -1088 1216 -1088
WIRE 1344 -1088 1328 -1088
WIRE 1712 -1088 1712 -1120
WIRE 1792 -1088 1792 -1136
WIRE 1792 -1088 1712 -1088
WIRE 1808 -1088 1792 -1088
WIRE 1840 -1088 1808 -1088
WIRE -1136 -1072 -1136 -1088
WIRE -1072 -1072 -1136 -1072
WIRE 1712 -1072 1712 -1088
WIRE -512 -1056 -544 -1056
WIRE -496 -1056 -512 -1056
WIRE -448 -1056 -496 -1056
WIRE 512 -1056 480 -1056
WIRE 592 -1056 576 -1056
WIRE 608 -1056 592 -1056
WIRE 704 -1056 704 -1120
WIRE 704 -1056 688 -1056
WIRE 720 -1056 704 -1056
WIRE 832 -1056 832 -1136
WIRE 832 -1056 800 -1056
WIRE 944 -1056 832 -1056
WIRE 1056 -1056 944 -1056
WIRE 1568 -1056 1568 -1120
WIRE -1072 -1040 -1072 -1072
WIRE -1072 -1040 -1104 -1040
WIRE -976 -1040 -976 -1088
WIRE -864 -1040 -864 -1088
WIRE -704 -1040 -704 -1168
WIRE 944 -1040 944 -1056
WIRE -704 -1024 -704 -1040
WIRE 512 -1024 496 -1024
WIRE 592 -1024 592 -1056
WIRE 592 -1024 576 -1024
WIRE 1904 -1024 1904 -1040
WIRE 1968 -1024 1904 -1024
WIRE 2016 -1024 1968 -1024
WIRE 1968 -1008 1968 -1024
WIRE 1072 -992 1072 -1008
WIRE 1072 -992 1056 -992
WIRE 1904 -992 1904 -1024
WIRE -1152 -976 -1168 -976
WIRE -1072 -976 -1072 -1040
WIRE -1072 -976 -1088 -976
WIRE -1056 -976 -1072 -976
WIRE 1712 -976 1712 -992
WIRE 1712 -976 1696 -976
WIRE -512 -960 -512 -976
WIRE -448 -960 -448 -992
WIRE -448 -960 -512 -960
WIRE 944 -960 944 -976
WIRE -512 -944 -512 -960
WIRE 1712 -944 1712 -976
WIRE -336 -896 -336 -944
WIRE 1904 -896 1904 -928
WIRE 1968 -896 1968 -928
WIRE 1968 -896 1904 -896
WIRE 2032 -896 1968 -896
WIRE 2064 -896 2064 -1008
WIRE 2064 -896 2032 -896
WIRE -1152 -880 -1168 -880
WIRE -1072 -880 -1072 -976
WIRE -1072 -880 -1088 -880
WIRE -1056 -880 -1072 -880
WIRE 2064 -880 2064 -896
WIRE -512 -848 -512 -864
WIRE -976 -816 -1072 -816
WIRE -864 -816 -864 -848
WIRE 1712 -816 1712 -880
WIRE 1712 -816 1600 -816
WIRE 2064 -768 2064 -800
WIRE 2064 -768 1600 -768
WIRE 2128 -768 2064 -768
WIRE 2208 -768 2128 -768
WIRE 2304 -768 2272 -768
WIRE 2448 -768 2304 -768
WIRE -1520 -752 -1584 -752
WIRE -1504 -752 -1520 -752
WIRE -1424 -752 -1440 -752
WIRE -1184 -752 -1424 -752
WIRE -912 -752 -1184 -752
WIRE -896 -752 -912 -752
WIRE -800 -752 -800 -816
WIRE -800 -752 -816 -752
WIRE -784 -752 -800 -752
WIRE -704 -752 -704 -816
WIRE -688 -752 -704 -752
WIRE -96 -752 -608 -752
WIRE -1520 -736 -1520 -752
WIRE -912 -736 -912 -752
WIRE 2064 -736 2064 -768
WIRE -800 -672 -800 -752
WIRE -784 -672 -800 -672
WIRE -704 -672 -704 -752
WIRE -704 -672 -720 -672
WIRE 640 -672 560 -672
WIRE 784 -672 704 -672
WIRE -912 -656 -912 -672
WIRE 1712 -656 1712 -816
WIRE 2304 -656 2304 -768
WIRE -1520 -640 -1520 -672
WIRE 1040 -640 976 -640
WIRE 1232 -640 1104 -640
WIRE 2448 -640 2448 -768
WIRE 1968 -624 1904 -624
WIRE 2016 -624 1968 -624
WIRE 2064 -624 2064 -656
WIRE 2064 -624 2016 -624
WIRE 560 -592 560 -672
WIRE 688 -592 560 -592
WIRE 784 -592 784 -672
WIRE 784 -592 768 -592
WIRE 816 -592 784 -592
WIRE 1968 -592 1968 -624
WIRE 1904 -576 1904 -624
WIRE 976 -560 976 -640
WIRE 1104 -560 976 -560
WIRE 1232 -560 1232 -640
WIRE 1232 -560 1184 -560
WIRE 1344 -560 1344 -640
WIRE 1344 -560 1296 -560
WIRE 1712 -560 1712 -592
WIRE 1712 -560 1696 -560
WIRE 704 -544 688 -544
WIRE 1712 -544 1712 -560
WIRE 2304 -544 2304 -576
WIRE 2448 -544 2448 -560
WIRE 704 -528 704 -544
WIRE 1120 -512 1104 -512
WIRE 1344 -512 1344 -560
WIRE 2064 -512 2064 -624
WIRE -560 -496 -560 -512
WIRE 1120 -496 1120 -512
WIRE 1904 -496 1904 -512
WIRE 1936 -496 1904 -496
WIRE 1968 -496 1968 -512
WIRE 1968 -496 1936 -496
WIRE 2016 -496 1968 -496
WIRE -1136 -480 -1136 -512
WIRE -112 -480 -240 -480
WIRE 784 -480 784 -592
WIRE 784 -480 736 -480
WIRE 1904 -480 1904 -496
WIRE -240 -464 -240 -480
WIRE 2448 -464 2448 -480
WIRE 416 -448 384 -448
WIRE 560 -448 560 -592
WIRE 560 -448 480 -448
WIRE 592 -448 560 -448
WIRE 1232 -448 1232 -560
WIRE 1232 -448 1152 -448
WIRE 1712 -432 1712 -464
WIRE 1792 -432 1712 -432
WIRE 1808 -432 1792 -432
WIRE 1824 -432 1808 -432
WIRE 1840 -432 1824 -432
WIRE 816 -416 736 -416
WIRE 848 -416 816 -416
WIRE 880 -416 848 -416
WIRE 976 -416 976 -560
WIRE 976 -416 960 -416
WIRE 1008 -416 976 -416
WIRE 1712 -400 1712 -432
WIRE -560 -384 -560 -416
WIRE 1296 -384 1296 -560
WIRE 1296 -384 1152 -384
WIRE 1792 -384 1792 -432
WIRE 2064 -384 2064 -416
WIRE 2064 -384 1904 -384
WIRE 2304 -384 2304 -464
WIRE -560 -368 -560 -384
WIRE -240 -368 -240 -384
WIRE -1232 -352 -1232 -368
WIRE -1200 -352 -1232 -352
WIRE 656 -352 656 -368
WIRE 848 -352 848 -416
WIRE 1824 -352 1824 -432
WIRE 1920 -352 1824 -352
WIRE 704 -336 704 -368
WIRE 1344 -336 1344 -432
WIRE -432 -320 -512 -320
WIRE 1072 -320 1072 -336
WIRE -1232 -304 -1232 -352
WIRE -560 -304 -560 -320
WIRE 816 -304 816 -416
WIRE 1120 -304 1120 -336
WIRE 1792 -288 1792 -320
WIRE 1920 -288 1920 -352
WIRE 2064 -288 2064 -384
WIRE 1712 -272 1712 -320
WIRE 2064 -272 2064 -288
WIRE -1136 -256 -1136 -304
WIRE 816 -256 816 -272
WIRE 848 -256 848 -288
WIRE 1712 -256 1712 -272
WIRE -560 -240 -560 -304
WIRE 1920 -240 1920 -256
WIRE -1232 -192 -1232 -224
FLAG -1472 -1632 0
FLAG -80 -2432 +12V
FLAG -80 -2368 -12V
FLAG -160 -2288 0
FLAG 32 -2400 pwrCtrlx
IOPIN 32 -2400 Out
FLAG -288 -2384 ue2
FLAG -480 -2464 +12V
FLAG -480 -2560 -12V
FLAG -416 -2304 0
FLAG -608 -2400 0
FLAG -1488 -2496 0
FLAG -1088 -2864 Aref_2
FLAG -288 -2512 ue1
FLAG -992 -2400 +12V
FLAG -992 -2336 -12V
FLAG -1088 -2432 +12V
FLAG -496 -1424 0
FLAG -352 -1424 inp_vcalc
FLAG -864 -848 0
FLAG -1168 -976 0
FLAG -1168 -880 0
FLAG -912 -656 0
FLAG -864 -1184 0
FLAG -976 -1184 0
FLAG -784 -1216 cRg
FLAG -784 -1280 cRf
FLAG -784 -1248 cRb
FLAG -1040 -1088 +5V
FLAG -1072 -816 +5V
FLAG -336 -896 0
FLAG -512 -848 0
FLAG -336 -1248 0
FLAG -96 -752 posRaw
IOPIN -96 -752 In
FLAG -496 -1168 Aref_2
FLAG -896 -1792 +12V
FLAG -896 -1856 -12V
FLAG -992 -1728 0
FLAG -480 -1776 +12V
FLAG -480 -1840 -12V
FLAG -576 -1712 0
FLAG -1280 -1840 DACx
FLAG -352 -1872 DACx
FLAG -832 -1904 DACxf1
FLAG -352 -1808 DACxf2
FLAG -352 -1744 DACxf1
FLAG -560 -2160 I_ctrl
IOPIN -560 -2160 In
FLAG -64 -1888 I_ctrl
IOPIN -64 -1888 Out
FLAG -1088 -2288 0
FLAG -1008 -2576 +12V
FLAG -1008 -2640 -12V
FLAG -1104 -2544 0
FLAG -1312 -2624 LTDACa
FLAG -784 -2528 LTDAC_off
FLAG -1088 -2912 Aref
FLAG -1520 -640 0
FLAG -1584 -752 ADC_quant
IOPIN -1584 -752 Out
FLAG -1184 -752 posX_ADC
FLAG -736 -2624 Aref
FLAG -1296 -3088 0
FLAG -1152 -3088 0
FLAG -496 -1056 ref_adc
FLAG -1104 -1040 pump
IOPIN -1104 -1040 BiDir
FLAG -1136 -512 0
FLAG -1232 -512 0
FLAG -1136 -256 0
FLAG -560 -240 pump
IOPIN -560 -240 BiDir
FLAG -560 -512 0
FLAG -512 -368 0
FLAG -240 -368 0
FLAG -112 -480 posRaw
IOPIN -112 -480 In
FLAG -432 -320 0
FLAG -784 -1088 0
FLAG -1184 -1088 0
FLAG 1072 -2272 +12V
FLAG 1072 -2240 -12V
FLAG -288 -2848 0
FLAG -144 -2848 0
FLAG -288 -2928 +Vpwr
FLAG -144 -2928 -Vpwr
FLAG 1232 -2272 +5V
FLAG 544 -1952 stimOffs
FLAG 320 -1552 0
FLAG 336 -1664 calcSum
FLAG 320 -1792 0
FLAG 544 -1872 stimac
FLAG 2448 -464 0
FLAG 480 -1232 stimac
FLAG 480 -1264 stimOffs
FLAG 496 -1168 0
FLAG 832 -1232 0
FLAG 480 -1056 IsensA
FLAG 832 -1136 sumB
FLAG 1072 -1184 +Vpwr
FLAG 1072 -992 -Vpwr
FLAG 1968 -1024 b_hi
FLAG 2032 -896 e_hi
FLAG 2016 -624 e_lo
FLAG 1936 -496 b_lo
FLAG 1344 -1232 ucoil
IOPIN 1344 -1232 In
FLAG 1344 -1088 opV
IOPIN 1344 -1088 Out
FLAG 1120 -1008 0
FLAG 496 -1024 0
FLAG 480 -1296 stimpwl
FLAG 1808 -1088 HS
FLAG 1808 -432 LS
FLAG 1344 -336 0
FLAG 1344 -640 shunt
IOPIN 1344 -640 In
FLAG 848 -256 0
FLAG 896 -592 0
FLAG 384 -448 Isensa
FLAG 944 -960 0
FLAG 1600 -768 Ucoil
IOPIN 1600 -768 Out
FLAG 1696 -560 bias_lo1
FLAG 1712 -432 bias_lo2
FLAG 1712 -1088 bias_hi1
FLAG 1696 -976 bias_hi2
FLAG 1600 -816 opV
IOPIN 1600 -816 In
FLAG 2368 -2080 0
FLAG 1648 -2176 0
FLAG 1472 -2288 sallen
FLAG 2032 -2160 0
FLAG 1984 -2304 +12V
FLAG 1600 -2320 +12V
FLAG 1984 -2240 -12V
FLAG 1600 -2256 -12V
FLAG 2304 -384 shunt
IOPIN 2304 -384 Out
FLAG 2304 -2256 posDemod
FLAG 2128 -768 Ucoil
FLAG 480 -1200 pwrCtrlx
IOPIN 480 -1200 In
FLAG 1792 -1264 0
FLAG 1792 -288 0
FLAG 768 -1168 -12V
FLAG 768 -1104 +12V
FLAG 1712 -1248 +Vpwr
FLAG 2064 -1248 +Vpwr
FLAG 1712 -272 -Vpwr
FLAG 2064 -288 -Vpwr
FLAG 912 -1232 0
FLAG 912 -1312 0
FLAG 1232 -720 0
FLAG 1024 -1376 0
FLAG 1216 -1376 0
FLAG 1920 -240 0
FLAG 816 -256 0
DATAFLAG 1776 -816 "I(D7)"
DATAFLAG 1776 -720 "I(D11)"
SYMBOL source-V -1472 -1744 M0
WINDOW 123 28 52 Left 2
WINDOW 39 0 0 Left 2
SYMATTR Value2 AC 1
SYMATTR InstName V1
SYMATTR Value PULSE(0 1 0 100n 100n 250u 500u)
SYMBOL res -272 -2496 R270
WINDOW 0 25 56 VTop 2
WINDOW 3 7 56 VBottom 2
SYMATTR InstName R1
SYMATTR Value {R1}
SYMBOL res -272 -2368 R270
WINDOW 0 25 56 VTop 2
WINDOW 3 7 56 VBottom 2
SYMATTR InstName R2
SYMATTR Value {R3}
SYMBOL res -176 -2384 R0
SYMATTR InstName R3
SYMATTR Value {R4}
SYMBOL res -144 -2496 R270
WINDOW 0 25 56 VTop 2
WINDOW 3 7 56 VBottom 2
SYMATTR InstName R4
SYMATTR Value {R2}
SYMBOL res -432 -2512 R0
SYMATTR InstName R5
SYMATTR Value 22k
SYMBOL res -432 -2400 R0
SYMATTR InstName R6
SYMATTR Value 22k
SYMBOL source-V -1488 -2608 M0
WINDOW 123 0 0 Left 2
WINDOW 39 0 0 Left 2
SYMATTR InstName V2
SYMATTR Value PULSE(0 3 10m 20m)
SYMBOL Misc\\jumper -816 -2480 R90
SYMATTR InstName X1
SYMBOL res -720 -2640 M90
WINDOW 0 0 56 VBottom 2
WINDOW 3 32 56 VTop 2
SYMATTR InstName R7
SYMATTR Value {R4b}
SYMBOL res -720 -2544 M90
WINDOW 0 0 56 VBottom 2
WINDOW 3 32 56 VTop 2
SYMATTR InstName R8
SYMATTR Value {R9}
SYMBOL res -592 -2512 M0
WINDOW 3 33 72 Left 2
WINDOW 0 35 48 Left 2
SYMATTR Value {R10}
SYMATTR InstName R9
SYMBOL source-Vmarker -1120 -2864 R0
WINDOW 3 -14 0 Right 2
SYMATTR Value V={Aref/2}
SYMATTR InstName U1
SYMBOL bv -384 -1424 R90
WINDOW 0 -27 56 VBottom 2
WINDOW 3 31 -9 VTop 2
SYMATTR InstName B1
SYMATTR Value V=1
SYMBOL Opamps\\LTC6360 -864 -928 M0
SYMATTR InstName U2
SYMBOL cap -1152 -896 M90
WINDOW 0 0 32 VBottom 2
WINDOW 3 32 32 VTop 2
SYMATTR InstName C1
SYMATTR Value 1µ
SYMBOL cap -1088 -960 M270
WINDOW 0 32 32 VTop 2
WINDOW 3 0 32 VBottom 2
SYMATTR InstName C2
SYMATTR Value .2µ
SYMBOL res -800 -736 M270
WINDOW 0 32 56 VTop 2
WINDOW 3 0 56 VBottom 2
SYMATTR InstName R10
SYMATTR Value 10
SYMBOL cap -896 -736 M0
SYMATTR InstName C3
SYMATTR Value 330p
SYMBOL cap -960 -1168 M0
SYMATTR InstName C4
SYMATTR Value 0.1µ
SYMBOL cap -848 -1168 M0
SYMATTR InstName C5
SYMATTR Value 10µ
SYMBOL source-Vmarker -816 -1280 R0
SYMATTR Value V={Rf}
SYMATTR InstName U3
SYMBOL source-Vmarker -816 -1248 R0
SYMATTR Value V={Rb}
SYMATTR InstName U4
SYMBOL source-Vmarker -816 -1216 R0
SYMATTR Value V={Rg}
SYMATTR InstName U5
SYMBOL res -800 -736 R270
WINDOW 0 25 56 VTop 2
WINDOW 3 7 56 VBottom 2
SYMATTR InstName Rf1
SYMATTR Value {Rf}
SYMBOL res -592 -736 M270
WINDOW 0 25 56 VTop 2
WINDOW 3 7 56 VBottom 2
SYMATTR InstName Rg1
SYMATTR Value {Rg}
SYMBOL res -608 -1152 M270
WINDOW 0 25 56 VTop 2
WINDOW 3 7 56 VBottom 2
SYMATTR InstName Rb1
SYMATTR Value {Rb}
SYMBOL Opamps\\LT1058 -480 -2448 M180
SYMATTR InstName U6
SYMBOL Opamps\\LT1058 -80 -2464 R0
SYMATTR InstName U7
SYMBOL Opamps\\LT1058 -992 -2432 R0
SYMATTR InstName U8
SYMBOL cap -128 -2576 R270
WINDOW 0 32 32 VTop 2
WINDOW 3 0 32 VBottom 2
SYMATTR InstName C6
SYMATTR Value 1p
SYMBOL References\\LT6650 -336 -1024 M0
SYMATTR InstName U9
SYMBOL res -496 -1072 M0
WINDOW 0 -30 44 Left 2
WINDOW 3 -29 227 Right 2
SYMATTR InstName R11
SYMATTR Value {(VrefSet/0.4V-1)*20k}
SYMBOL res -528 -960 R0
SYMATTR InstName R12
SYMATTR Value 20k
SYMBOL MDB_sym\\jumperRes -576 -1232 M0
SYMATTR InstName U10
SYMBOL res -224 -1136 M270
WINDOW 0 25 56 VTop 2
WINDOW 3 7 56 VBottom 2
SYMATTR InstName R13
SYMATTR Value 1k
SYMBOL cap -320 -1232 M0
SYMATTR InstName C7
SYMATTR Value 1n
SYMBOL source-Vmarker -224 -1152 M0
SYMATTR InstName U11
SYMBOL res -1216 -1856 M90
WINDOW 0 0 56 Invisible 2
WINDOW 3 32 56 VTop 2
SYMATTR InstName R14
SYMATTR Value 5k36
SYMBOL res -1104 -1856 M90
WINDOW 0 0 56 Invisible 2
WINDOW 3 32 56 VTop 2
SYMATTR InstName R15
SYMATTR Value 9k09
SYMBOL cap -1008 -1888 R270
WINDOW 0 32 32 Invisible 2
WINDOW 3 0 32 VBottom 2
SYMATTR InstName C8
SYMATTR Value 1n5
SYMBOL cap -976 -1808 M0
WINDOW 0 24 8 Invisible 2
SYMATTR InstName C9
SYMATTR Value 1n
SYMBOL res -800 -1840 M90
WINDOW 0 0 56 Invisible 2
WINDOW 3 32 56 VTop 2
SYMATTR InstName R16
SYMATTR Value 2k67
SYMBOL res -688 -1840 M90
WINDOW 0 0 56 Invisible 2
WINDOW 3 32 56 VTop 2
SYMATTR InstName R17
SYMATTR Value 1k33
SYMBOL cap -592 -1888 R270
WINDOW 0 32 32 Invisible 2
WINDOW 3 0 32 VBottom 2
SYMATTR InstName C10
SYMATTR Value 6n8
SYMBOL cap -560 -1792 M0
WINDOW 0 24 8 Invisible 2
SYMATTR InstName C11
SYMATTR Value 1n
SYMBOL MDB_sym\\jumperRes -272 -1872 R0
SYMATTR InstName U12
SYMBOL EXTRA\\Misc\\pot -1088 -2352 M0
SYMATTR InstName U13
SYMATTR Value R=100k
SYMBOL Opamps\\LT1058 -896 -1760 M180
SYMATTR InstName U14
SYMBOL Opamps\\LT1058 -480 -1744 M180
SYMATTR InstName U15
SYMBOL res -1232 -2640 M90
WINDOW 0 0 56 Invisible 2
WINDOW 3 32 56 VTop 2
SYMATTR InstName R18
SYMATTR Value 1k
SYMBOL cap -1088 -2608 M0
WINDOW 0 24 8 Invisible 2
WINDOW 3 -19 14 Left 2
SYMATTR InstName C12
SYMATTR Value 1n
SYMBOL Opamps\\LT1058 -1008 -2544 M180
SYMATTR InstName U16
SYMBOL source-Vmarker -1120 -2912 R0
WINDOW 3 -30 -1 Right 2
SYMATTR Value V={Aref}
SYMATTR InstName U17
SYMBOL res -1408 -768 R90
WINDOW 0 7 56 VBottom 2
WINDOW 3 25 56 VTop 2
SYMATTR InstName R19
SYMATTR Value 100
SYMBOL cap -1504 -736 M0
SYMATTR InstName C13
SYMATTR Value 1p
SYMBOL source-V -1472 -1840 M0
WINDOW 123 28 52 Left 2
WINDOW 39 0 0 Left 2
SYMATTR Value2 AC 1
SYMATTR InstName V3
SYMATTR Value PULSE(0 {Aref/2} 0 500u)
SYMBOL cap -720 -688 R90
WINDOW 0 0 32 VBottom 2
WINDOW 3 32 32 VTop 2
SYMATTR InstName C14
SYMATTR Value {Csar}
SYMBOL EIT_Semiconductors\\pnp -1200 -304 M180
SYMATTR InstName T1
SYMATTR Value FMMT723
SYMBOL res -1248 -320 R0
SYMATTR InstName R20
SYMATTR Value 10k
SYMBOL source-Vmarker -1232 -192 R0
SYMATTR Value V=-5V
SYMATTR InstName U18
SYMBOL res -1152 -496 R0
SYMATTR InstName R21
SYMATTR Value 1k
SYMBOL diode -1248 -512 R0
SYMATTR InstName D1
SYMATTR Value 1N4148
SYMBOL res -1248 -464 R0
SYMATTR InstName R22
SYMATTR Value 1k
SYMBOL res -544 -512 M0
SYMATTR InstName R23
SYMATTR Value 1
SYMBOL source-V -240 -480 R0
WINDOW 123 0 0 Left 2
WINDOW 39 0 0 Left 2
SYMATTR InstName V4
SYMATTR Value SINE(0 25 100)
SYMBOL sw -560 -400 M0
SYMATTR InstName S1
SYMATTR Value mySW
SYMBOL res -1280 -1856 R90
WINDOW 0 7 56 VBottom 2
WINDOW 3 25 56 VTop 2
SYMATTR InstName R24
SYMATTR Value 1
SYMBOL source-Vmarker 1056 -2272 R0
SYMATTR Value V=+12V
SYMATTR InstName U19
SYMBOL source-Vmarker 1056 -2240 R0
SYMATTR Value V=-12V
SYMATTR InstName U20
SYMBOL source-V -144 -2944 R0
WINDOW 123 0 0 Left 2
WINDOW 39 0 0 Left 2
SYMATTR InstName V5
SYMATTR Value PULSE(0 {-Vsup} 0 500u)
SYMBOL source-V -288 -2944 R0
WINDOW 3 -13 132 Left 2
WINDOW 123 0 0 Left 2
WINDOW 39 0 0 Left 2
SYMATTR Value PULSE(0 {Vsup} 0 500u)
SYMATTR InstName V6
SYMBOL source-Vmarker 1216 -2272 R0
SYMATTR Value V=+5V
SYMATTR InstName U21
SYMBOL source-V 544 -1952 M270
WINDOW 0 -27 56 VBottom 2
WINDOW 3 -28 -144 VBottom 2
WINDOW 123 0 0 Left 2
WINDOW 39 0 0 Left 2
SYMATTR InstName V7
SYMATTR Value PULSE({Vstim_peak} 0 0 100u)
SYMBOL bv 320 -1664 R0
WINDOW 3 49 50 Left 2
WINDOW 0 47 27 Left 2
SYMATTR Value V=V(stimoffs)-V(isensa)
SYMATTR InstName B2
SYMBOL source-V 320 -1904 R0
WINDOW 3 43 95 Left 2
WINDOW 123 43 67 Left 2
WINDOW 39 0 0 Left 2
WINDOW 0 46 46 Left 2
SYMATTR Value SINE(20m 1 100 20m)
SYMATTR Value2 AC 1
SYMATTR InstName V8
SYMBOL MDB_sym\\jumperRes 368 -2016 R0
WINDOW 0 1 88 Bottom 2
SYMATTR InstName U22
SYMBOL res 2288 -560 R0
SYMATTR InstName R28
SYMATTR Value 3.5
SYMBOL ind 2288 -672 R0
SYMATTR InstName L1
SYMATTR Value {Lcoil}
SYMBOL res 2432 -656 R0
SYMATTR InstName R29
SYMATTR Value 1t
SYMBOL cap 2432 -544 R0
SYMATTR InstName C15
SYMATTR Value 100n
SYMBOL Misc\\jumper 2240 -832 R0
SYMATTR InstName X2
SYMBOL Misc\\jumper 544 -1264 R0
SYMATTR InstName X3
SYMBOL res 592 -1248 M90
WINDOW 0 7 56 VBottom 2
WINDOW 3 25 56 VTop 2
SYMATTR InstName R30
SYMATTR Value 3k3
SYMBOL Opamps\\LTC6090 1120 -1088 R0
WINDOW 0 63 -48 Left 2
SYMATTR InstName U23
SYMBOL res 912 -1248 M90
WINDOW 0 7 56 VBottom 2
WINDOW 3 25 56 VTop 2
SYMATTR InstName R31
SYMATTR Value 5k1
SYMBOL EIT_Semiconductors\\npn 1840 -1136 R0
SYMATTR InstName T2
SYMATTR Value FMMT624
SYMBOL EIT_Semiconductors\\pnp 1840 -384 M180
SYMATTR InstName T3
SYMATTR Value FMMT723
SYMBOL res 1984 -1024 M0
WINDOW 3 67 149 Right 2
SYMATTR Value {bias_be1}
SYMATTR InstName R32
SYMBOL res 1952 -608 R0
WINDOW 3 -32 -42 Left 2
SYMATTR Value {bias_be1}
SYMATTR InstName R33
SYMBOL res 2048 -896 R0
SYMATTR InstName R34
SYMATTR Value .015
SYMBOL res 2048 -640 M180
WINDOW 0 36 76 Left 2
WINDOW 3 36 40 Left 2
SYMATTR InstName R35
SYMATTR Value .015
SYMBOL cap 1920 -992 M0
SYMATTR InstName C16
SYMATTR Value 10f
SYMBOL Misc\\jumper 1296 -1152 R0
SYMATTR InstName X4
SYMBOL Misc\\jumper 1296 -1296 R0
SYMATTR InstName X5
SYMBOL Misc\\jumper 544 -1120 R0
SYMATTR InstName X6
SYMBOL cap 1104 -1328 M90
WINDOW 0 0 32 VBottom 2
WINDOW 3 32 32 VTop 2
SYMATTR InstName C17
SYMATTR Value 22p
SYMBOL res 1328 -528 R0
SYMATTR InstName Rsh1
SYMATTR Value 0.015
SYMBOL Opamps\\LTC2050 1120 -416 M0
SYMATTR InstName U24
SYMBOL source-Vmarker 1104 -512 R0
SYMATTR InstName U25
SYMBOL source-Vmarker 1120 -304 R180
SYMATTR Value V=-5V
SYMATTR InstName U26
SYMBOL res 1088 -544 R270
WINDOW 0 32 56 VTop 2
WINDOW 3 0 56 VBottom 2
SYMATTR InstName R36
SYMATTR Value 270
SYMBOL res 1248 -624 R180
WINDOW 0 36 76 Left 2
WINDOW 3 36 40 Left 2
SYMATTR InstName R37
SYMATTR Value 27
SYMBOL cap 1040 -624 R270
WINDOW 0 32 32 VTop 2
WINDOW 3 0 32 VBottom 2
SYMATTR InstName C18
SYMATTR Value 10p
SYMBOL source-Vmarker 1072 -320 R0
SYMATTR InstName U27
SYMBOL Opamps\\LTC2050 704 -448 M0
SYMATTR InstName U28
SYMBOL source-Vmarker 688 -544 R0
SYMATTR InstName U29
SYMBOL source-Vmarker 704 -336 R180
SYMATTR Value V=-5V
SYMATTR InstName U30
SYMBOL res 672 -576 R270
WINDOW 0 32 56 VTop 2
WINDOW 3 0 56 VBottom 2
SYMATTR InstName R38
SYMATTR Value 180
SYMBOL res 864 -400 R270
WINDOW 0 32 56 VTop 2
WINDOW 3 0 56 VBottom 2
SYMATTR InstName R39
SYMATTR Value 1k
SYMBOL source-Vmarker 656 -352 R0
SYMATTR InstName U31
SYMBOL res 800 -576 R270
WINDOW 0 32 56 VTop 2
WINDOW 3 0 56 VBottom 2
SYMATTR InstName R40
SYMATTR Value 20
SYMBOL Misc\\jumper 448 -512 M0
SYMATTR InstName X7
SYMBOL cap 832 -352 R0
SYMATTR InstName C19
SYMATTR Value {1/(2*pi*1k*100k)}
SYMBOL res 1072 -1216 R270
WINDOW 0 25 56 VTop 2
WINDOW 3 7 56 VBottom 2
SYMATTR InstName R41
SYMATTR Value {5k1*Kp}
SYMBOL Opamps\\LT1468 768 -1072 M180
WINDOW 0 -20 64 Left 2
WINDOW 3 -115 65 Left 2
SYMATTR InstName U32
SYMBOL res 1696 -1088 R0
SYMATTR InstName R42
SYMATTR Value {bias_b1}
SYMBOL res 1696 -560 R0
SYMATTR InstName R43
SYMATTR Value {bias_b1}
SYMBOL source-I 1712 -320 R180
WINDOW 0 59 61 Left 2
WINDOW 3 47 37 Left 2
WINDOW 123 0 0 Left 2
WINDOW 39 35 11 Left 2
SYMATTR InstName I1
SYMATTR Value {Iq}
SYMATTR SpiceLine load
SYMBOL diode 1696 -944 R0
WINDOW 3 108 32 Right 2
SYMATTR Value 1N4148
SYMATTR InstName D2
SYMBOL diode 1696 -656 R0
WINDOW 3 113 32 Right 2
SYMATTR Value 1N4148
SYMATTR InstName D3
SYMBOL voltage 2368 -2192 M0
WINDOW 123 24 124 Left 2
WINDOW 39 24 117 Left 2
WINDOW 3 -60 158 Left 2
SYMATTR Value2 AC 1
SYMATTR Value SINE(0 1 {fsig})
SYMATTR InstName V9
SYMBOL res 1648 -2288 M90
WINDOW 0 0 56 VBottom 2
WINDOW 3 32 56 VTop 2
SYMATTR InstName R44
SYMATTR Value {R2b}
SYMBOL res 1760 -2288 M90
WINDOW 0 0 56 VBottom 2
WINDOW 3 32 56 VTop 2
SYMATTR InstName R45
SYMATTR Value {R1b}
SYMBOL cap 1664 -2240 M0
SYMATTR InstName C20
SYMATTR Value {C1b}
SYMBOL cap 1568 -2144 M90
WINDOW 0 0 32 VBottom 2
WINDOW 3 32 32 VTop 2
SYMATTR InstName C21
SYMATTR Value {C2b}
SYMBOL res 2032 -2272 M90
WINDOW 0 0 56 VBottom 2
WINDOW 3 32 56 VTop 2
SYMATTR InstName R46
SYMATTR Value {R2a}
SYMBOL res 2144 -2272 M90
WINDOW 0 0 56 VBottom 2
WINDOW 3 32 56 VTop 2
SYMATTR InstName R47
SYMATTR Value {R1a}
SYMBOL cap 2048 -2224 M0
SYMATTR InstName C22
SYMATTR Value {C1a}
SYMBOL Opamps\\LT1124 1984 -2336 M0
SYMATTR InstName U33
SYMBOL cap 1952 -2128 M90
WINDOW 0 0 32 VBottom 2
WINDOW 3 32 32 VTop 2
SYMATTR InstName C23
SYMATTR Value {C2a}
SYMBOL Opamps\\LT1124 1600 -2352 M0
SYMATTR InstName U35
SYMBOL EIT_Semiconductors\\nmos 2016 -1104 R0
SYMATTR InstName M1
SYMATTR Value IRFP240 off
SYMBOL EIT_Semiconductors\\pmos 2016 -416 M180
SYMATTR InstName M2
SYMATTR Value IRFP9240
SYMBOL cap 1920 -576 M0
SYMATTR InstName C24
SYMATTR Value 10f
SYMBOL source-I 1712 -1136 R180
WINDOW 0 59 61 Left 2
WINDOW 3 47 37 Left 2
WINDOW 123 0 0 Left 2
WINDOW 39 35 11 Left 2
SYMATTR InstName I2
SYMATTR Value {Iq}
SYMATTR SpiceLine load
SYMBOL res 592 -1072 M90
WINDOW 0 7 56 VBottom 2
WINDOW 3 25 56 VTop 2
SYMATTR InstName R52
SYMATTR Value 3k3
SYMBOL res 704 -1072 M90
WINDOW 0 7 56 VBottom 2
WINDOW 3 25 56 VTop 2
SYMATTR InstName R53
SYMATTR Value 3k3
SYMBOL res 720 -1248 M90
WINDOW 0 7 56 VBottom 2
WINDOW 3 25 56 VTop 2
SYMATTR InstName R54
SYMATTR Value 3k3
SYMBOL cap 1776 -1232 R0
SYMATTR InstName C25
SYMATTR Value 22p
SYMBOL cap 1776 -320 M180
WINDOW 0 24 64 Left 2
WINDOW 3 24 8 Left 2
SYMATTR InstName C26
SYMATTR Value 22p
SYMBOL cap 944 -1328 M90
WINDOW 0 0 32 VBottom 2
WINDOW 3 32 32 VTop 2
SYMATTR InstName C27
SYMATTR Value 150p
TEXT -1704 -2968 Left 5 ;STM32f429i
TEXT -1696 -2760 Left 5 ;STM32 DAC \nVout_ctrl
TEXT -1688 -1864 Left 2 ;PULSE(0 3 2m 10n 10n 500u 1m)
TEXT -552 -2704 Left 2 !.param R9 = 27k\n.param R4b = 3910\n.param R10 = 1220
TEXT -96 -2296 Left 2 !.param R1=60k\n.param R2=120k\n.param R3=60k\n.param R4=120k
TEXT -1224 -1272 Left 3 ;SAR ADC driver\nAngular position
TEXT -528 -2136 Left 1 ;Eingangswiderstand muss >15k \nsein (DAC0_SEL == DAC0 STM32)
TEXT -1192 -2000 Left 3 ;DAC reconstruction
TEXT -1216 -1688 Left 2 ;; ti filter bench\n; ******  Antialias posDemod ADC  ******\n; Lowpass, Sallen Key, Gaussian to 6 dB\n; fc = 20kHz   (Cut-off)\n; fs = 100kHz (Stopband)\n; Asb = -45dB (Verstärkung bei fs)
TEXT -824 -1592 Left 2 ;.param R1a=5.36k  R2a=9.09k  C1a=910p  C2a=1.5n\n.param R1b=2.67k R2b=1.33k  C1b=910p  C2b=6.8n
TEXT -1224 -2688 Left 1 ;Digital offset for DAC bias\nreconstruction filter
TEXT -1232 -2736 Left 1 ;DAC levelshifter bias circuit
TEXT -1176 -2968 Left 3 ;REF2050
TEXT -632 -1360 Left 2 ;V=(Aref/R4b+V(DAC_offs)/R9) * 1/(1/R4b+1/R9+1/R10)
TEXT -632 -640 Left 2 !.param Csar = 10p
TEXT -704 -552 Left 2 !.param Ipump = 1m
TEXT -824 -96 Left 2 !.model mysw sw (Ron=1m Roff=1meg Vt=10 Vh=-.05 Ilimit=50m)
TEXT -1704 -1608 Left 2 ;SINE(0 1 {f_I_ctrl} 1m)
TEXT -680 -3056 Left 2 !.OPTIONS METHOD=GEAR
TEXT 1008 -2672 Left 2 ;;.tran 0 100m 1m\n;.options plotwinsize=0\n;.tran 0 2.8m 1.9m 1e-7\n.ac oct 100 10 1meg
TEXT 1008 -2536 Left 2 ;.option noopiter\n.options plotwinsize=0\n.four 1k 10 I(L1)
TEXT 1008 -2568 Left 2 ;.dc V3 -5 5 .01
TEXT 1008 -2704 Left 2 !.tran 0 3m 1m
TEXT 1008 -2448 Left 2 ;.tran 0 100m 1m\n.options plotwinsize=0
TEXT 1016 -2384 Left 2 ;.tran 0 50m\n.options plotwinsize=0
TEXT 1008 -2336 Left 2 ;.step param I0 list 100u 10n
TEXT 544 -2696 Left 2 !; ---------------------\n;   Power amp\n; ---------------------\n;.param Rset_bias = 100\n.param Iq = 1m\n;.param UV1 = 0.75V\n.param bias_be1 = 150\n;.param bias_b1 = {UV1/Ik3}\n.param bias_b1 = 750\n.param Lcoil = 170u
TEXT 304 -2696 Left 2 !; ---------------------\n;   Compensator\n; ---------------------\n.param Rsu = 1k\n.param Kp = 5\n;.param Ki = 15000
TEXT 304 -2528 Left 2 !; ---------------------\n;   SOURCES\n; ---------------------\n.param Vsup = 25V\n.param Vstim_peak = 5\n.param Aref = 2.5V  ; Ref2050
TEXT 320 -1752 Left 2 ;PULSE({-Vstim_peak} {Vstim_peak} 0 100n 100n 1m 2m)\nPULSE({-Vstim_peak} {Vstim_peak} 0 100m 100n 500u 100m)
TEXT 304 -2736 Left 3 ;Parameter
TEXT 304 -2016 Left 3 ;Stimulus
TEXT 600 -2368 Left 2 !.param f_I_ctrl = 500
TEXT -96 -1024 Left 2 !.param deltaVpos = 20V\n.param deltaVa = 3V\n.param VaMin = 0V \n.param gain = deltaVa / deltaVpos
TEXT -96 -1192 Left 2 !.param vrefset=1.3V\n.param Rg = 5k\n.param Rf = Rg*gain\n.param Rb = {Rf*Rg/(Rf+Rg)}\n.param Vref = 1/2 * deltaVa/(1+Rf/Rg)\n.param k=0.42
TEXT 1048 -824 Left 2 !.param Cf = 3p3
TEXT 1264 -296 Left 2 !.param Rshm=0.003
TEXT 1944 -848 Left 2 ;150R
TEXT 1936 -672 Left 2 ;150R
TEXT 2240 -1320 Left 3 ;Bias_b1 = 750R\nBias_be1 = 15R\n2x2 1N4148 \nI3=1mA \n-------------------------\n55mA Ruhestrom durch Rs
TEXT 1040 -264 Left 2 ;Vu1= -10/3
TEXT 648 -280 Left 2 ;Vu2 = 20
TEXT 1264 -248 Left 2 ;gesamt Av=40dB
TEXT 416 -896 Left 2 ;.param TEST=1\n;.step param TEST list 1 0\n;.step param Kpi list 2 5 25
TEXT 720 -960 Left 2 !.param Ctp = 10p
TEXT 1888 -1720 Left 2 ;; ti filter bench\n; **********  Antialias posDemod ADC  **********\n; Lowpass, Sallen Key, Gaussian to 6 dB\n; fc = 20kHz   (Cut-off)\n; fs = 100kHz (Stopband)\n; Asb = -45dB (Verstärkung bei fs)\n  \n.param R1a=5.36k  R2a=9.09k  C1a=910p  C2a=1.5n\n.param R1b=2.67k R2b=1.33k  C1b=910p  C2b=6.8n
TEXT 1352 -1968 Left 2 !; ti filter bench\n; **********  Antialias posDemod ADC  **********\n; Lowpass, Sallen Key, Chebyshev 0.2 dB\n; fc = 10kHz   (Cut-off)\n; fs = 33kHz (Stopband)\n; Asb = -45dB (Verstärkung bei fs)\n \n.param R1a=12.7k  R2a=22.1k  C1a=910p  C2a=1.8n\n.param R1b=2.67k R2b=3.32k  C1b=910p  C2b=22n
TEXT 1640 -2408 Right 3 ;Antialias position signal
TEXT 1888 -1976 Left 2 ;; ti filter bench\n; **********  Antialias posDemod ADC  **********\n; Lowpass, Sallen Key\n; fc = 3kHz   (Cut-off)\n; fs = 10kHz (Stopband)     ; = fs/2 @ Ts=50us\n; Asb = -45dB (Verstärkung bei fs)\n \n.param R1a=5.6k  R2a=6.8k  C1a=10n  C2a=20n\n.param R1b=680 R2b=1k  C1b=10n  C2b=360n
TEXT 2296 -2000 Left 2 !.param sim_end = 10m\n.param fsig = 10k
TEXT 352 -1400 Left 5 ;PCB power v1.3
TEXT 2360 -400 Left 2 ;.ic I(L1)=-1A
TEXT 2120 -2864 Left 2 ;Messwandler v1.6\nSTM32 DAC out --> Endstufe Vin_ctrl\n0 ... 3V                --> -5V ... 5V\n \nENDSTUFE INVERTIERT!!!!\n------------------------------------------------------------------------\nUa=Ue2 * (R1+R2)/R1 * R4/(R3+R4) - Ue1 * R2/R1\nUe1 * R2/R1 @ Ue1=3V  !=  10V  \n -->  R2=10/3*R1\n------------------------------------------------------------------------\nUe2* 13/3 * R4/(R3+R4) @ Ue2=2.5V (ref)  !=  +5V\n --> R4/(R3+R4)  !=  5V * 3/(13 * 2.5V)\n<--> (R3+R4)/R4  !=  13/6\n--> R3=7a   R4=6a     a el. |R\n------------------------------------------------------------------------
TEXT 1424 -2616 Left 2 !.include LM358.lib\n.include OPA404.LIB
TEXT 1424 -2664 Left 3 ;Include
LINE Normal -1392 -3056 -1392 -376
LINE Normal -1408 -3056 -1408 -376
LINE Normal 208 -3056 208 -440
LINE Normal 192 -3056 192 -440
RECTANGLE Normal -1248 -608 -128 -1312 2
RECTANGLE Normal -144 -1504 -1248 -2048 2
RECTANGLE Normal -1008 -2832 -1248 -2992 2
RECTANGLE Normal -912 -2512 -1232 -2704 2
RECTANGLE Normal -352 -2256 -1248 -2752 2
RECTANGLE Normal -1008 -2832 -1248 -2992 2
RECTANGLE Normal -1008 -2832 -1248 -2944 2
RECTANGLE Normal 1288 -2312 960 -2728 2
RECTANGLE Normal 912 -2200 272 -2776 2
RECTANGLE Normal 912 -1480 272 -2056 2
RECTANGLE Normal 1456 -784 352 -1360 2
RECTANGLE Normal 1312 -1472 2576 -2448 2
RECTANGLE Normal 2192 -224 1504 -1360 2
RECTANGLE Normal 1456 -224 496 -720 2
RECTANGLE Normal 1456 -784 352 -1360 2
RECTANGLE Normal 2576 -1456 304 -128 2
RECTANGLE Normal 2008 -2552 1400 -2712 2
