Version 4
SHEET 1 1316 712
WIRE 528 -1504 528 -1552
WIRE 528 -1376 528 -1424
WIRE -1072 -1328 -1200 -1328
WIRE -1200 -1296 -1200 -1328
WIRE -544 -1232 -672 -1232
WIRE -224 -1232 -224 -1248
WIRE -1104 -1216 -1136 -1216
WIRE -992 -1216 -1104 -1216
WIRE -672 -1200 -672 -1232
WIRE -1104 -1184 -1104 -1216
WIRE -992 -1184 -992 -1216
WIRE -304 -1152 -304 -1168
WIRE -304 -1152 -352 -1152
WIRE -224 -1152 -304 -1152
WIRE 560 -1136 560 -1184
WIRE 656 -1136 656 -1184
WIRE -576 -1120 -608 -1120
WIRE 240 -1104 176 -1104
WIRE -576 -1088 -576 -1120
WIRE -480 -1088 -496 -1088
WIRE -448 -1088 -480 -1088
WIRE 176 -1088 176 -1104
WIRE -1200 -1072 -1200 -1136
WIRE -1104 -1072 -1104 -1104
WIRE -1104 -1072 -1200 -1072
WIRE -1104 -1040 -1104 -1072
WIRE -448 -1008 -448 -1040
WIRE -400 -1008 -400 -1024
WIRE -304 -1008 -304 -1152
WIRE 560 -1008 560 -1056
WIRE 656 -1008 656 -1056
WIRE 656 -1008 560 -1008
WIRE -1200 -992 -1200 -1072
WIRE -1168 -992 -1200 -992
WIRE -672 -976 -672 -1040
WIRE -576 -976 -576 -1008
WIRE -576 -976 -672 -976
WIRE 176 -976 176 -992
WIRE 240 -976 240 -1104
WIRE 240 -976 176 -976
WIRE 656 -976 656 -1008
WIRE 176 -960 176 -976
WIRE 16 -928 16 -1040
WIRE 16 -928 -128 -928
WIRE -576 -912 -576 -976
WIRE -1104 -896 -1104 -944
WIRE -992 -896 -992 -1104
WIRE -992 -896 -1104 -896
WIRE -576 -896 -576 -912
WIRE -304 -880 -304 -928
WIRE -224 -880 -304 -880
WIRE -192 -880 -224 -880
WIRE 16 -880 16 -928
WIRE 320 -880 224 -880
WIRE -304 -848 -304 -880
WIRE -1104 -832 -1104 -896
WIRE 224 -832 224 -880
WIRE -576 -800 -576 -832
WIRE -128 -800 -128 -832
WIRE -80 -800 -128 -800
WIRE -48 -800 -48 -832
WIRE -48 -800 -80 -800
WIRE -32 -800 -48 -800
WIRE -304 -736 -304 -768
WIRE -128 -736 -128 -800
WIRE -96 -736 -128 -736
WIRE 16 -736 16 -784
WIRE 16 -736 -16 -736
WIRE -1104 -720 -1104 -752
WIRE 224 -720 224 -736
WIRE 320 -720 320 -880
WIRE 320 -720 224 -720
WIRE -304 -704 -304 -736
WIRE 16 -688 16 -736
WIRE 224 -688 224 -720
WIRE -400 -592 -400 -624
WIRE -1232 -576 -1248 -576
WIRE -1200 -576 -1232 -576
WIRE -1104 -576 -1120 -576
WIRE -1008 -576 -1024 -576
WIRE -720 -576 -736 -576
WIRE -640 -576 -720 -576
WIRE -528 -576 -560 -576
WIRE -496 -576 -528 -576
WIRE -432 -576 -496 -576
WIRE -336 -560 -368 -560
WIRE -304 -560 -304 -640
WIRE -304 -560 -336 -560
WIRE 16 -560 16 -608
WIRE 128 -560 16 -560
WIRE 464 -560 128 -560
WIRE -1248 -544 -1248 -576
WIRE -432 -544 -464 -544
WIRE 464 -544 464 -560
WIRE 16 -528 16 -560
WIRE -416 -512 -416 -528
WIRE -736 -496 -736 -576
WIRE -464 -496 -480 -496
WIRE -400 -496 -400 -528
WIRE -528 -480 -528 -576
WIRE -480 -464 -480 -496
WIRE -304 -464 -304 -560
WIRE -1248 -448 -1248 -480
WIRE 464 -448 464 -464
WIRE 256 -416 256 -432
WIRE 864 -416 736 -416
WIRE -736 -400 -736 -416
WIRE -96 -400 -128 -400
WIRE 16 -400 16 -448
WIRE 16 -400 -16 -400
WIRE -304 -384 -304 -400
WIRE 736 -384 736 -416
WIRE -480 -368 -480 -400
WIRE -304 -368 -304 -384
WIRE 16 -368 16 -400
WIRE 16 -352 16 -368
WIRE -128 -336 -128 -400
WIRE -64 -336 -128 -336
WIRE -48 -336 -64 -336
WIRE -32 -336 -48 -336
WIRE 256 -336 256 -352
WIRE 864 -320 864 -416
WIRE -128 -304 -128 -336
WIRE -48 -304 -48 -336
WIRE 688 -304 576 -304
WIRE 576 -288 576 -304
WIRE 736 -288 736 -304
WIRE -1104 -272 -1168 -272
WIRE -1088 -272 -1104 -272
WIRE 272 -272 240 -272
WIRE 464 -272 464 -368
WIRE 464 -272 272 -272
WIRE -304 -256 -304 -288
WIRE -240 -256 -304 -256
WIRE -192 -256 -240 -256
WIRE -1168 -240 -1168 -272
WIRE -304 -224 -304 -256
WIRE 736 -224 736 -288
WIRE 864 -224 864 -240
WIRE 16 -208 16 -256
WIRE 16 -208 -128 -208
WIRE 240 -208 240 -272
WIRE 240 -208 48 -208
WIRE -688 -176 -688 -208
WIRE 576 -176 576 -208
WIRE 16 -160 16 -208
WIRE 16 -160 0 -160
WIRE 96 -144 80 -144
WIRE 192 -144 160 -144
WIRE -1168 -128 -1168 -160
WIRE -576 -128 -576 -176
WIRE 48 -128 48 -208
WIRE 48 -128 -256 -128
WIRE -304 -96 -304 -144
WIRE -688 -80 -688 -96
WIRE -640 -80 -688 -80
WIRE -160 -80 -224 -80
WIRE -16 -80 -80 -80
WIRE 0 -80 -16 -80
WIRE 80 -80 80 -144
WIRE 96 -80 80 -80
WIRE 192 -80 160 -80
WIRE 240 -80 240 -208
WIRE 240 -80 192 -80
WIRE 736 -80 640 -80
WIRE 848 -80 736 -80
WIRE -688 -32 -688 -80
WIRE -64 -16 -64 -32
WIRE 240 -16 240 -80
WIRE -576 0 -576 -32
WIRE -576 0 -656 0
WIRE 736 16 736 -80
WIRE -576 32 -576 0
WIRE -16 32 -16 -80
WIRE -16 32 -32 32
WIRE 80 32 64 32
WIRE 192 32 192 -80
WIRE 192 32 144 32
WIRE 640 32 640 0
WIRE 688 32 640 32
WIRE -528 64 -528 -400
WIRE -256 64 -256 -128
WIRE -256 64 -528 64
WIRE -224 64 -224 -80
WIRE -176 64 -224 64
WIRE 848 64 848 -80
WIRE 64 96 64 32
WIRE 64 96 -32 96
WIRE 80 96 64 96
WIRE 240 96 240 64
WIRE 240 96 144 96
WIRE -688 128 -688 32
WIRE -624 128 -688 128
WIRE -576 128 -576 112
WIRE -576 128 -624 128
WIRE -112 144 -128 144
WIRE 240 144 240 96
WIRE -64 160 -64 144
WIRE 848 160 848 144
WIRE 736 192 736 112
FLAG 16 -1040 Vplus
FLAG 0 -160 Vmin
FLAG 128 -560 out_A
FLAG -64 -336 Gp1
FLAG 16 -368 Sp1
FLAG 16 -736 Sn1
FLAG -80 -800 Gn1
FLAG -496 -576 in
FLAG -688 -208 Vplus
FLAG -624 128 Vmin
FLAG 656 -976 0
FLAG 656 -1184 Vmin
FLAG 560 -1184 Vplus
FLAG -736 -400 0
FLAG 736 -224 0
FLAG 864 -224 0
FLAG 576 -176 0
FLAG 848 160 0
FLAG 736 192 0
FLAG -224 -880 b1
FLAG -240 -256 b2
FLAG -304 -736 d1
FLAG -304 -384 r4
FLAG -304 -16 0
FLAG -304 -1248 0
FLAG 240 144 0
FLAG -464 -544 0
FLAG -544 -1232 0
FLAG -576 -256 0
FLAG -1072 -1328 0
FLAG -1104 -720 0
FLAG -576 -800 0
FLAG -224 -1248 0
FLAG 528 -1552 Vcs
FLAG 528 -1376 0
FLAG -448 -1008 0
FLAG -480 -1088 b1
FLAG -400 -1008 0
FLAG -720 -576 stim
FLAG 512 -96 0
FLAG 416 -96 0
FLAG -1248 -448 0
FLAG -1232 -576 cl
FLAG 272 -272 shunt
FLAG -336 -560 opOut
FLAG -1168 -128 0
FLAG -1104 -272 gnd1
FLAG 176 -960 0
FLAG 224 -688 0
FLAG -944 -560 0
FLAG -928 -576 0
FLAG -400 -624 Vplus
FLAG -400 -496 Vmin
FLAG -416 -512 0
FLAG -784 -1440 0
FLAG -816 -1456 0
FLAG -816 -1488 0
FLAG 112 -1040 0
FLAG 160 -784 0
FLAG 256 -336 0
FLAG -480 -368 0
FLAG -480 -496 0
FLAG 256 -512 0
FLAG 192 -144 0
SYMBOL EIT_Semiconductors\\npn -192 -928 R0
SYMATTR InstName T1
SYMATTR Value FMMT624
SYMBOL EIT_Semiconductors\\pnp -192 -208 M180
SYMATTR InstName T2
SYMATTR Value FMMT723
SYMBOL res -112 -720 R270
WINDOW 0 25 56 VTop 2
WINDOW 3 7 56 VBottom 2
SYMATTR InstName R1
SYMATTR Value {bias}
SYMBOL res 0 -384 M270
WINDOW 0 25 56 VTop 2
WINDOW 3 7 56 VBottom 2
SYMATTR InstName R2
SYMATTR Value {bias}
SYMBOL res -320 -864 R0
SYMATTR InstName R3
SYMATTR Value {bias_b}
SYMBOL res -320 -384 R0
SYMATTR InstName R4
SYMATTR Value {bias_b}
SYMBOL diode -320 -704 R0
SYMATTR InstName D1
SYMATTR Value 1N4148
SYMBOL diode -320 -464 R0
SYMATTR InstName D2
SYMATTR Value 1N4148
SYMBOL res 448 -464 R0
SYMATTR InstName Rload1
SYMATTR Value 3.54
SYMBOL EIT_Semiconductors\\nmos -32 -880 R0
SYMATTR InstName M1
SYMATTR Value IRFP240
SYMBOL EIT_Semiconductors\\pmos -32 -256 M180
SYMATTR InstName M2
SYMATTR Value IRFP9240
SYMBOL ind 448 -560 R0
SYMATTR InstName L1
SYMATTR Value 170µ
SYMBOL TL431 -688 16 R180
SYMATTR InstName U3
SYMBOL res -672 -192 M0
SYMATTR InstName R10
SYMATTR Value 4.7k
SYMBOL EIT_Semiconductors\\npn -640 -128 R0
SYMATTR InstName Q1
SYMATTR Value BC547B
SYMBOL res -592 16 R0
SYMATTR InstName R11
SYMATTR Value 315
SYMBOL source-V 560 -1152 R0
WINDOW 123 0 0 Left 2
WINDOW 39 0 0 Left 2
WINDOW 3 -87 92 Left 2
SYMATTR Value {vsup}
SYMATTR InstName V1
SYMBOL source-V 656 -1152 R0
WINDOW 123 0 0 Left 2
WINDOW 39 0 0 Left 2
WINDOW 3 -72 98 Left 2
SYMATTR Value {-vsup}
SYMATTR InstName V2
SYMBOL source-V -736 -512 R0
WINDOW 123 -233 178 Left 2
WINDOW 39 0 0 Left 2
WINDOW 3 -233 150 Left 2
SYMATTR Value2 AC 1
SYMATTR Value SINE(0 10m 100)
SYMATTR InstName V3
SYMBOL res -320 -240 R0
SYMATTR InstName R12
SYMATTR Value 1m
SYMBOL res -320 -1024 R0
SYMATTR InstName R13
SYMATTR Value 1m
SYMBOL EIT_Semiconductors\\nmos 688 -384 R0
SYMATTR InstName M3
SYMATTR Value IRFP240
SYMBOL source-V 864 -336 R0
WINDOW 123 0 0 Left 2
WINDOW 39 0 0 Left 2
WINDOW 3 -18 167 Left 2
SYMATTR Value 10
SYMATTR InstName V5
SYMBOL source-V 576 -304 R0
WINDOW 123 0 0 Left 2
WINDOW 39 0 0 Left 2
WINDOW 3 -18 167 Left 2
SYMATTR Value 10
SYMATTR InstName V6
SYMBOL EIT_Semiconductors\\pmos 688 112 M180
SYMATTR InstName M4
SYMATTR Value IRFP9240
SYMBOL source-V 848 48 R0
WINDOW 123 0 0 Left 2
WINDOW 39 0 0 Left 2
WINDOW 3 -18 167 Left 2
SYMATTR Value 10
SYMATTR InstName V4
SYMBOL source-V 640 16 R180
WINDOW 123 0 0 Left 2
WINDOW 39 0 0 Left 2
WINDOW 3 -18 167 Left 2
SYMATTR Value 10
SYMATTR InstName V7
SYMBOL source-I -304 -1168 R180
WINDOW 0 29 73 Left 2
WINDOW 3 29 17 Left 2
WINDOW 123 0 0 Left 2
WINDOW 39 0 0 Left 2
SYMATTR InstName I1
SYMATTR Value {IK1}
SYMBOL source-I -304 -16 R180
WINDOW 0 29 73 Left 2
WINDOW 3 29 17 Left 2
WINDOW 123 0 0 Left 2
WINDOW 39 0 0 Left 2
SYMATTR InstName I2
SYMATTR Value {Ik1}
SYMBOL res 224 -32 R0
SYMATTR InstName R5
SYMATTR Value 0.075
SYMBOL res -544 -592 R90
WINDOW 0 7 56 VBottom 2
WINDOW 3 25 56 VTop 2
SYMATTR InstName R6
SYMATTR Value {srV}
SYMBOL res 0 -704 R0
SYMATTR InstName R8
SYMATTR Value {Rs}
SYMBOL res 0 -544 R0
SYMATTR InstName R9
SYMATTR Value {Rs}
SYMBOL LM334 -672 -1120 R0
SYMATTR InstName U2
SYMBOL res -592 -1104 R0
SYMATTR InstName R14
SYMATTR Value 25
SYMBOL LM334 -1200 -1216 R0
SYMATTR InstName U4
SYMBOL res -1120 -1200 R0
SYMATTR InstName R20
SYMATTR Value 166
SYMBOL res -1008 -1200 R0
SYMATTR InstName R21
SYMATTR Value {6.8*166}
SYMBOL EIT_Semiconductors\\npn -1168 -1040 R0
SYMATTR InstName Q3
SYMATTR Value BC547B
SYMBOL res -1120 -848 R0
SYMATTR InstName R17
SYMATTR Value 100
SYMBOL res -592 -272 R0
SYMATTR InstName R16
SYMATTR Value 100
SYMBOL res -240 -1248 R0
SYMATTR InstName R18
SYMATTR Value 100t
SYMBOL res -592 -928 R0
SYMATTR InstName R15
SYMATTR Value 100
SYMBOL source-V 528 -1520 R0
WINDOW 123 0 0 Left 2
WINDOW 39 0 0 Left 2
WINDOW 3 -87 92 Left 2
SYMATTR Value 30
SYMATTR InstName V8
SYMBOL sw -400 -1008 M180
WINDOW 3 -72 121 Left 2
SYMATTR Value Osw
SYMATTR InstName S1
SYMBOL res -512 -384 R180
WINDOW 0 36 76 Left 2
WINDOW 3 36 40 Left 2
SYMATTR InstName R19
SYMATTR Value 40k
SYMBOL delay 464 -96 R180
SYMATTR Value Td=25p
SYMATTR InstName U6
SYMBOL res -1008 -592 R90
WINDOW 0 7 56 VBottom 2
WINDOW 3 25 56 VTop 2
SYMATTR InstName Rload3
SYMATTR Value {RL}
SYMBOL ind -912 -592 R90
WINDOW 0 6 56 VBottom 2
WINDOW 3 30 56 VTop 2
SYMATTR InstName L3
SYMATTR Value {LL}
SYMBOL cap -1264 -544 R0
SYMATTR InstName C3
SYMATTR Value {CL}
SYMBOL res -1104 -592 R90
WINDOW 0 7 56 VBottom 2
WINDOW 3 25 56 VTop 2
SYMATTR InstName R22
SYMATTR Value 10
SYMBOL source-V -1168 -256 R0
WINDOW 123 0 0 Left 2
WINDOW 39 0 0 Left 2
SYMATTR InstName V9
SYMATTR Value 1µ
SYMBOL MJ11016G 112 -1088 R0
SYMATTR InstName U7
SYMBOL MJ11015G 160 -736 M180
SYMATTR InstName U5
SYMBOL MDB_sym\\LTC6090m -784 -1536 R0
SYMATTR InstName U9
SYMBOL EIT_Semiconductors\\op_3 -400 -560 R0
WINDOW 123 -242 -98 Left 2
WINDOW 3 -361 -125 Left 2
SYMATTR Value2 FT={FT} SR=10
SYMATTR Value Vp={0.95*Vsup} Vm={-0.95*Vsup} Ilim=20m
SYMATTR InstName U1
SYMBOL Opamps\\LTC2050HV -64 64 M0
SYMATTR InstName U8
SYMBOL source-Vmarker -64 -32 R0
SYMATTR InstName U10
SYMBOL source-Vmarker -64 160 R0
SYMATTR Value V=-5V
SYMATTR InstName U11
SYMBOL source-Vmarker -128 144 R0
SYMATTR InstName U12
SYMBOL res 96 -96 R90
WINDOW 0 7 56 VBottom 2
WINDOW 3 25 56 VTop 2
SYMATTR InstName R7
SYMATTR Value 27
SYMBOL res -176 -64 R270
WINDOW 0 25 56 VTop 2
WINDOW 3 7 56 VBottom 2
SYMATTR InstName R23
SYMATTR Value {27*1}
SYMBOL cap -496 -464 R0
SYMATTR InstName C1
SYMATTR Value {1/(2*pi*40k*Rcp)}
SYMBOL res 240 -528 R0
SYMATTR InstName R24
SYMATTR Value 1
SYMBOL cap 240 -416 R0
SYMATTR InstName C2
SYMATTR Value {1/(2*pi*60k*1)}
SYMBOL MDB_sym\\jumperNC 128 -208 R0
WINDOW 0 0 40 Invisible 2
SYMATTR InstName U13
SYMATTR SpiceLine CLOSED={fb}
SYMBOL MDB_sym\\jumperNO 128 -144 R0
WINDOW 0 0 29 Invisible 2
SYMATTR InstName U14
SYMATTR SpiceLine OPEN={fb}
SYMBOL MDB_sym\\jumperNC 112 -32 R0
WINDOW 0 0 40 Invisible 2
SYMATTR InstName U15
SYMATTR SpiceLine CLOSED={fb}
SYMBOL MDB_sym\\jumperNO 112 32 R0
WINDOW 0 0 29 Invisible 2
SYMATTR InstName U16
SYMATTR SpiceLine OPEN={fb}
TEXT 512 -792 Left 2 ;.step param bias list 200 1k 2.4k
TEXT -672 -1536 Left 2 !.model npnx npn (Bf=200 Is={10m/exp(0.7/26m)}\n.model pnpx pnp (Bf=200 Is={10m/exp(0.7/26m)}\n.model Dx D (Is={(20*50u)/exp(0.7/26m)}\n.model Osw SW(Ron=10u Roff=10meg Vt=12 Vh=-.2)
TEXT 520 -888 Left 2 ;.ac oct 100 1k 100meg
TEXT 520 -856 Left 2 ;.step param Ik1 1m 1.05m 5u
TEXT -840 -328 Left 2 ;PULSE(-.5 .5 0 1m 1m 10m 23m)
TEXT -640 -720 Left 2 ;Vp=25 Vm=-25 Ilim=20m
TEXT 24 -1616 Left 2 !.param Ik1 = 3m\n;.param bias = 100\n.param bias = 150\n;.param bias_b = 270\n.param bias_b = 250\n.param Rs = 0.015\n.param vsup = 30\n.param poti = 10k\n.param set = 0.5\n.param Rll = 5k\n.param FT = 10meg
TEXT 528 -824 Left 2 ;.temp 27 90
TEXT 512 -752 Left 2 ;.step param Rset 10 30 0.1
TEXT 520 -656 Left 2 ;.step param Rll 10 10k 200
TEXT -680 280 Left 2 ;.step param FT 10meg 50meg 10meg
TEXT 528 -1328 Left 2 !;dc V3 -2 2 0.001
TEXT 104 360 Left 2 ;.step param set 0.1 1 0.2
TEXT -1144 -480 Left 2 !.param LL=2.89m\n.param RL=1.535\n.param CL=470n
TEXT -848 -1744 Left 2 !.model D45H11 PNP(IS=7.89979e-11 BF=65.9745 NF=0.851012 VAF=10.7084 IKF=10 Ise=4.79702e-14 Ne=4 BR=1.96197\n.model D45H11npn NPN(IS=7.89979e-11 BF=65.9745 NF=0.851012 VAF=10.7084 IKF=10 Ise=4.79702e-14 Ne=4 BR=1.96197
TEXT -616 -1368 Left 2 !.ac oct 100 10 1meg
TEXT -616 -1336 Left 2 ;.tran 30m
TEXT -736 -624 Left 2 ;.step param srV list 100 20k
TEXT -688 -528 Left 2 !.param srV=1k
TEXT -600 168 Left 2 ;.step param Rcp 3k 1k 250
TEXT -520 -312 Left 2 !.param Rcp=10k
TEXT -16 168 Left 2 !.param fb=0 ;non-inverting if 1
TEXT -32 216 Left 2 ;.step param fb list 0 1
RECTANGLE Normal -848 -1304 352 192 2
