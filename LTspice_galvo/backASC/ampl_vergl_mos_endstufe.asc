Version 4
SHEET 1 3332 3080
WIRE -1360 -512 -1360 -560
WIRE -1264 -512 -1264 -560
WIRE 1024 -432 1024 -448
WIRE -1360 -416 -1360 -432
WIRE -1312 -416 -1360 -416
WIRE -1264 -416 -1264 -432
WIRE -1264 -416 -1312 -416
WIRE 976 -416 928 -416
WIRE 1280 -416 1280 -432
WIRE -1312 -384 -1312 -416
WIRE -880 -336 -880 -416
WIRE -384 -336 -480 -336
WIRE -256 -336 -384 -336
WIRE 208 -336 -256 -336
WIRE 928 -320 928 -416
WIRE 1024 -320 1024 -336
WIRE 1024 -320 928 -320
WIRE 1280 -320 1280 -336
WIRE 1280 -320 1200 -320
WIRE 1024 -304 1024 -320
WIRE -480 -288 -480 -336
WIRE -256 -288 -256 -336
WIRE -1552 -272 -1872 -272
WIRE -784 -256 -816 -256
WIRE -720 -256 -784 -256
WIRE 1200 -240 1200 -320
WIRE 1232 -240 1200 -240
WIRE -1872 -224 -1872 -272
WIRE -784 -224 -784 -256
WIRE 1024 -208 1024 -224
WIRE 1280 -208 1280 -224
WIRE 208 -176 208 -336
WIRE -1552 -160 -1552 -272
WIRE -1552 -160 -1696 -160
WIRE -480 -160 -480 -208
WIRE -48 -160 -480 -160
WIRE 128 -160 32 -160
WIRE 160 -160 128 -160
WIRE -720 -144 -720 -256
WIRE -880 -128 -880 -176
WIRE -784 -128 -784 -144
WIRE -784 -128 -880 -128
WIRE -1872 -112 -1872 -144
WIRE -1760 -112 -1872 -112
WIRE -1552 -112 -1552 -160
WIRE -880 -112 -880 -128
WIRE -480 -112 -480 -160
WIRE -256 -112 -256 -208
WIRE -544 -64 -592 -64
WIRE -144 -64 -192 -64
WIRE -1872 -48 -1872 -112
WIRE -1696 -32 -1696 -64
WIRE -1648 -32 -1696 -32
WIRE -1600 -32 -1648 -32
WIRE -880 -16 -880 -48
WIRE -720 -16 -720 -64
WIRE -720 -16 -880 -16
WIRE -480 0 -480 -16
WIRE -256 0 -256 -16
WIRE -880 16 -880 -16
WIRE -1696 32 -1696 -32
WIRE -1664 32 -1696 32
WIRE -1552 32 -1552 -16
WIRE -1552 32 -1584 32
WIRE -1872 64 -1872 32
WIRE -1552 64 -1552 32
WIRE 208 80 208 -80
WIRE 304 80 208 80
WIRE -480 128 -480 80
WIRE -400 128 -480 128
WIRE -256 128 -256 80
WIRE -256 128 -400 128
WIRE 0 128 -48 128
WIRE 112 128 64 128
WIRE 304 128 304 80
WIRE -2144 192 -2192 192
WIRE -2080 192 -2144 192
WIRE -400 192 -400 128
WIRE -1872 208 -1872 128
WIRE -1872 208 -2016 208
WIRE -1552 208 -1552 144
WIRE -1440 208 -1552 208
WIRE -1360 208 -1440 208
WIRE -880 208 -912 208
WIRE -832 208 -880 208
WIRE -720 208 -752 208
WIRE -688 208 -720 208
WIRE -592 208 -592 -64
WIRE -592 208 -608 208
WIRE -144 208 -144 -64
WIRE -48 208 -48 128
WIRE -48 208 -144 208
WIRE -16 208 -48 208
WIRE 112 208 112 128
WIRE 112 208 64 208
WIRE -2080 224 -2112 224
WIRE -912 224 -912 208
WIRE -720 224 -720 208
WIRE -1360 240 -1360 208
WIRE -48 240 -48 208
WIRE 304 240 304 208
WIRE -1552 256 -1552 208
WIRE -336 272 -336 224
WIRE -336 272 -480 272
WIRE -256 272 -336 272
WIRE -1872 304 -1872 208
WIRE -480 304 -480 272
WIRE -256 304 -256 272
WIRE -912 336 -912 304
WIRE -720 336 -720 304
WIRE -1360 352 -1360 320
WIRE -1360 352 -1488 352
WIRE -48 352 -48 320
WIRE 112 352 112 208
WIRE 304 352 304 320
WIRE 304 352 112 352
WIRE -1664 368 -1696 368
WIRE -1552 368 -1552 336
WIRE -1552 368 -1584 368
WIRE -1360 368 -1360 352
WIRE 304 368 304 352
WIRE -1872 400 -1872 368
WIRE -1552 400 -1552 368
WIRE -1552 416 -1552 400
WIRE -480 416 -480 384
WIRE -256 416 -256 384
WIRE -1696 432 -1696 368
WIRE -1632 432 -1696 432
WIRE -1600 432 -1632 432
WIRE -1696 464 -1696 432
WIRE -592 464 -592 208
WIRE -544 464 -592 464
WIRE -144 464 -144 208
WIRE -144 464 -192 464
WIRE 208 480 208 80
WIRE 304 480 304 448
WIRE -1360 496 -1360 448
WIRE -848 496 -848 464
WIRE -1872 512 -1872 480
WIRE -1760 512 -1872 512
WIRE -736 544 -736 496
WIRE -1872 560 -1872 512
WIRE -1552 560 -1552 512
WIRE -1552 560 -1696 560
WIRE -480 560 -480 512
WIRE -48 560 -480 560
WIRE 128 560 32 560
WIRE 160 560 128 560
WIRE -848 592 -848 576
WIRE -800 592 -848 592
WIRE -256 592 -256 512
WIRE -480 608 -480 560
WIRE -848 640 -848 592
WIRE -1488 656 -1488 352
WIRE -1360 656 -1488 656
WIRE -736 672 -736 640
WIRE -736 672 -816 672
WIRE -1872 688 -1872 640
WIRE -1568 688 -1872 688
WIRE -1552 688 -1552 560
WIRE -1552 688 -1568 688
WIRE -1488 688 -1488 656
WIRE -1360 704 -1360 656
WIRE -736 704 -736 672
WIRE -480 720 -480 688
WIRE -384 720 -480 720
WIRE -256 720 -256 672
WIRE -256 720 -384 720
WIRE 208 720 208 576
WIRE 208 720 -256 720
WIRE -2112 800 -2112 224
WIRE -1488 800 -1488 768
WIRE -1488 800 -2112 800
WIRE -1360 800 -1360 768
WIRE -1360 800 -1488 800
WIRE -848 800 -848 704
WIRE -784 800 -848 800
WIRE -736 800 -736 784
WIRE -736 800 -784 800
WIRE -1488 816 -1488 800
WIRE -1488 912 -1488 896
WIRE 48 1184 48 1152
WIRE 160 1232 160 1152
WIRE 48 1280 48 1264
WIRE 96 1280 48 1280
WIRE 48 1328 48 1280
WIRE 112 1360 80 1360
WIRE -1328 1376 -1328 1296
WIRE -864 1376 -880 1376
WIRE -800 1376 -864 1376
WIRE -672 1376 -720 1376
WIRE -512 1376 -672 1376
WIRE -432 1392 -448 1392
WIRE -400 1392 -432 1392
WIRE -304 1392 -400 1392
WIRE -256 1392 -304 1392
WIRE -512 1408 -576 1408
WIRE 112 1408 112 1360
WIRE -256 1424 -256 1392
WIRE -672 1440 -672 1376
WIRE -1232 1456 -1264 1456
WIRE -400 1456 -400 1392
WIRE -1232 1488 -1232 1456
WIRE 112 1504 112 1488
WIRE 160 1504 160 1328
WIRE 160 1504 112 1504
WIRE -672 1552 -672 1520
WIRE -576 1552 -576 1408
WIRE -576 1552 -608 1552
WIRE -528 1552 -576 1552
WIRE -432 1552 -432 1392
WIRE -432 1552 -464 1552
WIRE -400 1552 -400 1536
WIRE -256 1552 -256 1504
WIRE -1328 1584 -1328 1536
WIRE -1232 1584 -1232 1568
WIRE -1232 1584 -1328 1584
WIRE -576 1600 -576 1552
WIRE 48 1600 48 1392
WIRE 112 1600 48 1600
WIRE 160 1600 160 1584
WIRE 160 1600 112 1600
WIRE -400 1648 -400 1616
WIRE -1328 1664 -1328 1584
WIRE -576 1696 -576 1680
WIRE -256 1696 -256 1632
WIRE -256 1696 -576 1696
WIRE -256 1808 -256 1776
WIRE -1328 1824 -1328 1744
FLAG -912 336 0
FLAG -1312 -384 0
FLAG -1264 -560 Vmin
FLAG -1360 -560 Vplus
FLAG -384 720 Vmin
FLAG -880 208 in
FLAG -384 -336 Vplus
FLAG 1280 -208 0
FLAG 1280 -432 0
FLAG 928 -416 Gpref
FLAG 1200 -320 Gnref
FLAG 128 -160 Gp
FLAG 128 560 Gn
FLAG -48 352 0
FLAG 1024 -448 0
FLAG 1024 -208 0
FLAG 304 80 out_B
FLAG -1552 -272 Vplus
FLAG -1568 688 Vmin
FLAG -1440 208 out_A
FLAG -1360 496 0
FLAG -1632 432 Gp1
FLAG -1552 400 Sp1
FLAG -1552 32 Sn1
FLAG -1648 -32 Gn1
FLAG 304 480 0
FLAG -848 464 Vplus
FLAG -736 496 Isink1
FLAG -784 800 Vmin
FLAG -880 -416 Vplus
FLAG -720 336 0
FLAG -336 272 LM334
FLAG -400 128 Isink1
FLAG -880 16 LM334
FLAG -2144 192 in
FLAG -1488 912 0
FLAG -416 2192 0
FLAG -256 1808 0
FLAG -400 1648 0
FLAG -864 1376 in
FLAG -304 1392 outLM
FLAG -1328 1296 Vplus
FLAG -1328 1824 0
FLAG 48 1152 Vplus
FLAG 112 1600 Vmin
FLAG 160 1072 0
SYMBOL res -736 192 R90
WINDOW 0 7 56 VBottom 0
WINDOW 3 30 69 VTop 0
SYMATTR InstName R1
SYMATTR Value 50
SYMBOL EIT_Semiconductors\\npn -544 -112 R0
SYMATTR InstName Q1
SYMATTR Value BC547B
SYMBOL res -496 -16 R0
SYMATTR InstName R2
SYMATTR Value 22.1
SYMBOL res -272 -16 R0
SYMATTR InstName R3
SYMATTR Value 22.1
SYMBOL res -496 288 R0
SYMATTR InstName R4
SYMATTR Value 22.1
SYMBOL res -272 288 R0
SYMATTR InstName R5
SYMATTR Value 22.1
SYMBOL EIT_Semiconductors\\pnp -544 512 M180
SYMATTR InstName Q2
SYMATTR Value BC560C
SYMBOL EIT_Semiconductors\\pnp -192 512 R180
SYMATTR InstName Q3
SYMATTR Value BC560C
SYMBOL res -496 -304 R0
SYMATTR InstName R8
SYMATTR Value 2k
SYMBOL res -272 -304 R0
SYMATTR InstName R9
SYMATTR Value 2k
SYMBOL res -496 592 R0
SYMATTR InstName R10
SYMATTR Value 2k
SYMBOL res -272 576 R0
SYMATTR InstName R11
SYMATTR Value 2k
SYMBOL source-V -912 208 R0
WINDOW 123 -85 25 Left 0
WINDOW 39 0 0 Left 0
WINDOW 3 -85 -42 Left 0
SYMATTR Value2 AC 1
SYMATTR Value SINE(0 1 {fsin} {1/(10*fsin)})
SYMATTR InstName V1
SYMBOL source-V -1360 -528 R0
WINDOW 123 0 0 Left 0
WINDOW 39 0 0 Left 0
SYMATTR InstName V2
SYMATTR Value {vsup}
SYMBOL source-V -1264 -528 R0
WINDOW 123 0 0 Left 0
WINDOW 39 0 0 Left 0
SYMATTR InstName V3
SYMATTR Value {-vsup+1}
SYMBOL EIT_Semiconductors\\npn -192 -112 M0
SYMATTR InstName Q6
SYMATTR Value BC547B
SYMBOL EIT_Semiconductors\\nmos 160 480 R0
SYMATTR InstName M1
SYMATTR Value IRFP240
SYMBOL EIT_Semiconductors\\pmos 160 -80 M180
SYMATTR InstName M2
SYMATTR Value IRFP9240
SYMBOL source-I 1280 -336 R180
WINDOW 0 29 73 Left 0
WINDOW 3 29 17 Left 0
WINDOW 123 0 0 Left 0
WINDOW 39 0 0 Left 0
SYMATTR InstName I5
SYMATTR Value 10m
SYMBOL res 48 544 R90
WINDOW 0 7 56 VBottom 0
WINDOW 3 25 56 VTop 0
SYMATTR InstName R18
SYMATTR Value 10
SYMBOL res 48 -176 R90
WINDOW 0 7 56 VBottom 0
WINDOW 3 25 56 VTop 0
SYMATTR InstName R19
SYMATTR Value 10
SYMBOL res 288 224 R0
SYMATTR InstName Rload
SYMATTR Value 2
SYMBOL res 80 192 R90
WINDOW 0 7 56 VBottom 0
WINDOW 3 25 56 VTop 0
SYMATTR InstName R20
SYMATTR Value 1k
SYMBOL EIT_Semiconductors\\nmos 1232 -320 R0
SYMATTR InstName M4
SYMATTR Value IRFP240
SYMBOL EIT_Semiconductors\\pmos 976 -336 M180
SYMATTR InstName M5
SYMATTR Value IRFP9240
SYMBOL source-I 1024 -224 R180
WINDOW 0 29 73 Left 0
WINDOW 3 29 17 Left 0
WINDOW 123 0 0 Left 0
WINDOW 39 0 0 Left 0
SYMATTR InstName I7
SYMATTR Value 10m
SYMBOL EIT_Semiconductors\\npn -1760 -160 R0
SYMATTR InstName T1
SYMATTR Value npnx
SYMBOL EIT_Semiconductors\\pnp -1760 560 M180
SYMATTR InstName T2
SYMATTR Value pnpx
SYMBOL res -1680 48 R270
WINDOW 0 25 56 VTop 0
WINDOW 3 7 56 VBottom 0
SYMATTR InstName R12
SYMATTR Value 100
SYMBOL res -1568 384 M270
WINDOW 0 25 56 VTop 0
WINDOW 3 7 56 VBottom 0
SYMATTR InstName R13
SYMATTR Value 100
SYMBOL res -1888 -64 R0
SYMATTR InstName R14
SYMATTR Value 1k
SYMBOL res -1888 384 R0
SYMATTR InstName R15
SYMATTR Value 1k
SYMBOL diode -1888 64 R0
SYMATTR InstName D1
SYMATTR Value Dx
SYMBOL diode -1888 304 R0
SYMATTR InstName D2
SYMATTR Value Dx
SYMBOL res -1376 352 R0
SYMATTR InstName Rload1
SYMATTR Value 2
SYMBOL res -1568 48 R0
SYMATTR InstName R16
SYMATTR Value 1µ
SYMBOL res -1568 240 R0
SYMATTR InstName R17
SYMATTR Value 1µ
SYMBOL source-I -1872 640 R180
WINDOW 0 29 73 Left 0
WINDOW 3 29 17 Left 0
WINDOW 123 0 0 Left 0
WINDOW 39 0 0 Left 0
SYMATTR InstName I3
SYMATTR Value 4.25m
SYMBOL source-I -1872 -144 R180
WINDOW 0 29 73 Left 0
WINDOW 3 29 17 Left 0
WINDOW 123 0 0 Left 0
WINDOW 39 0 0 Left 0
SYMATTR InstName I4
SYMATTR Value 4.27m
SYMBOL EIT_Semiconductors\\nmos -1600 -112 R0
SYMATTR InstName M3
SYMATTR Value IRFP240
SYMBOL EIT_Semiconductors\\pmos -1600 512 M180
SYMATTR InstName M6
SYMATTR Value IRFP9240
SYMBOL TL431 -848 688 R180
SYMATTR InstName U1
SYMBOL res -832 480 M0
SYMATTR InstName R26
SYMATTR Value 4.7k
SYMBOL EIT_Semiconductors\\npn -800 544 R0
SYMATTR InstName Q9
SYMATTR Value BC550C
SYMBOL res -752 688 R0
SYMATTR InstName R28
SYMATTR Value 613
SYMBOL LM334 -880 -256 R0
SYMATTR InstName U2
SYMBOL res -800 -240 R0
SYMATTR InstName R31
SYMATTR Value 45.3
SYMBOL diode -896 -112 R0
SYMATTR InstName D3
SYMATTR Value 1N914
SYMBOL res -736 -160 R0
SYMATTR InstName R32
SYMATTR Value 284
SYMBOL res -592 192 R90
WINDOW 0 7 56 VBottom 0
WINDOW 3 30 69 VTop 0
SYMATTR InstName R22
SYMATTR Value 50
SYMBOL cap 64 112 R90
WINDOW 0 0 32 VBottom 0
WINDOW 3 32 32 VTop 0
SYMATTR InstName C1
SYMATTR Value 100p
SYMBOL res -736 208 R0
SYMATTR InstName R6
SYMATTR Value 10T
SYMBOL EIT_Semiconductors\\op_3 -2048 208 M180
WINDOW 123 -111 102 Left 0
WINDOW 3 -115 76 Left 0
SYMATTR Value Vp=25 Vm=-25 Ilim=20m
SYMATTR InstName U3
SYMBOL res -1504 672 R0
SYMATTR InstName R7
SYMATTR Value 6k
SYMBOL res -1504 800 R0
SYMATTR InstName R23
SYMATTR Value 2k
SYMBOL cap -1376 704 R0
SYMATTR InstName C2
SYMATTR Value 220p
SYMBOL ind 288 112 R0
SYMATTR InstName L1
SYMATTR Value 100µ
SYMBOL EIT_Semiconductors\\op_3 -480 1392 M180
SYMATTR InstName U4
SYMATTR Value2 FT=5.5Meg SR=8
SYMATTR Value Vp=25 Vm=-25 Ilim=3
SYMBOL res -416 1440 R0
SYMATTR InstName R24
SYMATTR Value 1
SYMBOL res -272 1536 R0
SYMATTR InstName R25
SYMATTR Value 2
SYMBOL ind -272 1408 R0
SYMATTR InstName L2
SYMATTR Value 100µ
SYMBOL res -272 1680 R0
SYMATTR InstName R27
SYMATTR Value 0.1
SYMBOL res -704 1360 R90
WINDOW 0 7 56 VBottom 0
WINDOW 3 25 56 VTop 0
SYMATTR InstName R29
SYMATTR Value 1k
SYMBOL res -656 1536 R180
WINDOW 0 36 76 Left 0
WINDOW 3 36 40 Left 0
SYMATTR InstName R30
SYMATTR Value 150
SYMBOL res -560 1696 R180
WINDOW 0 36 76 Left 0
WINDOW 3 36 40 Left 0
SYMATTR InstName R33
SYMATTR Value 1k
SYMBOL cap -608 1536 R90
WINDOW 0 0 32 VBottom 0
WINDOW 3 32 32 VTop 0
SYMATTR InstName C3
SYMATTR Value 2.2n
SYMBOL cap -464 1536 R90
WINDOW 0 0 32 VBottom 0
WINDOW 3 32 32 VTop 0
SYMATTR InstName C4
SYMATTR Value 100p
SYMBOL cap -384 1616 R180
WINDOW 0 24 64 Left 0
WINDOW 3 24 8 Left 0
SYMATTR InstName C5
SYMATTR Value 220n
SYMBOL ind -1376 224 R0
SYMATTR InstName L3
SYMATTR Value 100µ
SYMBOL res 288 352 R0
SYMATTR InstName Rload2
SYMATTR Value 0.1
SYMBOL LM334 -1328 1456 R0
SYMATTR InstName U5
SYMBOL res -1248 1472 R0
SYMATTR InstName R21
SYMATTR Value 17.2
SYMBOL res -1344 1648 R0
SYMATTR InstName R34
SYMATTR Value 2k
SYMBOL TL431 48 1376 R180
SYMATTR InstName U6
SYMBOL res 64 1168 M0
SYMATTR InstName R35
SYMATTR Value 4.7k
SYMBOL EIT_Semiconductors\\npn 96 1232 R0
SYMATTR InstName Q4
SYMATTR Value BC550C
SYMBOL res 144 1488 R0
SYMATTR InstName R36
SYMATTR Value 300
SYMBOL res 144 1056 R0
SYMATTR InstName R37
SYMATTR Value 2k
SYMBOL source-V 112 1392 M0
WINDOW 0 28 81 Left 0
WINDOW 3 28 28 Left 0
WINDOW 123 0 0 Left 0
WINDOW 39 0 0 Left 0
SYMATTR InstName V4
SYMATTR Value 1.25
TEXT -1360 -184 Left 0 !.param ksq=4.1m
TEXT -1360 -120 Left 0 ;.temp 27 77
TEXT -2032 -440 Left 0 !.model npnx npn (Bf=200 Is={10m/exp(0.7/26m)}\n.model pnpx pnp (Bf=200 Is={10m/exp(0.7/26m)}\n.model Dx D (Is={(20*50u)/exp(0.7/26m)}
TEXT -1360 -208 Left 0 !.param fsin=50k
TEXT -1360 -152 Left 0 !;tran  {4/fsin}
TEXT -800 -384 Left 0 ;tempco of 1N914 measured:\n-1.66702mV/K
TEXT -104 40 Left 0 ;Feedback
TEXT -8 328 Left 0 ;A0=1+R20/R21
TEXT -1744 888 Left 0 !.param R23=2k
TEXT -64 416 Left 0 !.param R21=100
TEXT -1056 -640 Left 0 !.dc v1 -1 1 0.01
TEXT -1216 1136 Left 0 ;I_out=(V_R/R_set)*(n/(n-1))\nR_set=(n*V_R)/(I_out*(n-1)\nV_R=214uV/K*300k
TEXT -1176 -584 Left 0 !.param vsup=25
TEXT -1184 -560 Left 0 !.step param vsup  list 25 12
RECTANGLE Normal 160 456 -96 64 2
RECTANGLE Normal 416 960 -1104 -528 2
RECTANGLE Normal -2256 -352 -1168 960 2
