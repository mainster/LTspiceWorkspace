Version 4
SHEET 1 3748 3492
WIRE 1824 1136 1824 1120
WIRE 1920 1136 1920 1120
WIRE 1824 1232 1824 1216
WIRE 1920 1232 1920 1216
WIRE 2112 1344 1152 1344
WIRE 2112 1408 2112 1344
WIRE 2160 1408 2112 1408
WIRE 2192 1408 2160 1408
WIRE 2320 1408 2272 1408
WIRE 2352 1408 2320 1408
WIRE 2464 1408 2432 1408
WIRE 1152 1440 1152 1424
WIRE 1504 1440 1488 1440
WIRE 1600 1440 1584 1440
WIRE 1632 1440 1600 1440
WIRE 1728 1440 1712 1440
WIRE 2384 1488 2384 1472
WIRE 1456 1504 1344 1504
WIRE 2320 1504 2320 1408
WIRE 2352 1504 2320 1504
WIRE 2464 1520 2464 1408
WIRE 2464 1520 2416 1520
WIRE 2544 1520 2464 1520
WIRE 2656 1520 2544 1520
WIRE 2880 1520 2736 1520
WIRE 2160 1536 2112 1536
WIRE 2192 1536 2160 1536
WIRE 2320 1536 2272 1536
WIRE 2352 1536 2320 1536
WIRE 2880 1536 2880 1520
WIRE 2736 1552 2736 1520
WIRE 1344 1568 1344 1504
WIRE 1376 1568 1344 1568
WIRE 1904 1568 1904 1552
WIRE 2320 1568 2320 1536
WIRE 2384 1568 2384 1552
WIRE 2656 1568 2656 1520
WIRE 1456 1584 1456 1504
WIRE 1456 1584 1440 1584
WIRE 1568 1584 1456 1584
WIRE 1632 1584 1568 1584
WIRE 1728 1584 1728 1440
WIRE 1728 1584 1712 1584
WIRE 1872 1584 1728 1584
WIRE 1376 1600 1152 1600
WIRE 1968 1600 1936 1600
WIRE 2112 1600 2112 1536
WIRE 2112 1600 1968 1600
WIRE 1872 1616 1840 1616
WIRE 1968 1616 1968 1600
WIRE 1152 1632 1152 1600
WIRE 1728 1632 1728 1584
WIRE 2880 1632 2880 1616
WIRE 1904 1648 1904 1632
WIRE 2320 1664 2320 1648
WIRE 2656 1664 2656 1616
WIRE 2736 1664 2736 1632
WIRE 1312 1680 1312 1664
WIRE 1488 1680 1360 1680
WIRE 1840 1712 1840 1616
WIRE 1968 1712 1968 1696
WIRE 1968 1712 1840 1712
WIRE 1152 1728 1152 1712
WIRE 1728 1728 1728 1712
WIRE 1968 1728 1968 1712
WIRE 2880 1728 2880 1712
WIRE 2880 1728 2736 1728
WIRE 1360 1744 1360 1680
WIRE 1408 1744 1360 1744
WIRE 1488 1760 1488 1680
WIRE 1488 1760 1472 1760
WIRE 1568 1760 1488 1760
WIRE 2736 1760 2736 1728
WIRE 1408 1776 1360 1776
WIRE 1312 1792 1312 1760
WIRE 1360 1872 1360 1776
WIRE 1360 1872 1312 1872
WIRE 1376 1872 1360 1872
WIRE 1472 1872 1456 1872
WIRE 2144 1968 2064 1968
WIRE 2256 1968 2224 1968
WIRE 2272 1968 2256 1968
WIRE 2288 1968 2272 1968
WIRE 2400 1968 2368 1968
WIRE 2160 2080 2064 2080
WIRE 2272 2080 2272 1968
WIRE 2272 2080 2240 2080
WIRE 2272 2128 2272 2080
WIRE 1520 2208 1472 2208
WIRE 1584 2208 1520 2208
WIRE 1696 2208 1664 2208
WIRE 1744 2208 1696 2208
WIRE 1856 2208 1824 2208
WIRE 1472 2240 1472 2208
WIRE 1696 2240 1696 2208
WIRE 1856 2240 1856 2208
WIRE 1472 2352 1472 2320
WIRE 1696 2352 1696 2304
WIRE 1856 2352 1856 2304
WIRE 1472 2368 1472 2352
WIRE 1216 2496 1008 2496
WIRE 1264 2496 1216 2496
WIRE 1008 2528 1008 2496
WIRE 1216 2544 1104 2544
WIRE 1424 2544 1216 2544
WIRE 1104 2576 1104 2544
WIRE 1008 2624 1008 2608
WIRE 1104 2672 1104 2656
WIRE 1424 2864 1424 2544
WIRE 1232 2896 1008 2896
WIRE 1232 2976 1232 2896
WIRE 1296 2976 1232 2976
WIRE 1424 2976 1424 2944
WIRE 1424 2976 1376 2976
WIRE 1456 2976 1424 2976
WIRE 1008 2992 1008 2896
WIRE 1232 2992 1232 2976
WIRE 1568 2992 1520 2992
WIRE 1456 3008 1424 3008
WIRE 1232 3104 1232 3072
WIRE 1296 3104 1232 3104
WIRE 1424 3104 1424 3008
WIRE 1424 3104 1376 3104
WIRE 1456 3104 1424 3104
WIRE 1568 3104 1568 2992
WIRE 1568 3104 1536 3104
WIRE 1008 3136 1008 3072
WIRE 1232 3168 1232 3104
FLAG 1920 1232 0
FLAG 1920 1120 Vp
FLAG 1824 1232 0
FLAG 1824 1120 Vm
FLAG 1488 1440 0
FLAG 1152 1440 0
FLAG 2384 1472 Vp
FLAG 2384 1568 Vm
FLAG 2320 1664 0
FLAG 2544 1520 out2
FLAG 2160 1536 ue2
FLAG 1904 1648 Vp
FLAG 1904 1552 Vm
FLAG 1968 1808 0
FLAG 1728 1728 0
FLAG 1152 1728 0
FLAG 1600 1440 u1
FLAG 1568 1584 u2
FLAG 2656 1664 0
FLAG 2736 1664 0
FLAG 2736 1760 0
FLAG 2160 1408 ue1
FLAG 1408 1552 Vp
FLAG 1408 1616 Vm
FLAG 720 2144 0
FLAG 2912 3472 0
FLAG 1440 1728 Vp
FLAG 1440 1792 Vm
FLAG 1472 1872 0
FLAG 1312 1664 Vp
FLAG 2400 1968 0
FLAG 2272 2080 sup_u2
FLAG 2256 1968 sup_u1
FLAG 1472 2352 0
FLAG 1696 2352 0
FLAG 1856 2352 0
FLAG 1520 2208 pt2_ein
FLAG 1696 2208 TP1
FLAG 1856 2208 TP2
FLAG 1232 3168 0
FLAG 1008 3136 0
FLAG 1008 2624 0
FLAG 1104 2672 0
FLAG 1216 2496 Vref
FLAG 1216 2544 Vbias
FLAG 1488 3024 Vp
FLAG 1488 2960 Vm
SYMBOL source-V 1824 1120 R0
WINDOW 123 0 0 Left 0
WINDOW 39 0 0 Left 0
SYMATTR InstName V9
SYMATTR Value -10
SYMBOL source-V 1920 1120 R0
WINDOW 123 0 0 Left 0
WINDOW 39 0 0 Left 0
SYMATTR InstName V10
SYMATTR Value 10
SYMBOL source-V 1152 1328 M0
WINDOW 123 0 0 Left 0
WINDOW 39 0 0 Left 0
SYMATTR InstName V1
SYMATTR Value SINE(1.5 1.5 1k 5m)
SYMBOL Opamps\\opamp2 2384 1456 R0
SYMATTR InstName U1
SYMATTR Value OPA404
SYMBOL res 2176 1424 R270
WINDOW 0 25 56 VTop 0
WINDOW 3 7 56 VBottom 0
SYMATTR InstName R5
SYMATTR Value {R1}
SYMBOL res 2176 1552 R270
WINDOW 0 25 56 VTop 0
WINDOW 3 7 56 VBottom 0
SYMATTR InstName R6
SYMATTR Value {R3}
SYMBOL res 2304 1552 R0
SYMATTR InstName R7
SYMATTR Value {R4}
SYMBOL res 2336 1424 R270
WINDOW 0 25 56 VTop 0
WINDOW 3 7 56 VBottom 0
SYMATTR InstName R8
SYMATTR Value {R2}
SYMBOL source-V 1600 1440 M270
WINDOW 123 0 0 Left 0
WINDOW 39 0 0 Left 0
WINDOW 0 42 78 VLeft 0
WINDOW 3 -41 79 VLeft 0
SYMATTR InstName Vref1
SYMATTR Value 2.5V
SYMBOL res 1952 1600 R0
SYMATTR InstName R1
SYMATTR Value {Ra}
SYMBOL Opamps\\opamp2 1904 1664 M180
WINDOW 3 10 104 Left 0
SYMATTR Value OPA404
SYMATTR InstName U2
SYMBOL res 1952 1712 R0
SYMATTR InstName R2
SYMATTR Value {Ra}
SYMBOL res 1616 1424 M90
WINDOW 0 0 56 VBottom 0
WINDOW 3 32 56 VTop 0
SYMATTR InstName R4
SYMATTR Value 1.45k
SYMBOL res 1616 1568 M90
WINDOW 0 0 56 VBottom 0
WINDOW 3 32 56 VTop 0
SYMATTR InstName R9
SYMATTR Value 10k
SYMBOL res 1744 1616 M0
SYMATTR InstName R10
SYMATTR Value {R10}
SYMBOL source-V 1152 1616 M0
WINDOW 123 0 0 Left 0
WINDOW 39 0 0 Left 0
SYMATTR InstName V2
SYMATTR Value 1.5
SYMBOL crtl-V-I 2736 1536 R0
WINDOW 0 -10 -43 Left 0
WINDOW 3 -29 98 Left 0
SYMATTR InstName G1
SYMATTR Value 1
SYMBOL res 2864 1520 R0
SYMATTR InstName R11
SYMATTR Value 1.5
SYMBOL ind 2864 1616 R0
SYMATTR InstName L1
SYMATTR Value 160µ
SYMBOL Opamps\\opamp2 1408 1520 R0
WINDOW 3 14 104 Left 0
SYMATTR Value OPA404
SYMATTR InstName U3
SYMBOL Opamps\\opamp2 1440 1696 R0
WINDOW 3 14 104 Left 0
SYMATTR Value OPA404
SYMATTR InstName U4
SYMBOL res 1296 1776 R0
WINDOW 3 -19 12 VRight 0
SYMATTR Value {pot*set}
SYMATTR InstName R13
SYMBOL res 1360 1888 R270
WINDOW 0 25 56 VTop 0
WINDOW 3 7 56 VBottom 0
SYMATTR InstName R14
SYMATTR Value {pot*(1-set)}
SYMBOL res 1328 1664 M0
SYMATTR InstName R12
SYMATTR Value {2*pot}
SYMBOL res 2128 1952 M90
WINDOW 0 0 56 VBottom 0
WINDOW 3 32 56 VTop 0
SYMATTR InstName R15
SYMATTR Value 1587
SYMBOL res 2384 1984 M270
WINDOW 0 25 56 VTop 0
WINDOW 3 7 56 VBottom 0
SYMATTR InstName R16
SYMATTR Value 1.3k
SYMBOL res 2144 2064 M90
WINDOW 0 7 56 VBottom 0
WINDOW 3 25 56 VTop 0
SYMATTR InstName R18
SYMATTR Value 10k
SYMBOL source-Vmarker 2064 2080 R0
SYMATTR Value V=3V
SYMATTR InstName U5
SYMBOL source-Vmarker 2064 1968 R0
SYMATTR Value V=2.5V
SYMATTR InstName U6
SYMBOL source-V 1472 2224 R0
WINDOW 3 -268 -85 Left 0
WINDOW 123 -117 -57 Left 0
WINDOW 39 0 0 Left 0
SYMATTR Value PULSE(1 2 0 10n 10n {1/(2*frect)} {1/frect})
SYMATTR Value2 AC 1
SYMATTR InstName V3
SYMBOL res 1568 2224 R270
WINDOW 0 25 56 VTop 0
WINDOW 3 7 56 VBottom 0
SYMATTR InstName R3
SYMATTR Value 12k
SYMBOL cap 1680 2240 R0
SYMATTR InstName C1
SYMATTR Value 220n
SYMBOL res 1728 2224 R270
WINDOW 0 25 56 VTop 0
WINDOW 3 7 56 VBottom 0
SYMATTR InstName R17
SYMATTR Value 12k
SYMBOL cap 1840 2240 R0
SYMATTR InstName C2
SYMATTR Value 220n
SYMBOL res 1392 2960 R90
WINDOW 0 7 56 VBottom 0
WINDOW 3 25 56 VTop 0
SYMATTR InstName R19
SYMATTR Value 1k
SYMBOL res 1392 3088 R90
WINDOW 0 7 56 VBottom 0
WINDOW 3 25 56 VTop 0
SYMATTR InstName R20
SYMATTR Value 1k
SYMBOL res 1552 3088 R90
WINDOW 0 7 56 VBottom 0
WINDOW 3 25 56 VTop 0
SYMATTR InstName R21
SYMATTR Value 1k
SYMBOL res 1440 2960 R180
WINDOW 0 36 76 Left 0
WINDOW 3 36 40 Left 0
SYMATTR InstName R22
SYMATTR Value 1k
SYMBOL res 1216 2976 R0
SYMATTR InstName Shunt
SYMATTR Value 0.1
SYMBOL source-I 1008 2992 R0
WINDOW 123 0 0 Left 0
WINDOW 39 0 0 Left 0
SYMATTR InstName I1
SYMATTR Value SINE(0 1 1k)
SYMBOL source-V 1008 2512 M0
WINDOW 123 0 0 Left 0
WINDOW 39 0 0 Left 0
SYMATTR InstName V4
SYMATTR Value 2.5V
SYMBOL source-V 1104 2560 M0
WINDOW 123 0 0 Left 0
WINDOW 39 0 0 Left 0
SYMATTR InstName V5
SYMATTR Value 1.25V
SYMBOL Opamps\\opamp2 1488 3056 M180
WINDOW 3 14 104 Left 0
SYMATTR Value OPA404
SYMATTR InstName U7
TEXT 1472 912 Left 0 !.include /home/mainster/.wine/drive_c/Program Files (x86)/LTC_orig/LTspiceIV_4.18/lib/sub/OPA404.LIB
TEXT 1472 936 Left 0 !.include /home/mainster/.wine/drive_c/Program Files (x86)/LTC_orig/LTspiceIV_4.18/lib/sub/LM358.lib
TEXT 1472 856 Left 0 !;tran 100m
TEXT 1464 992 Left 0 ;Messwandler v1 \nSTM32 DAC out --> Endstufe Vin_ctrl\n0 ... 3V                --> -5V ... 5V\n \nENDSTUFE INVERTIERT!!!!
TEXT 1080 1048 Left 0 ;STM32f4
TEXT 1048 1256 Left 0 ;STM32 DAC \nVout_ctrl
TEXT 1472 1192 Left 0 !.param R1=10k\n.param R2={10/3*R1}\n.param R3=7k\n.param R4=6k\n;.step param R3 list 7k 7.5k
TEXT 2016 1024 Left 0 ;------------------------------------------------------------------------\nUa=Ue2 * (R1+R2)/R1 * R4/(R3+R4) - Ue1 * R2/R1\nUe1 * R2/R1 @ Ue1=3V  !=  10V  \n -->  R2=10/3*R1\n------------------------------------------------------------------------\nUe2* 13/3 * R4/(R3+R4) @ Ue2=2.5V (ref)  !=  +5V\n --> R4/(R3+R4)  !=  5V * 3/(13 * 2.5V)\n<--> (R3+R4)/R4  !=  13/6\n--> R3=7a   R4=6a     a el. |R\n------------------------------------------------------------------------
TEXT 1800 1304 Left 0 !.param Ra=22k
TEXT 2648 1024 Left 0 ;powerstage
TEXT 1400 2080 Left 0 !.tran 0 55m 50m
TEXT 1600 1904 Left 0 !.param pot = 10k\n.param set = 0.5
TEXT 1600 1848 Left 0 ;siehe MATLAB OpAmp_addierer_spannTeiler.m
TEXT 1576 1784 Left 0 !.param R10 = 1.4k\n;.step param R10 list 1.4k 1.421k
TEXT 1216 2248 Left 0 !;tran 0 80m 40m
TEXT 1952 2232 Left 0 !.param frect = 25\n;.step param frect list 10 25 50 100 1k
TEXT 1288 2808 Left 0 ;INA213B
TEXT 928 2424 Left 0 ;REF20xx
LINE Normal 2624 2000 2624 984 2
LINE Normal 1200 2032 1200 1008 2
LINE Normal 2800 2000 2800 984 2
LINE Normal 1568 1600 1568 1744 1
RECTANGLE Normal 1776 1760 1616 1392 2
RECTANGLE Normal 2384 2016 2112 1920 2
RECTANGLE Normal 1184 2720 928 2448 2
RECTANGLE Normal 1584 3168 1280 2832 2
