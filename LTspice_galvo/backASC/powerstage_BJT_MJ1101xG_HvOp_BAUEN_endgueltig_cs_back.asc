Version 4
SHEET 1 3760 2352
WIRE 2224 96 2224 48
WIRE 2320 96 2320 48
WIRE 1936 160 1936 48
WIRE 1936 160 1760 160
WIRE 1696 208 1664 208
WIRE 1936 208 1936 160
WIRE 2224 224 2224 176
WIRE 2320 224 2320 176
WIRE 2320 224 2224 224
WIRE 1808 256 1760 256
WIRE 1872 256 1808 256
WIRE 2320 256 2320 224
WIRE 1552 272 1552 240
WIRE 1616 272 1552 272
WIRE 1664 272 1664 208
WIRE 1664 272 1616 272
WIRE 1552 288 1552 272
WIRE 1760 288 1760 256
WIRE 1664 336 1664 272
WIRE 1696 336 1664 336
WIRE 1808 336 1808 256
WIRE 1824 336 1808 336
WIRE 1936 336 1936 304
WIRE 1936 336 1904 336
WIRE 1936 384 1936 336
WIRE 1936 384 1760 384
WIRE 1552 400 1552 368
WIRE 1936 448 1936 384
WIRE 1424 464 1408 464
WIRE 1424 480 1424 464
WIRE 1392 496 1360 496
WIRE 1472 512 1456 512
WIRE 1552 512 1552 464
WIRE 1552 512 1536 512
WIRE 1392 528 1344 528
WIRE 1424 560 1424 544
WIRE 1424 560 1408 560
WIRE 256 592 192 592
WIRE 304 592 256 592
WIRE 1344 608 1344 528
WIRE 1376 608 1344 608
WIRE 1616 608 1456 608
WIRE 1936 608 1936 528
WIRE 1936 608 1680 608
WIRE 2048 608 1936 608
WIRE 2128 608 2048 608
WIRE 2256 608 2192 608
WIRE 304 656 304 592
WIRE 1936 672 1936 608
WIRE 1344 704 1344 608
WIRE 2048 704 2048 608
WIRE 192 720 192 592
WIRE 1552 720 1552 512
WIRE 992 736 976 736
WIRE 1104 736 1072 736
WIRE 1152 736 1104 736
WIRE 1248 736 1232 736
WIRE 304 752 304 736
WIRE 304 752 224 752
WIRE 816 752 784 752
WIRE 928 752 896 752
WIRE 2256 752 2256 608
WIRE 304 784 304 752
WIRE 1184 800 1168 800
WIRE 1936 800 1936 752
WIRE 1936 800 1744 800
WIRE 2048 800 2048 784
WIRE 864 816 848 816
WIRE 1184 816 1184 800
WIRE 1552 816 1552 784
WIRE 192 832 192 784
WIRE 240 832 192 832
WIRE 864 832 864 816
WIRE 1104 832 1104 736
WIRE 1152 832 1104 832
WIRE 688 848 672 848
WIRE 784 848 784 752
WIRE 784 848 768 848
WIRE 832 848 784 848
WIRE 1248 848 1248 736
WIRE 1248 848 1216 848
WIRE 1344 848 1344 784
WIRE 1344 848 1248 848
WIRE 1680 848 1648 848
WIRE 928 864 928 752
WIRE 928 864 896 864
WIRE 976 864 928 864
WIRE 1104 864 1056 864
WIRE 1152 864 1104 864
WIRE 1824 864 1792 864
WIRE 1936 864 1936 800
WIRE 1936 864 1904 864
WIRE 832 880 800 880
WIRE 192 896 192 832
WIRE 1184 896 1184 880
WIRE 1184 896 1168 896
WIRE 1936 896 1936 864
WIRE 2048 896 2048 864
WIRE 2256 896 2256 832
WIRE 304 912 304 880
WIRE 864 912 864 896
WIRE 864 912 848 912
WIRE 1552 928 1552 896
WIRE 1616 928 1552 928
WIRE 1648 928 1648 848
WIRE 1648 928 1616 928
WIRE 1104 944 1104 864
WIRE 1744 944 1744 896
WIRE 1792 944 1792 864
WIRE 1792 944 1744 944
WIRE 1872 944 1792 944
WIRE 1552 960 1552 928
WIRE 1648 992 1648 928
WIRE 1680 992 1648 992
WIRE 192 1040 192 976
WIRE 304 1040 304 992
WIRE 1936 1040 1936 992
WIRE 1936 1040 1744 1040
WIRE 1552 1056 1552 1040
WIRE 480 1104 480 1040
WIRE 1936 1120 1936 1040
WIRE 1936 1120 1920 1120
WIRE 592 1200 592 1120
WIRE 1104 1200 1104 1024
WIRE 1392 1200 1104 1200
WIRE 1728 1200 1456 1200
WIRE 1984 1200 1728 1200
WIRE 2112 1200 2032 1200
WIRE 2256 1200 2256 976
WIRE 2256 1200 2112 1200
WIRE 2256 1232 2256 1200
WIRE 480 1248 480 1184
WIRE 528 1248 480 1248
WIRE 1984 1248 1984 1200
WIRE 2032 1264 2032 1200
WIRE 480 1296 480 1248
WIRE 592 1328 592 1296
WIRE 592 1328 512 1328
WIRE 2032 1344 2032 1312
WIRE 2256 1344 2256 1312
WIRE 2256 1344 2032 1344
WIRE 592 1360 592 1328
WIRE 1984 1360 1984 1328
WIRE 2256 1376 2256 1344
WIRE 480 1488 480 1360
WIRE 544 1488 480 1488
WIRE 592 1488 592 1440
WIRE 592 1488 544 1488
WIRE 1360 1712 1360 1680
WIRE 544 1792 528 1792
WIRE 576 1792 544 1792
WIRE 656 1792 624 1792
WIRE 688 1792 656 1792
WIRE 912 1792 880 1792
WIRE 928 1792 912 1792
WIRE 624 1808 624 1792
WIRE 880 1808 880 1792
WIRE 576 1824 576 1792
WIRE 1984 1888 1984 1824
WIRE 576 1920 576 1872
WIRE 624 1920 624 1888
WIRE 1696 1920 1696 1872
WIRE 928 1952 880 1952
WIRE 960 1952 928 1952
WIRE 2096 1952 2032 1952
WIRE 960 1968 960 1952
WIRE 1280 1968 1232 1968
WIRE 1328 1968 1280 1968
WIRE 1456 1968 1376 1968
WIRE 1616 1968 1584 1968
WIRE 1648 1968 1616 1968
WIRE 880 1984 880 1952
WIRE 2096 1984 2096 1952
WIRE 544 2000 528 2000
WIRE 576 2000 544 2000
WIRE 656 2000 624 2000
WIRE 688 2000 656 2000
WIRE 624 2016 624 2000
WIRE 1232 2016 1232 1968
WIRE 1376 2016 1376 1968
WIRE 1696 2016 1696 2000
WIRE 576 2032 576 2000
WIRE 1328 2032 1328 1968
WIRE 1648 2032 1648 1968
WIRE 1984 2032 1984 1968
WIRE 880 2080 880 2064
WIRE 960 2080 960 2048
WIRE 2096 2112 2096 2064
WIRE 576 2128 576 2080
WIRE 624 2128 624 2096
WIRE 1232 2128 1232 2096
WIRE 1328 2128 1328 2080
WIRE 1376 2128 1376 2096
WIRE 1424 2128 1376 2128
WIRE 1456 2128 1424 2128
WIRE 1648 2128 1648 2080
WIRE 1696 2128 1696 2096
WIRE 1984 2160 1984 2112
FLAG 1936 48 Vcc
FLAG 1920 1120 Vss
FLAG 2048 608 out_A
FLAG 2320 256 0
FLAG 2320 48 Vss
FLAG 2224 48 Vcc
FLAG 880 1888 0
FLAG 1616 272 b1
FLAG 1616 928 b2
FLAG 1552 1056 0
FLAG 1552 160 0
FLAG 2256 1376 0
FLAG 912 1792 stim
FLAG 1424 464 Vss
FLAG 1424 560 Vcc
FLAG 2048 896 0
FLAG 880 2080 0
FLAG 960 2080 0
FLAG 928 1952 I_cmd
FLAG 1984 1360 0
FLAG 2112 1200 shunt
FLAG 1360 496 0
FLAG 672 848 stim
FLAG 1328 2128 0
FLAG 1232 2128 0
FLAG 1280 1968 short_I
FLAG 1456 1968 no_I1
FLAG 1456 2128 no_I2
FLAG 1648 2128 0
FLAG 1616 1968 short_I
FLAG 1696 2128 0
FLAG 1696 1872 Vcc
FLAG 1424 2128 0
FLAG 624 1920 0
FLAG 576 1920 0
FLAG 656 1792 pwrStage
FLAG 544 1792 stim
FLAG 624 2128 0
FLAG 576 2128 0
FLAG 656 2000 pwrStageLoad
FLAG 544 2000 stim
FLAG 2032 1904 0
FLAG 2096 2112 0
FLAG 1984 2160 0
FLAG 1984 1824 0
FLAG 2096 1952 dynLoad
FLAG 1728 1200 Umon
FLAG 1312 1728 stim
FLAG 1360 1792 0
FLAG 1312 1776 0
FLAG 800 880 0
FLAG 1664 -160 0
FLAG 1728 -160 0
FLAG 976 736 0
FLAG 1184 896 Vss
FLAG 1184 800 Vcc
FLAG 864 912 Vss
FLAG 864 816 Vcc
FLAG 480 1040 Vcc
FLAG 544 1488 Vee
FLAG 256 592 Vcc
FLAG 192 1040 0
FLAG 304 1040 0
FLAG 592 1040 Vcc
FLAG 1328 944 0
SYMBOL EIT_Semiconductors\\pnp 1680 1040 M180
WINDOW 3 17 -21 Left 2
SYMATTR Value BD242C
SYMATTR InstName T3
SYMBOL res 1808 320 M90
WINDOW 3 25 56 VTop 2
WINDOW 0 7 56 VBottom 2
SYMATTR Value {bias}
SYMATTR InstName R6
SYMBOL res 1920 848 R90
WINDOW 0 7 56 VBottom 2
WINDOW 3 25 56 VTop 2
SYMATTR InstName R7
SYMATTR Value {bias}
SYMBOL res 1568 272 M0
SYMATTR InstName R8
SYMATTR Value {bias_b}
SYMBOL res 1568 800 M0
SYMATTR InstName R9
SYMATTR Value {bias_b}
SYMBOL diode 1536 400 R0
WINDOW 3 112 53 Right 2
SYMATTR Value 1N4148
SYMATTR InstName D2
SYMBOL diode 1536 720 R0
SYMATTR InstName D3
SYMATTR Value 1N4148
SYMBOL res 2240 880 R0
WINDOW 3 59 99 Left 2
SYMATTR Value 1.5
SYMATTR InstName Rload1
SYMBOL source-V 2224 80 R0
WINDOW 123 0 0 Left 2
WINDOW 39 0 0 Left 2
WINDOW 3 -87 92 Left 2
SYMATTR Value {vsup}
SYMATTR InstName V3
SYMBOL source-V 2320 80 R0
WINDOW 123 0 0 Left 2
WINDOW 39 0 0 Left 2
WINDOW 3 -72 98 Left 2
SYMATTR Value {-vsup}
SYMATTR InstName V4
SYMBOL source-V 880 1792 R0
WINDOW 123 28 56 Left 2
WINDOW 39 0 0 Left 2
WINDOW 3 -256 -43 Left 2
SYMATTR Value2 AC 1
SYMATTR Value PULSE( {-Uset} {Uset} 1m 10n 10n 2m 4m)
SYMATTR InstName V5
SYMBOL source-I 1552 240 R180
WINDOW 0 29 73 Left 2
WINDOW 3 29 17 Left 2
WINDOW 123 0 0 Left 2
WINDOW 39 0 0 Left 2
SYMATTR InstName I2
SYMATTR Value {IK1}
SYMBOL source-I 1552 1040 R180
WINDOW 0 29 73 Left 2
WINDOW 3 29 17 Left 2
WINDOW 123 0 0 Left 2
WINDOW 39 0 0 Left 2
SYMATTR InstName I3
SYMATTR Value {Ik1}
SYMBOL res 2240 1216 R0
SYMATTR InstName Rshunt
SYMATTR Value 0.01
SYMBOL res 1920 432 R0
SYMATTR InstName R13
SYMATTR Value {Rs}
SYMBOL res 1952 768 R180
WINDOW 0 36 76 Left 2
WINDOW 3 36 40 Left 2
SYMATTR InstName R14
SYMATTR Value {Rs}
SYMBOL res 2032 688 R0
SYMATTR InstName R22
SYMATTR Value 100
SYMBOL cap 2032 800 R0
SYMATTR InstName C3
SYMATTR Value 100µ
SYMBOL res 1360 800 R180
WINDOW 0 36 76 Left 2
WINDOW 3 36 40 Left 2
SYMATTR InstName R3
SYMATTR Value 10k
SYMBOL res 1360 592 M90
WINDOW 0 90 33 VBottom 2
WINDOW 3 32 56 VTop 2
SYMATTR InstName R4
SYMATTR Value {10k*Kp}
SYMBOL ind 2240 736 R0
SYMATTR InstName L2
SYMATTR Value 170µ
SYMATTR SpiceLine Rpar=1meg Cpar=100p
SYMBOL current 880 2064 R180
WINDOW 0 24 80 Left 2
WINDOW 3 -193 -75 Left 2
WINDOW 123 -193 -103 Left 2
WINDOW 39 0 0 Left 2
SYMATTR InstName I_cmd1
SYMATTR Value PULSE({-Ipeak} {Ipeak} 0 20n 20n 1m 2m)
SYMBOL res 944 1952 R0
SYMATTR InstName RI_cmd
SYMATTR Value 1
SYMBOL e 1984 1232 M0
SYMATTR InstName E1
SYMATTR Value 100
SYMBOL Misc\\jumper 1504 448 R0
SYMATTR InstName X2
SYMBOL sw 1376 2112 M180
SYMATTR InstName Short_I
SYMATTR Value SWA
SYMBOL source-V 1232 2000 R0
WINDOW 123 28 56 Left 2
WINDOW 39 0 0 Left 2
WINDOW 3 -119 177 Left 2
SYMATTR Value {10k*Ki+1u}
SYMATTR InstName V1
SYMBOL sw 1696 2112 M180
SYMATTR InstName Short_I1
SYMATTR Value SWA
SYMBOL res 1680 1904 R0
SYMATTR InstName R1
SYMATTR Value 1k
SYMBOL MJ11016G 1872 208 R0
SYMATTR InstName U1
SYMBOL MJ11015G 1872 992 M180
WINDOW 3 89 -48 Left 2
SYMATTR InstName U4
SYMBOL e 624 1792 R0
SYMATTR InstName E2
SYMATTR Value 1
SYMBOL Misc\\jumper 1648 672 R180
SYMATTR InstName X3
SYMBOL e 624 2000 R0
WINDOW 3 15 161 Left 2
SYMATTR Value 1
SYMATTR InstName E3
SYMBOL Misc\\jumper 2160 544 R0
SYMATTR InstName X4
SYMBOL Misc\\jumper 1424 1136 R0
SYMATTR InstName X5
SYMBOL sw 1984 1872 M0
SYMATTR InstName S1
SYMATTR Value swA
SYMBOL source-V 2096 1968 R0
WINDOW 123 28 56 Left 2
WINDOW 39 0 0 Left 2
WINDOW 3 94 -113 VRight 2
SYMATTR Value PULSE(0 1 3.8m 10n 10n 2m 3m)
SYMATTR InstName V2
SYMBOL res 2000 2016 M0
WINDOW 3 59 99 Left 2
SYMATTR Value 1.5
SYMATTR InstName Rload3
SYMBOL e 1360 1696 R0
SYMATTR InstName E5
SYMATTR Value -6
SYMBOL Opamps\\UniversalOpamp2 864 864 R0
SYMATTR InstName U5
SYMBOL res 800 768 R270
WINDOW 0 25 56 VTop 2
WINDOW 3 7 56 VBottom 2
SYMATTR InstName R16
SYMATTR Value {Kvv*10k}
SYMBOL res 672 864 R270
WINDOW 0 25 56 VTop 2
WINDOW 3 7 56 VBottom 2
SYMATTR InstName R17
SYMATTR Value 10k
SYMBOL cap 1664 -144 R270
WINDOW 0 32 32 VTop 2
WINDOW 3 87 113 VBottom 2
SYMATTR InstName C4
SYMATTR Value {1/(1k*Ki+1u)}
SYMBOL EIT_Semiconductors\\npn 1696 160 R0
WINDOW 3 6 -23 Left 2
SYMATTR Value 2N5550
SYMATTR InstName Q1
SYMBOL EIT_Semiconductors\\pnp 1696 384 M180
WINDOW 3 12 -19 Left 2
SYMATTR Value BD242C
SYMATTR InstName T2
SYMBOL EIT_Semiconductors\\npn 1680 800 R0
WINDOW 3 32 -24 Left 2
SYMATTR Value 2N5550
SYMATTR InstName Q3
SYMBOL res 1088 752 M270
WINDOW 0 25 56 VTop 2
WINDOW 3 7 56 VBottom 2
SYMATTR InstName R18
SYMATTR Value {Rsu}
SYMBOL res 960 880 R270
WINDOW 0 25 56 VTop 2
WINDOW 3 7 56 VBottom 2
SYMATTR InstName R19
SYMATTR Value {Rsu}
SYMBOL res 1088 1040 M180
WINDOW 0 36 76 Left 2
WINDOW 3 36 40 Left 2
SYMATTR InstName R20
SYMATTR Value {Rsu}
SYMBOL res 1136 752 R270
WINDOW 0 25 56 VTop 2
WINDOW 3 7 56 VBottom 2
SYMATTR InstName R21
SYMATTR Value {Rsu}
SYMBOL TL431 480 1344 R180
SYMATTR InstName U2
SYMBOL res 464 1088 R0
SYMATTR InstName R2
SYMATTR Value 4.7k
SYMBOL EIT_Semiconductors\\npn 528 1200 R0
SYMATTR InstName Q2
SYMATTR Value BC550C
SYMBOL res 576 1344 R0
SYMATTR InstName R5
SYMATTR Value 613
SYMBOL EIT_Semiconductors\\pnp 240 880 M180
SYMATTR InstName Q4
SYMATTR Value BC557B
SYMBOL TL431 192 768 R180
SYMATTR InstName U3
SYMBOL res 288 640 R0
SYMATTR InstName R10
SYMATTR Value 613
SYMBOL res 176 880 R0
SYMATTR InstName R11
SYMATTR Value 4.7k
SYMBOL res 576 1024 R0
SYMATTR InstName R12
SYMATTR Value 50
SYMBOL res 288 896 R0
SYMATTR InstName R15
SYMATTR Value 50
SYMBOL Opamps\\opamp2 1424 576 M180
WINDOW 0 21 92 Left 2
WINDOW 3 19 31 Left 2
SYMATTR InstName U6
SYMATTR Value ada4700
SYMATTR SpiceModel ada4700
SYMBOL Opamps\\opamp2 1184 784 R0
WINDOW 0 21 92 Left 2
WINDOW 3 19 31 Left 2
SYMATTR InstName U7
SYMATTR Value ""
SYMATTR SpiceModel ada4700
TEXT 2200 336 Left 2 !.tran 10m uic
TEXT 2112 296 Left 2 !;ac oct 500 1 1000meg
TEXT 672 2304 Left 2 !.inc /home/mainster/.wine/drive_c/Program Files (x86)/LTC_orig/LTspiceIV_4.18/lib/sub/ADA4700.sub
TEXT 672 2336 Left 2 !.inc /home/mainster/.wine/drive_c/Program Files (x86)/LTC_orig/LTspiceIV_4.18/lib/sub/LM358.sub
TEXT 984 64 Left 2 !; ---------------------\n;   Power amp\n; ---------------------\n.param Ik1 = 3m\n.param bias = 2.5k\n.param bias_b = 350\n.param Rs = 10m
TEXT 1304 -216 Left 2 !; ---------------------\n;   SOURCES\n; ---------------------\n.param Vsup = 30V\n.param Ipeak = 10A
TEXT 976 -240 Left 2 !; ---------------------\n;   Compensator\n; ---------------------\n.param Uset = 3\n.param Rsu = 10k\n.param Kp = 5\n.param Ki = 15000\n; Vorverstärker: Ic=Kvv*Uset\n.param Kvv = 2
TEXT 1112 1904 Left 2 !.model swA SW(Ron=.1 Roff=100Meg Vt=0.1 Vh=-.5 )
TEXT 1776 -112 Left 2 ;.step param Kp 5 15 1
TEXT 584 -584 Left 4 ;Leerlauf:    laplace=(0.1723*s**2-1.645e7*s-4.932e14)/(1.224e7*s+s**2+6.152e13)\n 170u / 1.51ohm last: (nur 84%):    laplace=(1.508e7*s+4.603e14)/(1.135e7*s+s**2+6.051e13)\n- Reiner P- Regler (inv. Verstärker), Kp=8, \n   nicht von OpOut sondern von out_A knoten auf inv eingang zurück koppeln, +eingang auf gnd\n- Keine Last, keine Rückführungen sonst\n- AC -1 einstellen sonst fängt das Bodediag. bei +180deg an und meine Approximation in matlab kackt
TEXT 1768 -136 Left 2 ;.step param Kvv 1 4 0.5
TEXT 144 -392 Left 2 ;tempco of 1N914 measured:\n-1.66702mV/K
