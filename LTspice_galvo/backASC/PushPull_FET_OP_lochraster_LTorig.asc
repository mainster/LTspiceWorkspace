Version 4
SHEET 1 1316 692
WIRE -1040 -1904 -1168 -1904
WIRE -1168 -1872 -1168 -1904
WIRE -1072 -1792 -1104 -1792
WIRE -960 -1792 -1072 -1792
WIRE -1072 -1760 -1072 -1792
WIRE -960 -1760 -960 -1792
WIRE -1168 -1648 -1168 -1712
WIRE -1072 -1648 -1072 -1680
WIRE -1072 -1648 -1168 -1648
WIRE -1072 -1616 -1072 -1648
WIRE -1168 -1568 -1168 -1648
WIRE -1136 -1568 -1168 -1568
WIRE 528 -1504 528 -1552
WIRE -1072 -1472 -1072 -1520
WIRE -960 -1472 -960 -1680
WIRE -960 -1472 -1072 -1472
WIRE -1072 -1408 -1072 -1472
WIRE 528 -1376 528 -1424
WIRE -1072 -1296 -1072 -1328
WIRE -544 -1232 -672 -1232
WIRE -224 -1232 -224 -1248
WIRE -672 -1200 -672 -1232
WIRE -304 -1152 -304 -1168
WIRE -304 -1152 -352 -1152
WIRE -224 -1152 -304 -1152
WIRE 560 -1136 560 -1184
WIRE 656 -1136 656 -1184
WIRE -576 -1120 -608 -1120
WIRE -576 -1088 -576 -1120
WIRE -432 -1088 -448 -1088
WIRE -400 -1088 -432 -1088
WIRE -400 -1008 -400 -1040
WIRE -352 -1008 -352 -1024
WIRE -304 -1008 -304 -1152
WIRE 560 -1008 560 -1056
WIRE 656 -1008 656 -1056
WIRE 656 -1008 560 -1008
WIRE -672 -976 -672 -1040
WIRE -576 -976 -576 -1008
WIRE -576 -976 -672 -976
WIRE 656 -976 656 -1008
WIRE 16 -928 16 -1040
WIRE 16 -928 -128 -928
WIRE -576 -912 -576 -976
WIRE -576 -896 -576 -912
WIRE -304 -880 -304 -928
WIRE -224 -880 -304 -880
WIRE -192 -880 -224 -880
WIRE 16 -880 16 -928
WIRE -304 -848 -304 -880
WIRE -576 -800 -576 -832
WIRE -128 -800 -128 -832
WIRE -80 -800 -128 -800
WIRE -32 -800 -80 -800
WIRE -304 -736 -304 -768
WIRE -128 -736 -128 -800
WIRE -96 -736 -128 -736
WIRE 16 -736 16 -784
WIRE 16 -736 -16 -736
WIRE -304 -704 -304 -736
WIRE 16 -688 16 -736
WIRE -720 -576 -736 -576
WIRE -640 -576 -720 -576
WIRE -528 -576 -560 -576
WIRE -496 -576 -528 -576
WIRE -432 -576 -496 -576
WIRE -304 -560 -304 -640
WIRE -304 -560 -368 -560
WIRE 16 -560 16 -608
WIRE 128 -560 16 -560
WIRE 560 -560 128 -560
WIRE -432 -544 -464 -544
WIRE 16 -528 16 -560
WIRE 560 -528 560 -560
WIRE -736 -496 -736 -576
WIRE -304 -496 -304 -560
WIRE -304 -464 -304 -496
WIRE 1008 -464 880 -464
WIRE 880 -432 880 -464
WIRE -736 -400 -736 -416
WIRE -96 -400 -128 -400
WIRE 16 -400 16 -448
WIRE 16 -400 -16 -400
WIRE 560 -400 560 -448
WIRE -304 -384 -304 -400
WIRE -304 -368 -304 -384
WIRE 16 -368 16 -400
WIRE 1008 -368 1008 -464
WIRE 16 -352 16 -368
WIRE 832 -352 720 -352
WIRE -128 -336 -128 -400
WIRE -64 -336 -128 -336
WIRE -32 -336 -64 -336
WIRE 720 -336 720 -352
WIRE 880 -336 880 -352
WIRE -128 -304 -128 -336
WIRE 560 -272 560 -320
WIRE 560 -272 240 -272
WIRE 880 -272 880 -336
WIRE 1008 -272 1008 -288
WIRE -304 -256 -304 -288
WIRE -240 -256 -304 -256
WIRE -192 -256 -240 -256
WIRE -304 -224 -304 -256
WIRE 720 -224 720 -256
WIRE 16 -208 16 -256
WIRE 16 -208 -128 -208
WIRE -688 -176 -688 -208
WIRE -576 -128 -576 -176
WIRE 880 -128 784 -128
WIRE 992 -128 880 -128
WIRE 240 -112 240 -272
WIRE 240 -112 80 -112
WIRE -304 -96 -304 -144
WIRE -688 -80 -688 -96
WIRE -640 -80 -688 -80
WIRE 16 -80 16 -208
WIRE 16 -80 0 -80
WIRE 80 -80 80 -112
WIRE -688 -32 -688 -80
WIRE 880 -32 880 -128
WIRE 240 -16 240 -112
WIRE 784 -16 784 -48
WIRE 832 -16 784 -16
WIRE -576 0 -576 -32
WIRE -576 0 -656 0
WIRE -224 0 -224 -16
WIRE 992 16 992 -128
WIRE -576 32 -576 0
WIRE -528 32 -528 -576
WIRE -192 32 -528 32
WIRE 80 32 80 0
WIRE 80 32 -192 32
WIRE 80 48 80 32
WIRE -192 64 -192 32
WIRE 992 112 992 96
WIRE -688 128 -688 32
WIRE -624 128 -688 128
WIRE -576 128 -576 112
WIRE -576 128 -624 128
WIRE 240 144 240 64
WIRE 880 144 880 64
WIRE -192 160 -192 128
FLAG 16 -1040 Vplus
FLAG 0 -80 Vmin
FLAG 128 -560 out_A
FLAG -64 -336 Gp1
FLAG 16 -368 Sp1
FLAG 16 -736 Sn1
FLAG -80 -800 Gn1
FLAG -496 -576 in
FLAG -688 -208 Vplus
FLAG -624 128 Vmin
FLAG 656 -976 0
FLAG 656 -1184 Vmin
FLAG 560 -1184 Vplus
FLAG -736 -400 0
FLAG -192 160 0
FLAG 1184 -784 0
FLAG 880 -272 0
FLAG 1008 -272 0
FLAG 720 -224 0
FLAG 992 112 0
FLAG 880 144 0
FLAG -224 -880 b1
FLAG -240 -256 b2
FLAG -304 -736 d1
FLAG -304 -496 d2
FLAG -304 -384 r4
FLAG -304 -16 0
FLAG -304 -1248 0
FLAG 240 144 0
FLAG -464 -544 0
FLAG -544 -1232 0
FLAG -576 -256 0
FLAG -224 0 0
FLAG -1040 -1904 0
FLAG -1072 -1296 0
FLAG -576 -800 0
FLAG -224 -1248 0
FLAG 528 -1552 Vcs
FLAG 528 -1376 0
FLAG -400 -1008 0
FLAG -432 -1088 b1
FLAG -352 -1008 0
FLAG -720 -576 stim
FLAG 768 656 0
FLAG -1456 672 0
SYMBOL EIT_Semiconductors\\npn -192 -928 R0
SYMATTR InstName T1
SYMATTR Value BC547B
SYMBOL EIT_Semiconductors\\pnp -192 -208 M180
SYMATTR InstName T2
SYMATTR Value BC327-40
SYMBOL res -112 -720 R270
WINDOW 0 25 56 VTop 0
WINDOW 3 7 56 VBottom 0
SYMATTR InstName R1
SYMATTR Value {bias}
SYMBOL res 0 -384 M270
WINDOW 0 25 56 VTop 0
WINDOW 3 7 56 VBottom 0
SYMATTR InstName R2
SYMATTR Value {bias}
SYMBOL res -320 -864 R0
SYMATTR InstName R3
SYMATTR Value 1k
SYMBOL res -320 -384 R0
SYMATTR InstName R4
SYMATTR Value 1k
SYMBOL diode -320 -704 R0
SYMATTR InstName D1
SYMATTR Value 1N4148
SYMBOL diode -320 -464 R0
SYMATTR InstName D2
SYMATTR Value 1N4148
SYMBOL res 544 -416 R0
SYMATTR InstName Rload1
SYMATTR Value 2.2
SYMBOL EIT_Semiconductors\\nmos -32 -880 R0
SYMATTR InstName M1
SYMATTR Value IRFP240
SYMBOL EIT_Semiconductors\\pmos -32 -256 M180
SYMATTR InstName M2
SYMATTR Value IRFP9240
SYMBOL res 64 -96 R0
SYMATTR InstName R7
SYMATTR Value 1k
SYMBOL ind 544 -544 R0
SYMATTR InstName L1
SYMATTR Value 100p
SYMBOL TL431 -688 16 R180
SYMATTR InstName U3
SYMBOL res -672 -192 M0
SYMATTR InstName R10
SYMATTR Value 4.7k
SYMBOL EIT_Semiconductors\\npn -640 -128 R0
SYMATTR InstName Q1
SYMATTR Value BC547B
SYMBOL res -592 16 R0
SYMATTR InstName R11
SYMATTR Value 315
SYMBOL source-V 560 -1152 R0
WINDOW 123 0 0 Left 0
WINDOW 39 0 0 Left 0
WINDOW 3 -87 92 Left 0
SYMATTR Value {vsup}
SYMATTR InstName V1
SYMBOL source-V 656 -1152 R0
WINDOW 123 0 0 Left 0
WINDOW 39 0 0 Left 0
WINDOW 3 -72 98 Left 0
SYMATTR Value {-vsup}
SYMATTR InstName V2
SYMBOL source-V -736 -512 R0
WINDOW 123 -233 178 Left 0
WINDOW 39 0 0 Left 0
WINDOW 3 -233 150 Left 0
SYMATTR Value2 AC 1
SYMATTR Value PULSE(2.8 -2.8 0 5m 5m 0 10m)
SYMATTR InstName V3
SYMBOL res -320 -240 R0
SYMATTR InstName R12
SYMATTR Value 1m
SYMBOL res -320 -1024 R0
SYMATTR InstName R13
SYMATTR Value 1m
SYMBOL EIT_Semiconductors\\op_3 -400 -560 R0
WINDOW 123 -264 -90 Left 0
WINDOW 3 -604 -117 Left 0
SYMATTR Value2 FT={FT} SR=10
SYMATTR Value Vp={0.95*Vsup} Vm={-0.95*Vsup} Ilim=20m
SYMATTR InstName U1
SYMBOL EIT_Semiconductors\\nmos 832 -432 R0
SYMATTR InstName M3
SYMATTR Value IRFP240
SYMBOL source-V 1008 -384 R0
WINDOW 123 0 0 Left 0
WINDOW 39 0 0 Left 0
WINDOW 3 -18 167 Left 0
SYMATTR Value 10
SYMATTR InstName V5
SYMBOL source-V 720 -352 R0
WINDOW 123 0 0 Left 0
WINDOW 39 0 0 Left 0
WINDOW 3 -18 167 Left 0
SYMATTR Value 10
SYMATTR InstName V6
SYMBOL EIT_Semiconductors\\pmos 832 64 M180
SYMATTR InstName M4
SYMATTR Value IRFP9240
SYMBOL source-V 992 0 R0
WINDOW 123 0 0 Left 0
WINDOW 39 0 0 Left 0
WINDOW 3 -18 167 Left 0
SYMATTR Value 10
SYMATTR InstName V4
SYMBOL source-V 784 -32 R180
WINDOW 123 0 0 Left 0
WINDOW 39 0 0 Left 0
WINDOW 3 -18 167 Left 0
SYMATTR Value 10
SYMATTR InstName V7
SYMBOL source-I -304 -1168 R180
WINDOW 0 29 73 Left 0
WINDOW 3 29 17 Left 0
WINDOW 123 0 0 Left 0
WINDOW 39 0 0 Left 0
SYMATTR InstName I1
SYMATTR Value {IK1}
SYMBOL source-I -304 -16 R180
WINDOW 0 29 73 Left 0
WINDOW 3 29 17 Left 0
WINDOW 123 0 0 Left 0
WINDOW 39 0 0 Left 0
SYMATTR InstName I2
SYMATTR Value {Ik1}
SYMBOL res 224 -32 R0
SYMATTR InstName R5
SYMATTR Value 0.1
SYMBOL res -544 -592 R90
WINDOW 0 7 56 VBottom 0
WINDOW 3 25 56 VTop 0
SYMATTR InstName R6
SYMATTR Value 10k
SYMBOL res 0 -704 R0
SYMATTR InstName R8
SYMATTR Value {Rs}
SYMBOL res 0 -544 R0
SYMATTR InstName R9
SYMATTR Value {Rs}
SYMBOL LM334 -672 -1120 R0
SYMATTR InstName U2
SYMBOL res -592 -1104 R0
SYMATTR InstName R14
SYMATTR Value {Rset}
SYMBOL LM334 -1168 -1792 R0
SYMATTR InstName U4
SYMBOL res -1088 -1776 R0
SYMATTR InstName R20
SYMATTR Value 166
SYMBOL res -976 -1776 R0
SYMATTR InstName R21
SYMATTR Value {6.8*166}
SYMBOL EIT_Semiconductors\\npn -1136 -1616 R0
SYMATTR InstName Q3
SYMATTR Value BC547B
SYMBOL res -1088 -1424 R0
SYMATTR InstName R17
SYMATTR Value 100
SYMBOL res -592 -272 R0
SYMATTR InstName R16
SYMATTR Value 100
SYMBOL res -240 -1248 R0
SYMATTR InstName R18
SYMATTR Value 100t
SYMBOL res -592 -928 R0
SYMATTR InstName R15
SYMATTR Value 100
SYMBOL source-V 528 -1520 R0
WINDOW 123 0 0 Left 0
WINDOW 39 0 0 Left 0
WINDOW 3 -87 92 Left 0
SYMATTR Value 30
SYMATTR InstName V8
SYMBOL sw -352 -1008 M180
WINDOW 3 -72 121 Left 0
SYMATTR Value Osw
SYMATTR InstName S1
TEXT 512 -792 Left 0 ;.step param bias list 200 1k 2.4k
TEXT -448 -1392 Left 0 !.model npnx npn (Bf=200 Is={10m/exp(0.7/26m)}\n.model pnpx pnp (Bf=200 Is={10m/exp(0.7/26m)}\n.model Dx D (Is={(20*50u)/exp(0.7/26m)}
TEXT 520 -888 Left 0 !.ac oct 100 1k 100meg
TEXT 520 -856 Left 0 ;.step param Ik1 1m 1.05m 5u
TEXT -840 -328 Left 0 ;PULSE(-.5 .5 0 1m 1m 10m 23m)
TEXT -640 -720 Left 0 ;Vp=25 Vm=-25 Ilim=20m
TEXT 24 -1616 Left 0 !.param Ik1=3m\n.param bias=1.5k\n.param Rs=1u\n.param vsup=12\n.param RSet =25\n.param Rll=5k\n.param FT=10meg
TEXT 528 -824 Left 0 ;.temp 27 90
TEXT 512 -752 Left 0 ;.step param Rset 10 30 0.1
TEXT 520 -656 Left 0 ;.step param Rll 10 10k 200
TEXT -664 -1584 Left 0 !.model Osw SW(Ron=10u Roff=10meg Vt=12 Vh=-.2)
TEXT -680 280 Left 0 !.step param FT 10meg 50meg 10meg
RECTANGLE Normal -848 -1304 352 192 2
