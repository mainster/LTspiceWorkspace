Version 4
SHEET 1 880 2276
WIRE 32 352 16 352
WIRE 48 352 32 352
WIRE 48 368 48 352
WIRE -32 544 -32 528
WIRE 48 608 48 480
WIRE -1008 624 -1072 624
WIRE -464 624 -928 624
WIRE 48 672 48 608
WIRE -1456 688 -1536 688
WIRE -1344 688 -1392 688
WIRE -1280 688 -1344 688
WIRE -1264 688 -1280 688
WIRE -1072 688 -1072 624
WIRE -1072 688 -1184 688
WIRE -1056 688 -1072 688
WIRE -928 688 -992 688
WIRE -32 688 -32 624
WIRE -1536 720 -1536 688
WIRE -1072 768 -1072 688
WIRE -1024 768 -1072 768
WIRE -928 784 -928 688
WIRE -928 784 -960 784
WIRE -864 784 -928 784
WIRE -720 784 -864 784
WIRE -624 784 -640 784
WIRE -1280 800 -1296 800
WIRE -1264 800 -1280 800
WIRE -1152 800 -1184 800
WIRE -1072 800 -1152 800
WIRE -1024 800 -1072 800
WIRE -544 800 -544 784
WIRE -1536 816 -1536 800
WIRE -624 816 -624 784
WIRE -576 816 -624 816
WIRE -1152 832 -1152 800
WIRE -464 832 -464 624
WIRE -464 832 -512 832
WIRE -416 832 -464 832
WIRE -368 832 -416 832
WIRE -1072 848 -1072 800
WIRE -576 848 -624 848
WIRE -720 880 -832 880
WIRE -624 880 -624 848
WIRE -624 880 -640 880
WIRE -544 896 -544 864
WIRE -544 896 -560 896
WIRE 48 896 -32 896
WIRE 128 896 48 896
WIRE -1456 912 -1536 912
WIRE -1344 912 -1344 688
WIRE -1344 912 -1392 912
WIRE -1152 928 -1152 912
WIRE -1072 928 -1072 912
WIRE -1536 944 -1536 912
WIRE -32 944 -32 896
WIRE 128 944 128 896
WIRE 48 992 32 992
WIRE 64 992 48 992
WIRE -1536 1040 -1536 1024
WIRE -1200 1056 -1248 1056
WIRE -1088 1056 -1120 1056
WIRE -1040 1056 -1088 1056
WIRE -944 1056 -976 1056
WIRE -864 1056 -944 1056
WIRE -832 1056 -832 880
WIRE -832 1056 -864 1056
WIRE -32 1056 -32 1040
WIRE 48 1056 48 992
WIRE 48 1056 -32 1056
WIRE -32 1072 -32 1056
WIRE 128 1104 128 1040
WIRE 160 1104 128 1104
WIRE 192 1104 160 1104
WIRE -224 1120 -240 1120
WIRE -784 1136 -816 1136
WIRE -672 1136 -704 1136
WIRE -624 1136 -672 1136
WIRE -592 1136 -624 1136
WIRE -144 1136 -144 1120
WIRE -1088 1152 -1088 1056
WIRE -1056 1152 -1088 1152
WIRE -224 1152 -224 1120
WIRE -176 1152 -224 1152
WIRE 128 1152 128 1104
WIRE -1168 1168 -1168 1152
WIRE -944 1168 -944 1056
WIRE -944 1168 -992 1168
WIRE -672 1168 -672 1136
WIRE -80 1168 -112 1168
WIRE -32 1168 -32 1152
WIRE -32 1168 -80 1168
WIRE -1104 1184 -1136 1184
WIRE -1056 1184 -1104 1184
WIRE -176 1184 -224 1184
WIRE -1248 1200 -1248 1056
WIRE -1200 1200 -1248 1200
WIRE -1104 1216 -1136 1216
WIRE -224 1216 -224 1184
WIRE -224 1216 -240 1216
WIRE -224 1232 -224 1216
WIRE -144 1232 -144 1200
WIRE -144 1232 -160 1232
WIRE -1184 1248 -1184 1232
WIRE -1168 1248 -1168 1232
WIRE -1168 1248 -1184 1248
WIRE 128 1248 128 1232
WIRE -1168 1264 -1168 1248
WIRE -672 1264 -672 1232
WIRE -1824 1312 -1856 1312
WIRE -1808 1312 -1824 1312
WIRE -224 1312 -224 1296
WIRE -1248 1328 -1248 1200
WIRE -1216 1328 -1248 1328
WIRE -1104 1328 -1104 1216
WIRE -1104 1328 -1136 1328
WIRE -1072 1328 -1104 1328
WIRE -944 1328 -944 1168
WIRE -944 1328 -992 1328
WIRE -32 1408 -32 1376
WIRE -512 1488 -512 1472
WIRE -704 1536 -720 1536
WIRE -624 1552 -624 1536
WIRE -704 1568 -704 1536
WIRE -656 1568 -704 1568
WIRE -2240 1584 -2288 1584
WIRE -2208 1584 -2240 1584
WIRE -2080 1584 -2128 1584
WIRE -2048 1584 -2080 1584
WIRE -1920 1584 -1968 1584
WIRE -1888 1584 -1920 1584
WIRE -1760 1584 -1808 1584
WIRE -1728 1584 -1760 1584
WIRE -1584 1584 -1616 1584
WIRE -1568 1584 -1584 1584
WIRE -1392 1584 -1456 1584
WIRE -1376 1584 -1392 1584
WIRE -560 1584 -592 1584
WIRE -512 1584 -512 1568
WIRE -512 1584 -560 1584
WIRE -1456 1600 -1456 1584
WIRE -656 1600 -704 1600
WIRE -512 1600 -512 1584
WIRE -2288 1616 -2288 1584
WIRE -2128 1616 -2128 1584
WIRE -1968 1616 -1968 1584
WIRE -1808 1616 -1808 1584
WIRE -1616 1616 -1616 1584
WIRE -848 1632 -880 1632
WIRE -800 1632 -848 1632
WIRE -704 1632 -704 1600
WIRE -704 1632 -720 1632
WIRE -624 1648 -624 1616
WIRE -624 1648 -640 1648
WIRE -880 1696 -880 1632
WIRE -2288 1712 -2288 1696
WIRE -2128 1712 -2128 1696
WIRE -1968 1712 -1968 1696
WIRE -1808 1712 -1808 1696
WIRE -1616 1712 -1616 1696
WIRE -1456 1712 -1456 1680
WIRE -1392 1776 -1456 1776
WIRE -1376 1776 -1392 1776
WIRE -1584 1792 -1616 1792
WIRE -1568 1792 -1584 1792
WIRE -1456 1792 -1456 1776
WIRE -880 1792 -880 1776
WIRE -1616 1824 -1616 1792
WIRE -1456 1904 -1456 1872
WIRE -1616 1920 -1616 1904
FLAG -864 1056 tri
FLAG -1072 928 0
FLAG -1152 928 0
FLAG -1280 800 vref
FLAG -1536 816 0
FLAG -1280 688 ain
FLAG -672 1264 0
FLAG -624 1136 pwfil2
FLAG -864 784 err
FLAG -544 784 0
FLAG -1536 1040 0
FLAG -816 1136 0
FLAG -992 752 0
FLAG -1168 1264 0
FLAG -1104 1184 vref
FLAG -1024 1136 V+
FLAG -1824 1312 vref
FLAG -1616 1712 0
FLAG -1024 1200 0
FLAG -2128 1712 0
FLAG -2080 1584 R6_in_k
FLAG -1808 1712 0
FLAG -1760 1584 Vtri
FLAG -1968 1712 0
FLAG -1920 1584 R5_in_k
FLAG -2288 1712 0
FLAG -2240 1584 R7_in_k
FLAG -1168 1152 V+
FLAG -992 816 V+
FLAG -1584 1584 V+
FLAG 48 608 pwm
FLAG 32 352 +10V
FLAG -560 896 +10V
FLAG 48 448 0
FLAG -32 736 0
FLAG 48 752 0
FLAG -32 528 +10V
FLAG -144 1120 0
FLAG -160 1232 +10V
FLAG 48 896 +10V
FLAG -320 1120 tri
FLAG -80 1168 oc_mir
FLAG 128 1248 0
FLAG 160 1104 q1
FLAG -32 1408 0
FLAG -32 1296 0
FLAG -544 1072 0
FLAG -544 1040 0
FLAG -512 1088 0
FLAG -512 1024 0
FLAG -416 832 pwo
FLAG -624 1536 0
FLAG -640 1648 +10V
FLAG -800 1536 tri
FLAG -560 1584 ocsi
FLAG -512 1472 +10V
FLAG -880 1792 0
FLAG -848 1632 an1
FLAG -1456 1712 0
FLAG -1392 1584 up
FLAG -1456 1904 0
FLAG -1392 1776 lo
FLAG -1616 1920 0
FLAG -1584 1792 Vrm
FLAG -320 1216 an1
FLAG -224 1312 0
SYMBOL cap -1056 704 R270
WINDOW 0 32 32 VTop 2
WINDOW 3 0 32 VBottom 2
SYMATTR InstName C2
SYMATTR Value 220n
SYMBOL res -1280 704 R270
WINDOW 0 25 56 VTop 2
WINDOW 3 7 56 VBottom 2
SYMATTR InstName R4
SYMATTR Value 10k
SYMBOL res -1280 816 R270
WINDOW 0 25 56 VTop 2
WINDOW 3 7 56 VBottom 2
SYMATTR InstName R5
SYMATTR Value 10k
SYMBOL res -1168 816 R0
SYMATTR InstName R6
SYMATTR Value 10k
SYMBOL cap -1088 848 R0
SYMATTR InstName C4
SYMATTR Value 100n
SYMBOL res -1024 640 R270
WINDOW 0 25 56 VTop 2
WINDOW 3 7 56 VBottom 2
SYMATTR InstName R7
SYMATTR Value 10k
SYMBOL source-V -1536 704 R0
WINDOW 3 -46 156 Left 2
WINDOW 123 0 0 Left 2
WINDOW 39 0 0 Left 2
SYMATTR Value SINE(0 1 25)
SYMATTR InstName V3
SYMBOL res -800 1152 R270
WINDOW 0 25 56 VTop 2
WINDOW 3 7 56 VBottom 2
SYMATTR InstName R8
SYMATTR Value 1k
SYMBOL cap -688 1168 R0
SYMATTR InstName C6
SYMATTR Value 100n
SYMBOL SBORKA\\COMPARATOR\\lm393 -512 1056 M180
WINDOW 38 7 29 Left 2
SYMATTR InstName U11
SYMBOL source-Vmarker -544 896 M0
SYMATTR Value V=10V
SYMATTR InstName U12
SYMBOL res -736 864 M90
WINDOW 0 7 56 VBottom 2
WINDOW 3 25 56 VTop 2
SYMATTR InstName R16
SYMATTR Value 100
SYMBOL res -736 768 M90
WINDOW 0 7 56 VBottom 2
WINDOW 3 25 56 VTop 2
SYMATTR InstName R17
SYMATTR Value 100
SYMBOL source-V -1536 928 R0
WINDOW 3 -46 156 Left 2
WINDOW 123 0 0 Left 2
WINDOW 39 0 0 Left 2
SYMATTR Value PULSE(0 4.5 0 50m 50m)
SYMATTR InstName V4
SYMBOL MDB_sym\\jumperRes -1424 624 R0
SYMATTR InstName U6
SYMBOL SBORKA\\OPamp\\TLV3501 -1168 1136 M0
WINDOW 3 11 8 Left 2
SYMATTR InstName U16
SYMBOL res -1216 1072 R270
WINDOW 0 25 56 VTop 2
WINDOW 3 7 56 VBottom 2
SYMATTR InstName R21
SYMATTR Value {R7}
SYMBOL cap -1040 1072 R270
WINDOW 0 32 32 VTop 2
WINDOW 3 0 32 VBottom 2
SYMATTR InstName C7
SYMATTR Value {C3}
SYMBOL source-Vmarker -1856 1312 R0
WINDOW 3 -61 -2 Center 2
SYMATTR Value V=2.5V
SYMATTR InstName U17
SYMBOL source-V -1616 1600 R0
WINDOW 3 36 62 Left 2
WINDOW 123 0 0 Left 2
WINDOW 39 0 0 Left 2
SYMATTR Value 5
SYMATTR InstName V2
SYMBOL EXTRA\\AudioOpamp\\TI\\OPA2613_TI -1024 1168 R0
WINDOW 3 -43 71 Left 2
SYMATTR InstName U18
SYMBOL source-V -2128 1600 R0
WINDOW 3 36 62 Left 2
WINDOW 123 0 0 Left 2
WINDOW 39 0 0 Left 2
SYMATTR Value {R6*1e-3}
SYMATTR InstName V5
SYMBOL res -1120 1312 R90
WINDOW 0 7 56 VBottom 2
WINDOW 3 25 56 VTop 2
SYMATTR InstName R22
SYMATTR Value {R6}
SYMBOL res -976 1312 R90
WINDOW 0 7 56 VBottom 2
WINDOW 3 25 56 VTop 2
SYMATTR InstName R23
SYMATTR Value {R5}
SYMBOL source-V -1808 1600 R0
WINDOW 3 36 62 Left 2
WINDOW 123 0 0 Left 2
WINDOW 39 0 0 Left 2
SYMATTR Value {R5/R6*Vrm}
SYMATTR InstName V6
SYMBOL source-V -1968 1600 R0
WINDOW 3 36 62 Left 2
WINDOW 123 0 0 Left 2
WINDOW 39 0 0 Left 2
SYMATTR Value {R5*1e-3}
SYMATTR InstName V7
SYMBOL source-V -2288 1600 R0
WINDOW 3 36 62 Left 2
WINDOW 123 0 0 Left 2
WINDOW 39 0 0 Left 2
SYMATTR Value {R7*1e-3}
SYMATTR InstName V8
SYMBOL EIT_Semiconductors\\op_3 -992 784 R0
WINDOW 123 -17 69 Invisible 2
WINDOW 3 -16 43 Invisible 2
WINDOW 0 -1 -24 Left 2
SYMATTR Value Vp=Vpop Vm=0 Ilim=20m
SYMATTR InstName U1
SYMBOL crtl-V-V 48 656 R0
SYMATTR InstName E1
SYMATTR Value 1
SYMBOL res -48 528 R0
SYMATTR InstName R1
SYMATTR Value 10k
SYMBOL SBORKA\\COMPARATOR\\lm393 -144 1168 M180
WINDOW 0 15 -24 Left 2
WINDOW 38 15 -53 Left 2
SYMATTR InstName U2
SYMBOL res -336 1200 M90
WINDOW 0 7 56 VBottom 2
WINDOW 3 25 56 VTop 2
SYMATTR InstName R2
SYMATTR Value 100
SYMBOL res -336 1104 M90
WINDOW 0 7 56 VBottom 2
WINDOW 3 25 56 VTop 2
SYMATTR InstName R3
SYMATTR Value 100
SYMBOL EIT_Semiconductors\\pnp 32 1040 R180
SYMATTR InstName Q1
SYMATTR Value BC327-40
SYMBOL res -48 1056 R0
SYMATTR InstName R10
SYMATTR Value 820
SYMBOL EIT_Semiconductors\\pnp 64 1040 M180
SYMATTR InstName Q2
SYMATTR Value BC327-40
SYMBOL res 112 1136 R0
SYMATTR InstName R13
SYMATTR Value 1.5k
SYMBOL source-I -32 1376 R180
WINDOW 0 29 73 Left 2
WINDOW 3 29 17 Left 2
WINDOW 123 0 0 Left 2
WINDOW 39 0 0 Left 2
SYMATTR InstName I1
SYMATTR Value PULSE(0 2m 10m)
SYMBOL EXTRA\\AudioOpamp\\TI\\OPA2613_TI -544 832 M180
WINDOW 3 -43 71 Left 2
SYMATTR InstName U3
SYMBOL SBORKA\\COMPARATOR\\lm393 -624 1584 M180
WINDOW 0 15 -24 Left 2
WINDOW 38 15 -53 Left 2
SYMATTR InstName U4
SYMBOL res -816 1616 M90
WINDOW 0 7 56 VBottom 2
WINDOW 3 25 56 VTop 2
SYMATTR InstName R9
SYMATTR Value 100
SYMBOL res -816 1520 M90
WINDOW 0 7 56 VBottom 2
WINDOW 3 25 56 VTop 2
SYMATTR InstName R11
SYMATTR Value 100
SYMBOL res -528 1472 R0
SYMATTR InstName R12
SYMATTR Value 10k
SYMBOL source-V -880 1680 R0
WINDOW 3 -46 156 Left 2
WINDOW 123 0 0 Left 2
WINDOW 39 0 0 Left 2
SYMATTR Value SINE({Vrm} 2 {fan})
SYMATTR InstName V1
SYMBOL bv -1456 1584 R0
SYMATTR InstName B1
SYMATTR Value V=V(vtri)+V(Vrm)
SYMBOL bv -1456 1776 R0
SYMATTR InstName B2
SYMATTR Value V=-(V(vtri)-V(Vrm))
SYMBOL source-V -1616 1808 R0
WINDOW 3 36 62 Left 2
WINDOW 123 0 0 Left 2
WINDOW 39 0 0 Left 2
SYMATTR Value {Vrm}
SYMATTR InstName V9
TEXT -1296 568 Left 2 ;Error Amplifier
TEXT -1304 1384 Left 2 ;Triangle wave gen
TEXT -792 952 Left 2 ;Comparator
TEXT -1280 448 Left 2 ;.meas TRAN peri \n+ trig V(pwm)=2V rise=10\n+ targ V(pwm)=3V fall=10
TEXT -2288 840 Left 2 !; Vtri = R5/R6*Vrm\n; --------------------------\n; In this equation, Vrm is the comparator output voltage \n; above or below the reference voltage. For example, in\n; our system the comparator output will be either 5V or \n; 0V. Because this circuit employs a 2.5V reference, V1 \n; is equal to 2.5V\n.param Vrm = 2.5V\n \n.param R6 = 10k    ; oder größer\n.param Vtri = 2.1V   \n.param R5 = {(Vtri*R6)/Vrm}\n; --------------------------\n; somit kann bei AnalogIn=[-2...2V] niemals \n; p=100%  erreicht werden!!\n \n; PWM frequenz festlegen\n; --------------------------\n.param C3 = 100n\n.param ft = 500\n.param R7 = {R6/ ( ft*4*R5*C3 )}
TEXT -2296 752 Left 2 !.tran {1/fan} uic
TEXT -2296 776 Left 2 !.options plotwinsize = 0
TEXT -1888 752 Left 2 !.param Vpop = 5V\n.param fan = 20
TEXT -2352 1752 Left 2 !.model mysw SW(Ron=1m Roff=100Meg Vt=0 Vh=-.5 )
TEXT -784 1336 Left 2 ;.step param Roc 5k 25k 5k
TEXT -392 1288 Left 2 ;Comparator
RECTANGLE Normal -896 960 -1312 544 2
RECTANGLE Normal -896 1408 -1312 1008 2
RECTANGLE Normal -200 976 -800 720 2
RECTANGLE Normal -1664 1472 -2320 720 2
