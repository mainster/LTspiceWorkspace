Version 4
SHEET 1 6832 5392
WIRE 736 304 544 304
WIRE 1040 304 736 304
WIRE 1216 304 1040 304
WIRE 1216 336 1216 304
WIRE -1136 352 -1264 352
WIRE -672 352 -1136 352
WIRE -256 352 -672 352
WIRE 272 368 272 352
WIRE -112 400 -160 400
WIRE -32 400 -112 400
WIRE 80 416 32 416
WIRE 112 416 80 416
WIRE 208 416 192 416
WIRE -32 432 -64 432
WIRE 1216 448 1216 416
WIRE -288 464 -304 464
WIRE -160 464 -160 400
WIRE -160 464 -208 464
WIRE 80 480 80 416
WIRE 1104 480 1072 480
WIRE 0 496 0 448
WIRE 800 496 672 496
WIRE 816 496 800 496
WIRE -256 512 -256 352
WIRE -432 528 -464 528
WIRE -304 528 -304 464
WIRE -304 528 -352 528
WIRE -288 528 -304 528
WIRE 272 528 272 464
WIRE 288 528 272 528
WIRE 384 528 368 528
WIRE 1040 528 1040 304
WIRE -160 544 -160 464
WIRE -160 544 -224 544
WIRE 736 544 736 304
WIRE 896 544 848 544
WIRE 992 544 992 480
WIRE 992 544 976 544
WIRE 1008 544 992 544
WIRE -288 560 -304 560
WIRE 384 560 272 560
WIRE 544 560 544 304
WIRE 544 560 512 560
WIRE 672 560 672 496
WIRE 704 560 672 560
WIRE 1104 560 1104 480
WIRE 1104 560 1072 560
WIRE 1136 560 1104 560
WIRE 1200 560 1136 560
WIRE 1232 560 1200 560
WIRE 1344 560 1312 560
WIRE 1392 560 1344 560
WIRE -704 576 -720 576
WIRE -608 576 -624 576
WIRE 816 576 816 496
WIRE 816 576 768 576
WIRE 896 576 816 576
WIRE 992 576 976 576
WIRE 1008 576 992 576
WIRE -256 592 -256 576
WIRE -64 592 -64 432
WIRE 80 592 80 544
WIRE 80 592 -64 592
WIRE 176 592 80 592
WIRE 384 592 176 592
WIRE 544 592 512 592
WIRE 608 592 544 592
WIRE 704 592 608 592
WIRE -64 608 -64 592
WIRE 1344 608 1344 560
WIRE -672 624 -672 352
WIRE 384 624 288 624
WIRE 992 624 992 576
WIRE 1040 624 1040 592
WIRE 1344 624 1344 608
WIRE -720 640 -720 576
WIRE -704 640 -720 640
WIRE 736 640 736 608
WIRE 848 640 848 544
WIRE -608 656 -608 576
WIRE -608 656 -640 656
WIRE -528 656 -608 656
WIRE -432 656 -528 656
WIRE -304 656 -304 560
WIRE -304 656 -352 656
WIRE 544 656 544 592
WIRE 1136 656 1136 560
WIRE -880 672 -912 672
WIRE -768 672 -800 672
WIRE -704 672 -768 672
WIRE -1264 704 -1264 352
WIRE -992 704 -992 672
WIRE -768 704 -768 672
WIRE -64 704 -64 688
WIRE -432 752 -528 752
WIRE -304 752 -304 656
WIRE -304 752 -352 752
WIRE 848 752 848 720
WIRE -192 768 -192 720
WIRE 544 800 544 736
WIRE -1264 816 -1264 784
WIRE -768 816 -768 784
WIRE -528 864 -528 752
WIRE -192 880 -192 848
WIRE -528 976 -528 944
WIRE -128 1008 -208 1008
WIRE -208 1040 -208 1008
WIRE -208 1152 -208 1120
FLAG -208 1152 0
FLAG -1264 816 0
FLAG 544 800 0
FLAG 0 384 0
FLAG -64 704 0
FLAG 272 560 0
FLAG 1216 448 0
FLAG 736 640 0
FLAG -208 1008 V_Sensor
FLAG -768 816 0
FLAG -672 688 0
FLAG -256 592 0
FLAG -464 528 0
FLAG -528 976 0
FLAG 1040 624 0
FLAG 848 752 0
FLAG 992 704 0
FLAG 1136 736 0
FLAG -192 880 0
FLAG 0 496 12V
FLAG -192 720 5V
FLAG 288 624 12V
FLAG 1344 672 0
FLAG 272 352 5V
FLAG -1136 352 12V
FLAG -528 656 imp1
FLAG -112 400 add
FLAG 176 592 ctrl1
FLAG 608 592 A2
FLAG 800 496 imp2
FLAG 1392 560 VADC
FLAG 1200 560 diff
FLAG -128 1088 0
FLAG -992 784 0
FLAG -768 672 in
FLAG 0 0 in
SYMBOL res 528 640 R0
SYMATTR InstName R4
SYMATTR Value 33k
SYMBOL voltage -1264 688 R0
WINDOW 123 0 0 Left 2
WINDOW 39 24 124 Left 2
WINDOW 3 -91 270 Left 2
SYMATTR SpiceLine Rser=1m
SYMATTR Value PWL(1n 12 14m 7 18m 14 23m 12)
SYMATTR InstName V5
SYMBOL voltage -208 1024 R0
WINDOW 123 24 44 Left 2
WINDOW 39 24 72 Left 2
WINDOW 3 -104 160 Left 2
SYMATTR Value PULSE(1m 5 0 10m 10m 10n 0 100)
SYMATTR InstName V6
SYMBOL res -80 592 R0
SYMATTR InstName R5
SYMATTR Value 33k
SYMBOL res 208 400 R90
WINDOW 0 0 56 VBottom 2
WINDOW 3 32 56 VTop 2
SYMATTR InstName R6
SYMATTR Value 100
SYMBOL voltage 1216 320 R0
WINDOW 123 0 0 Left 2
WINDOW 39 24 124 Left 2
SYMATTR SpiceLine Rser=10m
SYMATTR InstName V7
SYMATTR Value 5v
SYMBOL Opamps\\opamp2 736 512 R0
WINDOW 38 14 99 Left 2
SYMATTR SpiceModel OPA2340
SYMATTR InstName U5
SYMATTR Value ""
SYMBOL res -784 656 R90
WINDOW 0 0 56 VBottom 2
WINDOW 3 32 56 VTop 2
SYMATTR InstName R8
SYMATTR Value 1
SYMBOL res -192 448 R90
WINDOW 0 0 56 VBottom 2
WINDOW 3 32 56 VTop 2
SYMATTR InstName R10
SYMATTR Value 100k
SYMBOL res -336 512 R90
WINDOW 0 0 56 VBottom 2
WINDOW 3 32 56 VTop 2
SYMATTR InstName R11
SYMATTR Value 100k
SYMBOL res -336 640 R90
WINDOW 0 0 56 VBottom 2
WINDOW 3 32 56 VTop 2
SYMATTR InstName R12
SYMATTR Value 100k
SYMBOL res -336 736 R90
WINDOW 0 0 56 VBottom 2
WINDOW 3 32 56 VTop 2
SYMATTR InstName R13
SYMATTR Value 100k
SYMBOL voltage -528 848 R0
WINDOW 123 0 0 Left 2
WINDOW 39 24 124 Left 2
SYMATTR SpiceLine Rser=1m
SYMATTR InstName V8
SYMATTR Value PULSE(0 1.25 0 100u)
SYMBOL Opamps\\opamp2 1040 496 R0
WINDOW 38 29 92 Left 2
SYMATTR SpiceModel OPA2340
SYMATTR InstName U9
SYMATTR Value ""
SYMBOL res 976 496 R270
WINDOW 0 32 56 VTop 2
WINDOW 3 0 56 VBottom 2
SYMATTR InstName R15
SYMATTR Value 10k
SYMBOL res 880 560 R270
WINDOW 0 32 56 VTop 2
WINDOW 3 85 45 VBottom 2
SYMATTR InstName R16
SYMATTR Value 10k
SYMBOL res 880 592 R270
WINDOW 0 -47 49 VTop 2
WINDOW 3 0 56 VBottom 2
SYMATTR InstName R17
SYMATTR Value 10k
SYMBOL res 976 608 R0
SYMATTR InstName R18
SYMATTR Value 10k
SYMBOL voltage 848 624 R0
WINDOW 123 0 0 Left 2
WINDOW 39 24 124 Left 2
SYMATTR SpiceLine Rser=10m
SYMATTR InstName V9
SYMATTR Value 1.2
SYMBOL IL300 448 576 R0
SYMATTR InstName U10
SYMBOL res 1120 640 R0
SYMATTR InstName R20
SYMATTR Value 10k
SYMBOL Opamps\\opamp2 0 480 M180
WINDOW 38 19 98 Left 2
SYMATTR SpiceModel LM358
SYMATTR InstName U1
SYMATTR Value ""
SYMBOL voltage -192 752 R0
WINDOW 123 0 0 Left 2
WINDOW 39 0 0 Left 2
WINDOW 3 54 52 Left 2
SYMATTR Value 5V
SYMATTR InstName V1
SYMBOL cap 64 480 R0
SYMATTR InstName C1
SYMATTR Value 100p
SYMBOL Opamps\\opamp2 -256 480 R0
WINDOW 38 29 92 Left 2
SYMATTR SpiceModel LM358
SYMATTR InstName U2
SYMATTR Value ""
SYMBOL Opamps\\opamp2 -672 592 R0
WINDOW 38 29 92 Left 2
SYMATTR SpiceModel LM358
SYMATTR InstName U3
SYMATTR Value ""
SYMBOL res 1328 544 R90
WINDOW 0 0 56 VBottom 2
WINDOW 3 32 56 VTop 2
SYMATTR InstName R1
SYMATTR Value 1k
SYMBOL cap 1328 608 R0
SYMATTR InstName C2
SYMATTR Value 10n
SYMBOL npn 208 368 R0
SYMATTR InstName Q1
SYMATTR Value BC547B
SYMBOL res 272 544 R270
WINDOW 0 32 56 VTop 2
WINDOW 3 0 56 VBottom 2
SYMATTR InstName R2
SYMATTR Value 100
SYMBOL res -608 560 R90
WINDOW 0 0 56 VBottom 2
WINDOW 3 32 56 VTop 2
SYMATTR InstName R3
SYMATTR Value 1
SYMBOL res -752 800 R180
WINDOW 0 36 76 Left 2
WINDOW 3 36 40 Left 2
SYMATTR InstName R7
SYMATTR Value 7.5k
SYMBOL res -896 656 R90
WINDOW 0 0 56 VBottom 2
WINDOW 3 32 56 VTop 2
SYMATTR InstName R9
SYMATTR Value 1
SYMBOL res -144 992 R0
SYMATTR InstName R14
SYMATTR Value 100
SYMBOL current -992 784 R180
WINDOW 0 24 80 Left 2
WINDOW 3 -182 -73 Left 2
WINDOW 123 0 0 Left 2
WINDOW 39 0 0 Left 2
SYMATTR InstName I1
SYMATTR Value PULSE(1n 535u 0 10m 10m 10n 0 100)
TEXT -1176 888 Left 2 ;PULSE(0 5 0 10m 10m 10n 0 100)
TEXT -336 264 Left 2 !.tran 20m startup
TEXT -336 176 Left 2 !.include opa2340.mod\n.include LM358.mod
