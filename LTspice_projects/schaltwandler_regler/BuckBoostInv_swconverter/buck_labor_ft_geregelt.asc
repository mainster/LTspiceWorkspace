Version 4
SHEET 1 880 852
WIRE -400 -832 -416 -832
WIRE -368 -832 -400 -832
WIRE -144 -832 -288 -832
WIRE -48 -832 -64 -832
WIRE 16 -832 -48 -832
WIRE 48 -832 16 -832
WIRE -288 -816 -288 -832
WIRE -368 -800 -368 -832
WIRE -48 -800 -48 -832
WIRE -368 -720 -368 -752
WIRE -48 -704 -48 -736
WIRE -880 -400 -992 -400
WIRE -816 -400 -880 -400
WIRE -704 -400 -816 -400
WIRE -480 -400 -704 -400
WIRE -992 -352 -992 -400
WIRE -816 -352 -816 -400
WIRE -880 -320 -880 -400
WIRE -704 -272 -704 -400
WIRE -992 -240 -992 -272
WIRE -816 -224 -816 -272
WIRE -768 -224 -816 -224
WIRE -1088 -192 -1216 -192
WIRE -1216 -176 -1216 -192
WIRE -480 -160 -480 -400
WIRE -880 -144 -880 -256
WIRE -816 -144 -816 -224
WIRE -816 -144 -880 -144
WIRE -704 -144 -704 -176
WIRE -656 -144 -704 -144
WIRE -560 -144 -576 -144
WIRE -528 -144 -560 -144
WIRE -1408 -112 -1408 -128
WIRE -1328 -112 -1328 -128
WIRE -704 -112 -704 -144
WIRE -1984 -80 -2016 -80
WIRE -1920 -80 -1984 -80
WIRE -1808 -80 -1840 -80
WIRE -1792 -80 -1808 -80
WIRE -1664 -80 -1712 -80
WIRE -1568 -80 -1584 -80
WIRE -1504 -80 -1568 -80
WIRE -1216 -80 -1216 -96
WIRE -1088 -80 -1088 -192
WIRE -1568 -64 -1568 -80
WIRE -816 -64 -816 -144
WIRE -768 -64 -816 -64
WIRE -336 -64 -480 -64
WIRE -288 -64 -336 -64
WIRE -240 -64 -288 -64
WIRE -144 -64 -240 -64
WIRE -112 -64 -144 -64
WIRE 16 -64 -32 -64
WIRE 48 -64 16 -64
WIRE 160 -64 48 -64
WIRE 272 -64 160 -64
WIRE -1504 -48 -1504 -80
WIRE 48 -48 48 -64
WIRE -816 -32 -816 -64
WIRE -1408 0 -1408 -32
WIRE -1376 0 -1408 0
WIRE -1328 0 -1328 -32
WIRE -1328 0 -1376 0
WIRE -1264 0 -1328 0
WIRE -1808 16 -1808 -80
WIRE -1728 16 -1808 16
WIRE -1152 16 -1200 16
WIRE -1088 16 -1088 0
WIRE -1088 16 -1152 16
WIRE -928 16 -1088 16
WIRE -880 16 -928 16
WIRE 160 16 160 -64
WIRE -1568 32 -1568 16
WIRE -1568 32 -1664 32
WIRE -1504 32 -1504 16
WIRE -1504 32 -1568 32
WIRE -1376 32 -1504 32
WIRE -1280 32 -1296 32
WIRE -1264 32 -1280 32
WIRE -1088 32 -1088 16
WIRE -704 32 -704 -16
WIRE -288 32 -288 -64
WIRE -240 32 -240 -64
WIRE -144 32 -144 -64
WIRE 272 32 272 -64
WIRE -1728 48 -1808 48
WIRE 48 48 48 32
WIRE 48 64 48 48
WIRE -1808 80 -1808 48
WIRE -816 80 -816 64
WIRE -1280 112 -1280 32
WIRE -1264 112 -1280 112
WIRE -1152 112 -1152 16
WIRE -1152 112 -1184 112
WIRE -1088 144 -1088 112
WIRE -288 144 -288 96
WIRE -240 144 -240 112
WIRE -144 144 -144 96
WIRE 48 144 48 128
WIRE 272 144 272 112
WIRE -1808 176 -1808 160
WIRE -816 176 -816 160
WIRE 160 192 160 96
WIRE 48 208 0 208
WIRE 96 208 48 208
WIRE 96 272 96 256
WIRE 0 304 0 288
WIRE 160 304 160 272
WIRE -1024 368 -1088 368
WIRE -912 368 -1024 368
WIRE -1088 464 -1088 368
WIRE -1088 576 -1088 544
WIRE -736 576 -784 576
WIRE -688 576 -736 576
WIRE -528 576 -608 576
WIRE -480 576 -528 576
WIRE -608 592 -608 576
WIRE -688 608 -688 576
WIRE -688 688 -688 656
WIRE -608 688 -608 672
FLAG -288 144 0
FLAG -992 -240 0
FLAG -336 -64 sw_buck
FLAG 16 -64 out_buck
FLAG 272 144 0
FLAG 48 144 0
FLAG 48 48 ca
FLAG -240 144 0
FLAG -144 144 0
FLAG 160 304 0
FLAG 0 304 0
FLAG 96 272 0
FLAG -368 -720 0
FLAG -400 -832 out_buck
FLAG -288 -736 0
FLAG -48 -704 0
FLAG 16 -832 out_buck_fil
FLAG -688 688 0
FLAG -608 688 0
FLAG -528 576 As
FLAG 48 208 sw_load
FLAG -736 576 sw_load
FLAG -1232 48 0
FLAG -1328 -128 0
FLAG -1088 144 0
FLAG -1216 -80 0
FLAG -1808 176 0
FLAG -704 32 0
FLAG -816 176 0
FLAG -928 16 Vst
FLAG -880 -400 E
FLAG -560 -144 G
FLAG -1984 -80 out_buck
FLAG -1088 576 0
FLAG -1408 -128 0
FLAG -1024 368 saw
FLAG -1376 0 saw
SYMBOL ind -128 -48 R270
WINDOW 0 30 56 VTop 0
WINDOW 3 6 56 VBottom 0
SYMATTR InstName L1
SYMATTR Value {L1}
SYMBOL schottky -272 96 R180
WINDOW 0 24 64 Left 0
WINDOW 3 24 0 Left 0
SYMATTR InstName D1
SYMATTR Value Dx
SYMATTR Description Diode
SYMATTR Type diode
SYMBOL cap 32 64 R0
SYMATTR InstName CA1
SYMATTR Value {CA}
SYMBOL res 32 -64 R0
SYMATTR InstName Rs1
SYMATTR Value {Rs}
SYMBOL res -256 16 R0
SYMATTR InstName Rpar1
SYMATTR Value 20k
SYMBOL cap -160 32 R0
SYMATTR InstName Cpar1
SYMATTR Value 400p
SYMBOL res 144 0 R0
SYMATTR InstName RL1
SYMATTR Value {RL}
SYMBOL source-V -992 -368 R0
WINDOW 123 0 0 Left 0
WINDOW 39 -46 16 VRight 0
SYMATTR SpiceLine Rser=1m
SYMATTR InstName V1
SYMATTR Value 20
SYMBOL source-I 272 112 M180
WINDOW 0 29 73 Left 0
WINDOW 3 29 17 Left 0
WINDOW 123 0 0 Left 0
WINDOW 39 0 0 Left 0
SYMATTR InstName I1
SYMATTR Value {IL}
SYMBOL crtl-V-S 160 176 R0
SYMATTR InstName S2
SYMBOL source-V 0 192 R0
WINDOW 0 35 57 Left 0
WINDOW 3 -148 158 Left 0
WINDOW 123 0 0 Left 0
WINDOW 39 0 0 Left 0
SYMATTR InstName V3
SYMATTR Value PULSE(0 1 3m {trf} {trf} 3m)
SYMBOL crtl-V-V -288 -832 R0
SYMATTR InstName E1
SYMATTR Value 1
SYMBOL res -48 -848 R90
WINDOW 0 7 56 VBottom 0
WINDOW 3 25 56 VTop 0
SYMATTR InstName R1
SYMATTR Value 330
SYMBOL cap -64 -800 R0
SYMATTR InstName C1
SYMATTR Value 100n
SYMBOL crtl-V-V -608 576 R0
WINDOW 3 -302 152 Left 0
SYMATTR Value Laplace=(1+s*Rs*CA)/(1+s*(Rs*Ca+L1/RL)+s**2*L1*CA*(1+Rs/RL))
SYMATTR InstName E2
SYMBOL res -1168 96 R90
WINDOW 0 7 56 VBottom 0
WINDOW 3 25 56 VTop 0
SYMATTR InstName R2
SYMATTR Value 100k
SYMBOL res -1280 16 R90
WINDOW 0 7 56 VBottom 0
WINDOW 3 25 56 VTop 0
SYMATTR InstName R3
SYMATTR Value 10k
SYMBOL EIT_Semiconductors\\comp_oc -1232 16 R0
SYMATTR InstName U1
SYMBOL res -1104 -96 R0
SYMATTR InstName R4
SYMATTR Value 9.5k
SYMBOL res -1104 16 R0
SYMATTR InstName R5
SYMATTR Value 2.5k
SYMBOL source-V -1216 -192 R0
WINDOW 123 0 0 Left 0
WINDOW 39 28 109 Left 0
SYMATTR InstName V5
SYMATTR Value 12
SYMBOL EIT_Semiconductors\\op_3 -1696 32 R0
SYMATTR InstName U2
SYMATTR Value Vp=10 Vm=0 Ilim=20m
SYMBOL res -1568 -96 R90
WINDOW 0 7 56 VBottom 0
WINDOW 3 25 56 VTop 0
SYMATTR InstName R6
SYMATTR Value 470
SYMBOL res -1696 -96 R90
WINDOW 0 7 56 VBottom 0
WINDOW 3 25 56 VTop 0
SYMATTR InstName Rstell
SYMATTR Value 10k
SYMBOL res -1824 -96 R90
WINDOW 0 7 56 VBottom 0
WINDOW 3 25 56 VTop 0
SYMATTR InstName R7
SYMATTR Value 2.2k
SYMBOL source-V -1808 64 R0
WINDOW 123 0 0 Left 0
WINDOW 39 28 109 Left 0
SYMATTR InstName V6
SYMATTR Value {Vref}
SYMBOL cap -1520 -48 R0
SYMATTR InstName C2
SYMATTR Value 47n
SYMBOL res -1584 -80 R0
SYMATTR InstName R8
SYMATTR Value 1µ
SYMBOL EIT_Semiconductors\\npn -768 -272 R0
SYMATTR InstName Q1
SYMBOL EIT_Semiconductors\\pnp -768 -16 M180
SYMATTR InstName Q2
SYMBOL res -560 -160 R90
WINDOW 0 7 56 VBottom 0
WINDOW 3 25 56 VTop 0
SYMATTR InstName RGate
SYMATTR Value 20
SYMBOL res -832 -368 R0
SYMATTR InstName R9
SYMATTR Value 5.6k
SYMBOL zener -864 -256 R180
WINDOW 0 24 72 Left 0
WINDOW 3 41 -101 VRight 0
SYMATTR InstName D2
SYMATTR Value BZX84C15L
SYMBOL EIT_Semiconductors\\npn -880 -32 R0
SYMATTR InstName Q3
SYMBOL res -832 64 R0
SYMATTR InstName R10
SYMATTR Value 470
SYMBOL EIT_Semiconductors\\pmos_2o -528 -160 R0
SYMATTR InstName M1
SYMBOL res -1392 -128 M0
SYMATTR InstName R11
SYMATTR Value 1k
SYMBOL source-V -1088 448 R0
WINDOW 0 28 81 Left 0
WINDOW 3 -405 -16 Left 0
WINDOW 123 0 0 Left 0
WINDOW 39 0 0 Left 0
SYMATTR InstName V2
SYMATTR Value PULSE(4 8 0 30u 3.3u 1p 33.3u)
TEXT -832 -536 Left 0 !.model sw  vswitch {Roff=1T Ron=1m Von=0.7 Voff=0.3 vh=-0.5}
TEXT -840 -832 Left 0 !.param fsw={1/33.3u}\n.param RL=10\n.param trf=100n\n.param Rs=200m\n.param L1=100u\n.param CA=100u\n.param p=0.25\n.param IL=1\n.param N=4
TEXT -1184 -528 Left 0 !;.tran 0 20m {20m-N*33.3u}\n.tran 0 5m 0 1u\n;ac oct 100 1 1meg
TEXT -240 -480 Left 0 ;.step param Rs list 100m 1m 500u
TEXT -832 -504 Left 0 !.model Dx D {Ron=1m Roff=1T Vfwd=0.4}
TEXT -240 -456 Left 0 ;.step param Rs list 1p 200m
TEXT -240 -432 Left 0 ;.step param RL list 1T 10
TEXT -1800 -168 Left 0 !.param Vref=6
