Version 4
SHEET 1 1236 1376
WIRE -736 -1152 -752 -1152
WIRE -704 -1152 -736 -1152
WIRE -576 -1152 -624 -1152
WIRE -528 -1152 -576 -1152
WIRE -512 -1152 -528 -1152
WIRE -368 -1152 -432 -1152
WIRE -304 -1152 -368 -1152
WIRE -256 -1152 -304 -1152
WIRE -160 -1152 -256 -1152
WIRE -256 -1136 -256 -1152
WIRE -160 -1136 -160 -1152
WIRE -368 -1104 -368 -1152
WIRE -576 -1088 -576 -1152
WIRE -640 -1072 -640 -1088
WIRE -256 -1072 -256 -1088
WIRE -160 -1072 -160 -1088
WIRE -688 -1056 -688 -1088
WIRE -688 -960 -688 -976
WIRE -576 -960 -576 -1024
WIRE -368 -960 -368 -1040
WIRE -256 -960 -256 -992
WIRE -160 -960 -160 -992
WIRE -400 -416 -512 -416
WIRE -304 -416 -400 -416
WIRE -512 -400 -512 -416
WIRE -304 -384 -304 -416
WIRE -400 -368 -448 -368
WIRE -368 -368 -400 -368
WIRE 256 -352 240 -352
WIRE 272 -352 256 -352
WIRE 240 -336 240 -352
WIRE -368 -320 -384 -320
WIRE -512 -304 -512 -320
WIRE -384 -288 -384 -320
WIRE -304 -272 -304 -304
WIRE -304 -272 -336 -272
WIRE -256 -272 -304 -272
WIRE -224 -272 -256 -272
WIRE -96 -272 -144 -272
WIRE -32 -272 -96 -272
WIRE 0 -272 -32 -272
WIRE 160 -272 144 -272
WIRE 176 -272 160 -272
WIRE -96 -256 -96 -272
WIRE 0 -256 0 -272
WIRE 144 -256 144 -272
WIRE -448 -240 -448 -368
WIRE -304 -240 -304 -272
WIRE 240 -240 240 -256
WIRE -304 -160 -304 -176
WIRE 144 -160 144 -176
WIRE -448 -144 -448 -160
WIRE -96 -128 -96 -192
WIRE 0 -128 0 -176
WIRE 80 -16 32 -16
WIRE 32 0 32 -16
WIRE 32 16 32 0
WIRE -176 32 -208 32
WIRE -160 32 -176 32
WIRE 32 96 32 80
WIRE -336 112 -352 112
WIRE -240 112 -256 112
WIRE -128 112 -160 112
WIRE -80 288 -160 288
WIRE -48 288 -80 288
WIRE -560 304 -560 272
WIRE -544 304 -560 304
WIRE -512 304 -544 304
WIRE -384 304 -432 304
WIRE -320 304 -384 304
WIRE -288 304 -320 304
WIRE -384 320 -384 304
WIRE -288 320 -288 304
WIRE -160 320 -160 288
WIRE -560 336 -560 304
WIRE 32 336 32 320
WIRE -560 416 -560 400
WIRE -384 416 -384 384
WIRE -288 416 -288 400
WIRE -160 416 -160 400
FLAG -96 -128 0
FLAG 0 -128 0
FLAG -304 -160 0
FLAG -512 -304 0
FLAG -448 -144 0
FLAG -384 -288 0
FLAG -256 -272 s
FLAG -32 -272 a
FLAG -400 -416 e
FLAG -400 -368 crtl
FLAG 32 96 0
FLAG -384 416 0
FLAG -288 416 0
FLAG -560 416 0
FLAG -544 304 sc
FLAG -320 304 outc
FLAG -160 416 0
FLAG -80 288 Vd2_open
FLAG 32 256 0
FLAG 32 416 0
FLAG 144 -160 0
FLAG 160 -272 Vr
FLAG 240 -240 0
FLAG 256 -352 p
FLAG -176 32 gnd2
FLAG -128 112 0
FLAG -352 112 0
FLAG -368 -960 0
FLAG -256 -960 0
FLAG -576 -960 0
FLAG -528 -1152 s1
FLAG -304 -1152 a1
FLAG -160 -960 0
FLAG -640 -1072 0
FLAG -688 -960 0
FLAG -736 -1152 e
SYMBOL ind -240 -256 R270
WINDOW 0 30 56 VTop 2
WINDOW 3 6 56 VBottom 2
SYMATTR InstName L1
SYMATTR Value {L}
SYMBOL cap -112 -256 R0
WINDOW 3 -61 136 Left 2
SYMATTR Value {Ca}
SYMATTR InstName C1
SYMBOL res -16 -272 R0
SYMATTR InstName R1
SYMATTR Value {RL}
SYMBOL diode -288 -176 R180
WINDOW 0 -44 35 Left 2
WINDOW 3 -56 4 Left 2
SYMATTR InstName D1
SYMATTR Value my_d
SYMBOL crtl-V-S -304 -400 R0
SYMATTR InstName S1
SYMATTR Value my_sw
SYMBOL source-V -512 -416 R0
SYMATTR InstName V1
SYMATTR Value {Ve}
SYMBOL source-V -448 -256 R0
WINDOW 3 -114 152 Left 2
WINDOW 123 0 0 Left 2
WINDOW 39 0 0 Left 2
SYMATTR Value PULSE(0 2.5 1u 1p 1p {p*T} {T})
SYMATTR InstName V2
SYMBOL source-V 32 -16 R0
WINDOW 123 0 0 Left 2
WINDOW 39 0 0 Left 2
WINDOW 3 -87 148 Left 2
SYMATTR Value SINE(0 1 .1meg)
SYMATTR InstName V3
SYMBOL ind -528 320 R270
WINDOW 0 30 56 VTop 2
WINDOW 3 6 56 VBottom 2
SYMATTR InstName L2
SYMATTR Value 50µ
SYMBOL cap -400 320 R0
WINDOW 3 -63 67 Left 2
SYMATTR Value {ca}
SYMATTR InstName C2
SYMBOL res -304 304 R0
SYMATTR InstName R2
SYMATTR Value 10k
SYMBOL diode -544 400 R180
WINDOW 0 -44 35 Left 2
WINDOW 3 -56 4 Left 2
SYMATTR InstName D2
SYMATTR Value my_d
SYMBOL bv -160 304 R0
WINDOW 3 -11 173 Left 2
SYMATTR Value V=1
SYMATTR InstName B1
SYMBOL diode 48 320 R180
WINDOW 0 -44 35 Left 2
WINDOW 3 -56 4 Left 2
SYMATTR InstName D3
SYMATTR Value my_d2
SYMBOL MDB_sym\\source-I 32 336 R0
WINDOW 123 0 0 Left 2
WINDOW 39 0 0 Left 2
SYMATTR InstName I1
SYMATTR Value 0
SYMBOL bv 144 -272 R0
WINDOW 3 -47 147 Left 2
WINDOW 0 24 91 Left 2
SYMATTR Value V=1
SYMATTR InstName B2
SYMBOL bv 240 -352 R0
WINDOW 3 -47 147 Left 2
WINDOW 0 24 91 Left 2
SYMATTR Value V={p}
SYMATTR InstName B3
SYMBOL MDB_sym\\source-Vmarker -208 32 R0
SYMATTR Value V=1u
SYMATTR InstName U1
SYMBOL MDB_sym\\source-I -240 112 R270
WINDOW 0 27 40 VTop 2
WINDOW 3 -27 40 VBottom 2
WINDOW 123 0 0 Left 2
WINDOW 39 0 0 Left 2
SYMATTR InstName I2
SYMATTR Value 1µ
SYMBOL res -240 96 R90
WINDOW 0 7 56 VBottom 2
WINDOW 3 25 56 VTop 2
SYMATTR InstName R3
SYMATTR Value 1
SYMBOL ind -528 -1136 R270
WINDOW 0 30 56 VTop 2
WINDOW 3 6 56 VBottom 2
SYMATTR InstName L3
SYMATTR Value {L1}
SYMBOL cap -384 -1104 R0
WINDOW 3 22 59 Left 2
SYMATTR Value {Ca}
SYMATTR InstName C3
SYMBOL res -240 -1088 M0
WINDOW 0 -27 34 Left 2
WINDOW 3 -52 63 Left 2
SYMATTR InstName R4
SYMATTR Value {RL}
SYMBOL diode -560 -1024 R180
WINDOW 0 -37 34 Left 2
WINDOW 3 -36 12 Left 2
SYMATTR InstName D4
SYMATTR Value Dx
SYMBOL MDB_sym\\source-I -160 -992 M180
WINDOW 123 0 0 Left 2
WINDOW 39 0 0 Left 2
SYMATTR InstName I3
SYMATTR Value {Ia}
SYMBOL MDB_sym\\jumper -96 -1104 R90
SYMATTR InstName X1
SYMBOL MDB_sym\\jumper -176 -1104 R90
SYMATTR InstName X3
SYMBOL crtl-V-S -720 -1152 R270
WINDOW 0 -22 81 VRight 2
WINDOW 3 27 35 VRight 2
SYMATTR InstName S2
SYMATTR Value SWx
SYMBOL source-V -688 -1072 R0
WINDOW 3 -70 147 Left 2
WINDOW 123 0 0 Left 2
WINDOW 39 0 0 Left 2
WINDOW 0 -32 16 Left 2
SYMATTR Value PULSE(0 2.5 1u 1p 1p {p*T} {T})
SYMATTR InstName V4
TEXT -520 -640 Left 2 !.model my_sw SW(Ron=1m Roff=1T Vt=1.25 Vh=-0.5)\n.model swx SW(Ron=1m Roff=1T Vt=1.25 Vh=-0.5)\n.model my_D D(Ron=1m Roff=1T Vfwd={Vd0})\n.model Dx D(Ron=1m Roff=1T Vfwd={Vd0})\n.model my_D2 D (Is={Isd2} N={n})
TEXT -520 -496 Left 2 ;P=(VA+VD0)/(VE+VD0)=5,4/15,4=0.35064
TEXT 8 -560 Left 2 !;.param p=0.45064935 \n.param p={ (Va+Vd0)/(Ve+Vd0) }\n.param T=20u \n.param Ca=220u\n.param L = 50uH \n.param RL=7.13\n.param Vd0 = .8V\n.param Va = 5V\n.param Ve = 15V
TEXT -64 168 Left 2 !.tran 0 8m {8m-4*T}
TEXT -584 472 Left 2 ;.Ic I(L3) = 0
TEXT -416 472 Left 2 ;.Ic V(outc) = 5
TEXT -584 504 Left 2 ;.step param IL3 list 0 500m -500m
TEXT -504 240 Left 2 ;.step param IL2 list 0 5
TEXT -640 96 Left 2 !.param Id0=10A\n.param VT=26mV\n;.param Vd0=0.8V\n.param n=1.2\n.param Isd2=Id0/exp( Vd0/( n*VT ) )
TEXT -200 -376 Left 2 !.Ic V(a) = 5.1V
TEXT 304 0 Left 2 !.meas TRAN  ILmax MAX   I(L1)\n.meas TRAN  ILmin MIN   I(L1)\n.meas TRAN  dIL   PARAM ILmax-ILmin\n \n.meas TRAN  ICmax MAX   I(C1)\n.meas TRAN  ICmin MIN   I(C1)\n \n.meas TRAN  t1    time  when I(C1)=ICmax cross=last\n.meas TRAN  t01  time  when I(C1)=0 rise=last\n.meas TRAN  t02  time  when I(C1)=0 fall=last\n \n.meas TRAN  dtc1     PARAM t1-t01 \n.meas TRAN  dtc2     PARAM t02-t1 \n.meas TRAN  A1       PARAM 1/2*dtc1*ICmax \n.meas TRAN  A2       PARAM 1/2*dtc2*ICmax\n.meas TRAN charge PARAM A1+A2 \n.meas TRAN Vr_calc PARAM {charge/Ca}\n \n.meas TRAN Vr PP V(a)
TEXT -112 480 Left 2 ;V={n*VT*ln( I(L2)/Isd2 )}
TEXT 160 -128 Left 2 ;V={ (V(e)-V(a))/L * p*T}
