Version 4
SHEET 1 2192 1020
WIRE -96 -304 -128 -304
WIRE 48 -304 -96 -304
WIRE 160 -304 48 -304
WIRE 272 -304 160 -304
WIRE 288 -272 304 -288
WIRE 320 -272 304 -288
WIRE 48 -240 48 -304
WIRE 272 -240 272 -304
WIRE 304 -240 304 -288
WIRE 160 -224 96 -224
WIRE 224 -224 160 -224
WIRE -96 -96 -96 -304
WIRE 160 -80 160 -224
WIRE 160 -80 -48 -80
WIRE 208 -80 160 -80
WIRE 272 -80 272 -144
WIRE 272 -80 208 -80
WIRE 48 16 48 -144
WIRE 160 16 48 16
WIRE 48 32 48 16
WIRE 272 32 272 -80
WIRE -96 48 -96 0
WIRE -64 48 -96 48
WIRE -48 48 -64 48
WIRE -96 96 -96 48
WIRE 160 112 160 16
WIRE 160 112 96 112
WIRE 224 112 160 112
WIRE 272 144 272 128
WIRE 320 144 272 144
WIRE 336 144 320 144
WIRE 272 160 272 144
WIRE -96 256 -96 176
WIRE 48 256 48 128
WIRE 272 256 272 240
WIRE 464 336 448 336
WIRE 560 336 544 336
WIRE 560 352 560 336
WIRE 352 368 304 368
WIRE 368 368 352 368
WIRE 224 400 176 400
WIRE 240 400 224 400
WIRE 304 400 304 368
WIRE 96 432 32 432
WIRE 112 432 96 432
WIRE 176 432 176 400
WIRE -48 464 -112 464
WIRE -32 464 -48 464
WIRE 32 464 32 432
WIRE -112 496 -112 464
WIRE 304 496 304 480
WIRE 176 528 176 512
WIRE 32 560 32 544
WIRE -112 592 -112 576
FLAG 272 256 0
FLAG 48 256 0
FLAG 160 112 G12
FLAG 160 -224 G345
FLAG 48 16 D1
FLAG 32 560 0
FLAG 272 144 s2
FLAG 32 432 Vgs1
FLAG 176 528 0
FLAG 176 400 Vgs3
FLAG 160 -304 Vdd
FLAG 304 496 0
FLAG 304 368 Vgs4
FLAG 560 432 0
FLAG 448 336 0
FLAG -96 256 0
FLAG -112 592 0
FLAG -112 464 Vgs1b
DATAFLAG 48 -304 ""
DATAFLAG 160 16 "round(1e3*$)*1e-3"
DATAFLAG 320 144 "round(1e6*$)*1e-6"
DATAFLAG 224 208 "round(1e6*I(R2))*1e-6"
DATAFLAG -144 144 "round(1e6*I(R1))*1e-6"
DATAFLAG 240 32 "round(1e6*Id(M2))*1e-6"
DATAFLAG 208 -80 "round(1e3*$)*1e-3"
DATAFLAG 96 432 "round(1e3*$)*1e-3"
DATAFLAG 224 400 "round(1e3*$)*1e-3"
DATAFLAG 352 368 "round(1e3*$)*1e-3"
DATAFLAG 352 -256 "round(1e3*V(G345,Vdd))*1e-3"
DATAFLAG 496 416 "round(1e6*I(ID2))*1e-6"
DATAFLAG -64 48 "round(1e3*$)*1e-3"
DATAFLAG -48 464 "round(1e3*$)*1e-3"
DATAFLAG 240 -128 "round(-1e6*Id(M3))*1e-6"
DATAFLAG 80 -128 "round(-1e6*Id(M4))*1e-6"
SYMBOL res 256 144 R0
SYMATTR InstName R2
SYMATTR Value {R2}
SYMBOL MDB_sym\\source-Vmarker -128 -304 R0
SYMATTR Value V={Vdd}
SYMATTR InstName U1
SYMBOL bv 32 448 R0
WINDOW 3 31 123 Left 2
SYMATTR InstName B2
SYMATTR Value V=Vpn-(Id(M1)*R2*sqrt(k2/k1))/(1-sqrt(k2/k1))
SYMBOL bv 176 416 R0
WINDOW 3 26 117 Left 2
SYMATTR InstName B3
SYMATTR Value V=sqrt(Id(M3)/K3)+Vpp
SYMBOL bv 304 384 R0
WINDOW 3 26 117 Left 2
SYMATTR InstName B4
SYMATTR Value V=sqrt(Id(M4)/K4)+Vpp
SYMBOL bi 560 352 R0
WINDOW 3 -152 110 Left 2
SYMATTR InstName ID2
SYMATTR Value I=(1-sqrt(k2/k1))**2/(R2**2*k2)
SYMBOL res 448 352 R270
WINDOW 0 25 56 VTop 2
WINDOW 3 7 56 VBottom 2
SYMATTR InstName R3
SYMATTR Value 1
SYMBOL res -112 80 R0
SYMATTR InstName R1
SYMATTR Value 10
SYMBOL EIT_Semiconductors\\pmos_2o 224 -240 R0
SYMATTR InstName M3
SYMATTR Value PM3_b
SYMBOL EIT_Semiconductors\\nmos_b 96 32 M0
SYMATTR InstName M1
SYMATTR Value NM1
SYMBOL EIT_Semiconductors\\nmos_b 224 32 R0
WINDOW 3 56 57 Left 2
SYMATTR InstName M2
SYMATTR Value NM2
SYMBOL EIT_Semiconductors\\pmos_2o 96 -240 M0
SYMATTR InstName M4
SYMATTR Value PM4
SYMBOL EIT_Semiconductors\\pmos_2o -48 -96 M0
SYMATTR InstName M5
SYMATTR Value PM5
SYMBOL bv -112 480 R0
WINDOW 3 32 125 Left 2
SYMATTR InstName B1
SYMATTR Value V=Vpn-Idset*R2*sqrt(K2)/(sqrt(K1)-sqrt(K2))
TEXT -104 -448 Left 2 ;-----------------\nKp = 2*K\nVto = VP\n-----------------
TEXT 456 -368 Left 2 !.model NM1 NMOS (Kp={2*K1} Vto={Vpn} )\n.model NM2 NMOS (Kp={2*K2} Vto={Vpn} )\n \n;---- Standard monolithic P-Channel model\n.model PM3_a PMOS (Kp={2*K3} Vto={Vpp} W=1 L=1)\n;---- vertical double diffused power MOSFET\n.model PM3_b VDMOS (pchan Kp={2*K3} Vto={Vpp} )\n \n.model PM4 PMOS (Kp={2*K4} Vto={Vpp} )\n.model PM5 PMOS (Kp={2*K5} Vto={Vpp} )
TEXT 456 -64 Left 2 !.param IrefCMOS=1\n+ K1 = 1m K2 = 4m\n+ K3 = 1.2m K4={K3} K5=1.8m\n+ Vpn = 1V\n+ Vpp = -1V\n+ Vdd = 20V\n+ R2 = 2.5k\n+ Iref = 100u\n+ Id0 = {Iref}
TEXT 654 126 Left 2 ;.tran 100m
TEXT 656 160 Left 2 !.op
TEXT -88 632 Left 2 !.param Idset = 40u
TEXT 200 -448 Left 2 ;.model 1 ako:PM3_a\n.model 2 ako:PM3_b\n.model 99 PMOS
